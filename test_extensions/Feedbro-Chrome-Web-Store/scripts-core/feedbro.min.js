var feedbro=feedbro||{};feedbro.ActionHandler=function(){var f=new feedbro.Strings();var a;var c;var b;var d=[];this.setSoundPlayer=function(g){a=g};this.setNotifications=function(g){b=g};this.setBackground=function(g){c=g};this.init=function(){};function e(){if(d.length>0){var g=d.shift();$.ajax({type:"POST",url:g.url,data:g.postData,timeout:(30*1000),processData:false,cache:false,contentType:"application/json; charset=UTF-8",error:function(i,h,j){feedbro.log(g.type+" remote call FAILED with URL: "+g.url+" for "+g.link+" HTTP Status: "+h)}})}}this.processActions=function(r,l,n,o){var q,g,m,s=false,j={},h;if(o==undefined){o={}}for(m=0;m<l.length;m++){var k=l[m];q=k.type;g=(j[q]==1);if(o[q]){continue}if(q==1&&!g){if(b!=undefined){s=true}}else{if(q==2&&!g){if(n!=undefined){n.css({display:"none"});n.removeClass("entry item")}c.markUnread(r.id,0)}else{if(q==3&&!g){if(n!=undefined){n.css({display:"none"});n.removeClass("entry item")}c.markUnread(r.id,0);c.markDeleted(r.id,1)}else{if(q==4&&!g){if(r.starred!=1){r.starred=1;c.setItemStarred(r.id,1)}}else{if(q==5&&!g){if(r.unread!=0){r.unread=0;c.markUnread(r.id,0)}}else{if(q==6&&!g){a.queue("sound/"+k.value)}else{if(q==7&&!g){if(n!=undefined){n.css({"border-left":"2px solid "+k.value})}}else{if(q==8){if(n!=undefined&&k.value!=undefined&&k.value!=""){try{if(r.highlights==null||r.highlights[k.value]!=true){f.highlightItemContent(r,k.value,"highlight-text");if(r.highlights==null){r.highlights={}}r.highlights[k.value+""]=true}}catch(p){feedbro.log("highlight text with regexp failed",p)}}}else{if(q==9){if(k.value!=undefined&&k.value!=""){c.addTag(r.id,k.value)}}else{if(q==11){h=JSON.stringify({value1:r.link,value2:r.title,value3:r.author});d.push({url:k.value+"",postData:h,link:r.link+"",type:"IFTTT"});e()}else{if(q==12){var t=parseInt(k.value,10);if(!isNaN(t)){c.addPoints(r.id,t)}}else{if(q==13&&!g){a.queue(k.value)}else{if(q==15&&!g){h=JSON.stringify({content:r.title+": "+r.link});d.push({url:k.value+"",postData:h,link:r.link+"",type:"Discord"});e()}else{if(q==16&&!g){h=JSON.stringify({username:"Feedbro",text:r.title+": "+r.link});d.push({url:k.value+"",postData:h,link:r.link+"",type:"Slack"});e()}}}}}}}}}}}}}}j[q]=1}if(s){b.createItemNotification(r)}}};var feedbro=feedbro||{};feedbro.Background=function(){var n;var g=[];var o=new feedbro.FeedTree();var R=new feedbro.Settings();var p=new feedbro.FeedEntryManager("feedbro");var C;var i=new Date().getTime();var G=new Date().getTime();var l=this;var Q=new feedbro.RuleEngine();var D=new feedbro.Notifications();var t=new feedbro.SoundPlayer();var k=new feedbro.ActionHandler();var d;var u;var V=-1;var S;var e;var v=false;var c="id";var y="license";var T=new feedbro.Strings();var J=false;var h=14*24*60*60*1000;var W;function x(Y,X){if(!J){return}if(X){console.log(Y,X)}else{console.log(Y)}}function O(X){return new feedbro.FeedParser(X)}this.engineUnload=function(){console.log("Engine unload!")};this.installLocale=function(Y,X,Z){Locale.download(Y,function(aa){l.getSettings().setLocaleMeta(aa.meta);l.getSettings().setLocale("custom");l.saveSettings();Locale.locales.custom=aa;Locale.selectLocale("custom");feedbro.Persistence.saveValue("locale",aa,function(){console.log("Saved custom locale");X(200)})},Z)};this.selectLocale=function(X){Locale.selectLocale(X);l.getSettings().setLocale(X);l.saveSettings()};this.getDefaultLocaleMap=function(){return Locale.defaultLocale};this.getActiveLocaleMap=function(){return Locale.activeMap};this.getFeedQueue=function(){return g};this.getFeedEntryManagerErrorStatus=function(){return p.getErrorStatus()};this.setDebugMode=function(X){J=X};this.getDbIndex=function(){return p.getDbIndex()};this.setLastFolderId=function(X){u=X};this.getLastFolderId=function(){return u};this.debug=function(Y,X){x(Y,X)};this.getSettings=function(){return R};this.getFeedEntries=function(){return n};this.getFeedTree=function(){return o};this.getNotificationEngine=function(){return D};this.terminate=function(){if(C){clearInterval(C);x("unreadScan terminated")}};this.getEntry=function(X){p.getEntry(X,function(Y){console.log(JSON.stringify(Y))})};this.clearAll=function(X){g=[];p.clear(X);o=new feedbro.FeedTree();l.notifyEngine("reloaddata");l.invalidateTagCloudCache();this.updateTotalUnread();this.saveData()};this.setFeedScanInterval=function(X){if(C){clearInterval(C)}console.log("setFeedScanInterval: "+X+" s");C=setInterval(l.scanUnread,X*1000);setTimeout(l.scanUnread,2*1000)};function I(ac,ab){if(R.getDisableAutoScan()==true){return false}var Y=new Date().getTime();var X=l.getFeedScanDelay(ac.data.id);var aa=!ac.data.lastupdate;var Z=(Y-ac.data.lastupdate)>X;var ae=(ac.data.status==398||ac.data.status==403);var ad=((Y-ac.data.lastupdate)>(1*60*1000));return(ac.data.type==feedbro.FeedTree.FEED&&(aa||Z||(ae&&ad)))}this.escapeHtml=function(X){return X?X.replace(/[&<>"'`]/g,function(Y){return"&#"+Y.charCodeAt(0)+";"}):X};function P(ab){var ac=ab.htmlUrl?' htmlUrl="'+ab.htmlUrl.replace(/&/g,"&amp;").replace(/"/g,"%22")+'"':"";var aa=ab.url?ab.url.replace(/&/g,"&amp;").replace(/"/g,"%22"):"";var X=ab.maxitems?' maxItems="'+ab.maxitems+'"':"";var Z=ab.entrycontent&&ab.entrycontent!=1?' entryContent="'+ab.entrycontent+'"':"";var Y=ab.scandelay?' scanDelay="'+ab.scandelay+'"':"";return'      <outline text="'+l.escapeHtml(ab.name)+'" title="'+l.escapeHtml(ab.realname||ab.name)+'" type="rss" \n            xmlUrl="'+aa+'"'+ac+X+Z+Y+"/>\n"}this.exportOpml=function(){var X='<?xml version="1.0" encoding="UTF-8"?>\n<opml version="1.0">\n<head>\n<title>Feed Subscriptions</title>\n</head>\n<body>\n';o.processNodes(o.getRoot(),function Y(aa,ac){var Z,ab=aa.data;if(ab.type==feedbro.FeedTree.FOLDER){X+='  <outline title="'+l.escapeHtml(ab.name)+'" text="'+l.escapeHtml(ab.name)+'">\n';for(Z=0;Z<aa.children.length;Z++){X+=P(aa.children[Z].data)}X+="  </outline>\n"}else{if(ab.type==feedbro.FeedTree.FEED){X+=P(ab)}else{console.log("exportOpml: Unidentified node type: "+ab.type)}}},feedbro.FeedTree.MODE_TOPNODES);X+="</body>\n</opml>";return X};this.getTreeData=function(){return o.getData()};this.getFolderUnreadCount=function(ab){var aa=o.getNode(ab);var Z=aa.children;var X=0;var Y;for(Y=0;Y<Z.length;Y++){if(Z[Y].data.purge!=1){X+=Z[Y].data.unread}}aa.data.unread=X;return X};this.moveNode=function(ac,Z,Y){var ad;if(Y=="before"){ad=feedbro.FeedTree.BEFORE}else{if(Y=="after"){ad=feedbro.FeedTree.AFTER}else{if(Y=="inside"){ad=feedbro.FeedTree.INSIDE_FIRST}else{if(Y=="inside-last"){ad=feedbro.FeedTree.INSIDE_LAST}else{x("moveNode: Invalid position for move: "+Y)}}}}var X=o.getNode(ac);var ab=o.getNode(Z);o.moveNode(X,ab!==undefined?ab:o.getRoot(),ad);if(X.data.type==1){var aa=X.parent.data?X.parent.data.id:-1;p.moveFeed(X.data.id,aa)}};function a(X){var Y=X>=10000?9999:X;chrome.browserAction.setBadgeText({text:Y>0?String(Y):""})}this.updateTotalUnread=function(){var X=0;o.processNodes(o.getRoot(),function(Y){if(Y.data.type==feedbro.FeedTree.FEED&&Y.data.purge!=1){X+=Y.data.unread}},feedbro.FeedTree.MODE_DEPTHFIRST);a(X)};this.getFolders=function(){var X=[];o.processNodes(o.getRoot(),function(Y){if(Y.data.type==feedbro.FeedTree.FOLDER){X.push(Y.data)}},feedbro.FeedTree.MODE_TOPNODES);return X};this.addFeed=function(Z,Y,ac,X){if(!Y){Y=ac}var ad={url:Z,realname:ac,name:Y,lastread:0,lastupdate:0,unread:0,type:feedbro.FeedTree.FEED};var ab=o.getNode(X);var aa=o.addNode(ad,ab);return aa.data.id};this.getFeedMaxItems=function(X){var Y=o.getNode(X);var Z=0;if(Y&&Y.data.maxitems){Z=Y.data.maxitems}return Z>0?Z:R.getFeedMaxEntries()};this.getFeedScanDelay=function(X){var Z=o.getNode(X);var Y;if(Z&&Z.data.scandelay){Y=Z.data.scandelay*60*1000}else{Y=R.getPollDelay()*60*1000}return Y>=60000?Y:60000};this.processNodes=function(Y,X){o.processNodes(o.getRoot(),function(Z){Y(Z)},X||feedbro.FeedTree.MODE_TOPNODES)};this.markAllAsRead=function(){var X=new Date();o.processNodes(o.getRoot(),function(Y){Y.data.unread=0},feedbro.FeedTree.MODE_DEPTHFIRST);p.markRead({});l.saveData();l.notifyEngine("reloaddata");a(0)};this.markAsRead=function(ab){var Z=o.getNode(ab);var Y,aa,X=new Date();if(Z&&Z.data.type==1){Z.data.unread=0;p.markRead({feedid:ab});l.saveData();l.notifyEngine("updatenode",ab,-1)}else{if(Z&&Z.data.type==2){for(Y=0;Y<Z.children.length;Y++){aa=Z.children[Y].data;aa.unread=0}Z.data.unread=0;p.markRead({folderid:ab});l.saveData();l.notifyEngine("reloaddata");l.updateTotalUnread()}else{x("markAsRead: Unidentified feed or folder id: "+ab)}}};this.markUnread=function(ac,Z){var aa=p.getFeedEntryMeta(ac);var ab=false;if(aa&&aa.unread!=Z){aa.unread=Z;aa.dirty=1;var X=o.getNode(aa.feedid);if(!X){console.log("ERROR: markUnread: feed not found: "+aa.feedid+" coming from ID: "+ac+" and meta: "+JSON.stringify(aa));return false}var Y=X.data;if(Z==0){Y.unread--;if(Y.unread<0){Y.unread=0}}else{Y.unread++}l.notifyEngine("updatenode",aa.feedid,-1);ab=true}else{if(!aa){console.log("ERROR: markUnread: no meta data for "+ac)}}return ab};this.markDeleted=function(aa,X){var Y=p.getFeedEntryMeta(aa);var Z=false;if(Y){if(X==true||X==1){Y.purge=1}else{Y.purge=0}Y.dirty=1;l.invalidateTagCloudCache();Z=true}return Z};this.sortFolder=function(X){if(o.sortChildren(X)){l.notifyEngine("reloaddata",-1,-1);l.saveTreeData()}};this.getNodesWithUrl=function(X){var Y=[];o.processNodes(o.getRoot(),function(Z){if(Z.data.url==X){Y.push(Z)}},feedbro.FeedTree.MODE_RANDOM);return Y};this.addFolder=function(X){var Z={name:X,unread:0,type:feedbro.FeedTree.FOLDER};var Y=o.addNode(Z);return Y.data.id};this.updateTheme=function(){l.notifyEngine("updatetheme",-1,-1)};this.updateCss=function(){l.notifyEngine("updatecss",-1,-1)};this.notifyEngine=function(Y,aa,Z){try{chrome.tabs.query({url:chrome.runtime.getURL("reader.html")+"*"},function(ad){if(ad.length>0){try{var ab=ad[0].id;chrome.tabs.sendMessage(ab,{action:Y,id:aa,parentid:Z},function(ae){})}catch(ac){x("notifyEngine: Could not notify Feedbro tab: "+ac)}}})}catch(X){x("Unable to send notification to content scripts: "+X)}};this.deleteFolder=function(X){o.deleteNode(o.getNode(X));p.deleteFeedEntries({folderid:X})};this.deleteFeed=function(X){o.deleteNode(o.getNode(X));p.deleteFeedEntries({feedid:X})};this.toggleItemStarred=function(Y){var X=p.getFeedEntryMeta(Y);if(X.starred==1){p.updateFeedEntryMeta(Y,{starred:0})}else{p.updateFeedEntryMeta(Y,{starred:1,purge:0})}};this.getFolderData=function(X){return o.getNode(X).data};this.getFeedUnreadCount=function(X){return o.getNode(X).data.unread};function r(X){var Z,aa,ac=new feedbro.TagFilter();if(R.getFilterIframe()){ac.addTagFilter("iframe")}if(R.getFilterEmbed()){ac.addTagFilter("embed")}var ab;for(Z=0;Z<X.length;Z++){aa=X[Z];try{ab=o.getNode(aa.feedid);if(ab&&ab.data&&ab.data.name){aa.feed.title=ab.data.name}}catch(Y){}try{aa.content=ac.filter(aa.content||"");aa.title=ac.filter(aa.title||"");aa.author=ac.filter(aa.author||"");aa.feed.title=ac.filter(aa.feed.title||"")}catch(Y){console.log(" Could not filter "+aa.title)}try{if(aa.decoded!=1){aa.content=T.decodeHtmlEntities(aa.content||"");aa.title=T.decodeHtmlEntities(aa.title||"");aa.author=T.decodeHtmlEntities(aa.author||"")}}catch(Y){console.log(" Could not convert html entities properly for "+aa.title)}}n=X}function E(Y,ab,aa){if(l.isUnreadSearch(Y)){Y.unread=1}var Z=R.getMaxItemAge();if(Z>0){var X=new Date().getTime()-Z;if(!Y.mindate||X>Y.mindate){Y.mindate=X}}if(Y.sort==undefined){Y.sort=R.getItemSortOrder()}p.getFeedEntries(Y,function(ac){r(ac);aa(ab)})}function w(ab,Y){var Z=o.getNode(ab);if(Z){var aa=Z.data;var X=false;if(aa.latestitem==undefined||aa.latestitem==0){X=true}aa.lastModified=Y.lastModified!=undefined?(Y.lastModified)+"":undefined;aa.etag=Y.etag!=undefined?(Y.etag+""):undefined;aa.lastupdate=new Date().getTime();if(Y.feed.latestitemdate){aa.latestitem=Y.feed.latestitemdate.getTime()}if(Y.feed.link){aa.htmlUrl=Y.feed.link+""}if(aa.name=="Unnamed feed"){aa.name=Y.feed.title+"";aa.realname=Y.feed.title+""}aa.status=Y.status+0;aa.latency=Y.latency+0;return X}else{x("updateFeedMap: non-existent node: "+ab);return false}}this.invalidateTagCloudCache=function(){d=undefined};this.getFeedManager=function(){return p};function b(Y){var Z=l.getFeedMaxItems(Y.feedid);p.deleteFeedEntries({feedid:Y.feedid,start:Z,starred:0});var X=o.getNode(Y.feedid);X.data.unread=p.queryIndex({feedid:Y.feedid,unread:1}).length;l.notifyEngine("updatenode",Y.feedid,-1);l.invalidateTagCloudCache()}function L(ad,Y){var ac=g.shift();if(!ac){x("updateNextFeed: feedQueue is empty. Finished.");l.updateTotalUnread();l.saveData(true);return}var Z=o.getNode(ac);if(!Z){x("updateNextFeed: node with id "+ac+" was not found in the tree.");L(ad,Y);return}if(!Y&&!I(Z)){x("Skipping feed "+Z.data.name+", no need to check");L(ad,Y);return}var ab=Z.data;if(!ab.latestitem){ab.latestitem=0}var aa=O(T.createProxyURL(ab.url,ab.proxy));aa.setIndex(l.getDbIndex());var X=ab.maxitems;if(X==undefined||X==""||X<1){X=R.getFeedMaxEntries()}aa.setMaxEntries(X);aa.setTimeout(R.getFeedTimeout());aa.setLastModifiedHeader(ab.lastModified);aa.setETagHeader(ab.etag);aa.setEntryDateLimit(ab.lastread||0);if(ab.username&&ab.password){aa.setAuthentication(ab.username,ab.password)}if(ab.entrycontent>=2){aa.setFullFeed(true)}if(ab.entrycontent==3){aa.setAddMetaImage(false)}aa.load(function(ae){B(ae,ac,ad,Y)})}function B(ad,Y,al,ab){var Z=o.getNode(Y);var aj=Z.data;var am=Z.parent&&Z.parent.data?Z.parent.data.id:-1;if(ad.status==304&&(aj.status!==200&&aj.status!==398&&aj.status!==399&&aj.status!==500&&aj.status!==502&&aj.status!==503&&aj.status!==504&&aj.status!==403&&aj.status!==404)){ad.status=aj.status}var ae=w(Y,ad);if(!ad.error&&ad.status==200){var ak={title:ad.feed.title,link:ad.feed.link,author:ad.feed.author};var af=[];var ac,ai,X,ah=0,ag=new Date().getTime();for(ac=0;ac<ad.feed.entries.length;ac++){ai=ad.feed.entries[ac];ai.feed=ak;X=ai.publishedDate.getTime();if(X>ah&&X<=ag){ah=X}if(X>aj.lastread){af.push(ai)}}if(ah>aj.lastread){aj.lastread=ah}if(af.length>0){x("Saving "+af.length+" entries for feed "+Y+" "+aj.name+" in folder "+am);p.saveFeedEntries(af,Y,am,ae,function aa(an){b(an);l.saveTreeData();L(al,ab)})}else{L(al,ab)}}else{L(al,ab)}}this.loadFeedItems=function(X){g.unshift(X);if(g.length==1){L(undefined,true)}};this.loadFolderFeeds=function(aa){var Z=o.getNode(aa);if(!Z){console.log("loadFolderFeeds: non-existing folder with id: "+aa);return}var Y=Z.children;if(!Y||Y.length==0){console.log("loadFolderFeeds: no children for folder with id: "+aa);return}var X;for(X=0;X<Y.length;X++){g.unshift(Y[X].data.id)}if(g.length==Y.length){L(undefined,true)}};this.saveSettings=function(){x("Saving settings...");feedbro.Persistence.saveValue("feedSettings",R.toJson(),function(){x("Done.")})};function N(X){feedbro.Persistence.loadValue("feedSettings",function(Y){if(Y!=undefined){R.fromJson(Y);x("Settings loaded.")}else{x("No stored settings yet.")}z(X)})}function z(Z){var Y=R.getLocale();var X=R.getLocaleMeta();if(X!=undefined){feedbro.Persistence.loadValue("locale",function(aa){if(aa!=undefined){Locale.addLocale(aa,"custom");Locale.selectLocale(Y)}if(Z){Z()}})}else{Locale.selectLocale(Y);if(Z){Z()}}}this.saveDatabase=function(){x("Saving database data...");p.save()};this.saveData=function(Y){if(v==false){console.log("Feedbro was not properly initialized! saveData call skipped!");return}var X=new Date().getTime();if(Y||(X-i)>10000){l.saveTreeData();p.save();i=new Date().getTime();x("Saving data done.")}};this.isInitialized=function(){return v};this.saveTreeData=function(){if(v){feedbro.Persistence.saveValue("feedTree",o.toJson())}else{console.log("ERROR: Feed tree saving skipped! Feedbro did not initialize properly due to chrome.storage.local problems. Please restart the browser.")}};function m(X){x("Loading feed subscription data...");feedbro.Persistence.loadValue("feedTree",function(Y){if(Y!=undefined){o.fromJson(Y);x("Done.")}else{x("No stored feed subscription data yet.")}if(X){X()}})}function A(X,Y){X.folderid=X.id;if(!X.count){X.count=30}E(X,X.id,Y)}function U(Y,X,Z){Y.feedid=Y.id;if(!Y.count){Y.count=30}E(Y,Y.id,Z)}function q(X,Y){X.starred=1;E(X,X.id,Y)}function f(X,Y){if(!X.count){X.count=30}E(X,X.id,Y)}function F(X,Y){p.getFeedEntries(X,function(Z){r(Z);Y(X.id)})}this.isUnreadSearch=function(X){return R.getOnlyUnread()&&(!X.starred||X.starred==0)};this.handleMessageEvent=function(Y,X,aa){var Z;if(Y.action=="loadgroupdao"){Z=o.getNode(Y.id);if(Z&&Z.data.type==feedbro.FeedTree.FOLDER){A(Y,aa)}}if(Y.action=="loadsingledao"){Z=o.getNode(Y.id);if(Z){U(Y,Z.data.url,aa)}}if(Y.action=="loadstarred"){q(Y,aa)}if(Y.action=="loadall"){f(Y,aa)}if(Y.action=="loadsingle"){F(Y,aa)}if(Y.action=="loadtag"){if(!Y.count){Y.count=30}E(Y,Y.id,aa)}if(Y.action=="getlicense"){aa({status:V,license:S,installDate:e})}return true};this.setPopupEnabled=function(X){console.log("Popup enabled: "+X);try{if(X){chrome.browserAction.onClicked.removeListener(H);chrome.browserAction.setPopup({popup:"mainmenu.html"})}else{chrome.browserAction.setPopup({popup:""});chrome.browserAction.onClicked.addListener(H)}}catch(Y){console.log("setPopupEnabled, error: ",Y)}};function H(X){j("Feedbro","reader.html")}function j(Y,X){chrome.tabs.query({url:chrome.runtime.getURL(X)+"*"},function(Z){if(Z.length>0){chrome.tabs.update(Z[0].id,{active:true});if(l.getSettings().getIconClickReloads()){l.notifyEngine("updateview",-1,-1)}}else{chrome.tabs.create({url:chrome.runtime.getURL(X)},function(aa){x("openTab")})}})}this.addTag=function(aa,X){var Y,Z=p.getFeedEntryMeta(aa);if(Z==undefined){return false}if(Z.tags==undefined){Z.tags=[]}for(Y=0;Y<Z.tags.length;Y++){if(Z.tags[Y]==X){return false}}Z.tags.push(X);Z.dirty=1;l.invalidateTagCloudCache();return true};this.removeTag=function(aa,X){var Y,Z=p.getFeedEntryMeta(aa);if(Z==undefined){return false}if(Z.tags==undefined){return false}for(Y=0;Y<Z.tags.length;Y++){if(Z.tags[Y]==X){Z.tags.splice(Y,1);Z.dirty=1;l.invalidateTagCloudCache();return true}}console.log("removeTag: did not find tag "+X+" for entry: "+aa);return false};this.addPoints=function(Z,X){var Y=p.getFeedEntryMeta(Z);if(Y==undefined){return false}if(Y.points==undefined){Y.points=0}Y.points+=X;Y.dirty=1;return Y.points};this.setItemStarred=function(Z,X){var Y=p.getFeedEntryMeta(Z);if(Y!=undefined&&X!=undefined){p.updateFeedEntryMeta(Z,{starred:X})}};this.getRuleEngine=function(){return Q};this.getSoundPlayer=function(){return t};this.getTagCloud=function(X){if(d==undefined){d=p.getTagCloud(X)}return d};this.scanUnread=function(aa){var Z=new Date().getTime();x("Time since last scanUnread: "+(Z-G)+" ms.");if(g.length==0||((Z-G)>(60*60*1000))||aa){g=[];if(aa){o.processNodes(o.getRoot(),function(ad,ae){if(ad.data.type==feedbro.FeedTree.FEED){g.push(ad.data.id)}},feedbro.FeedTree.MODE_DEPTHFIRST)}else{o.processNodes(o.getRoot(),function(ad,ae){if(I(ad)){g.push(ad.data.id)}},feedbro.FeedTree.MODE_DEPTHFIRST)}if(Z-i>(5*60*1000)){l.saveData()}if(g.length>0){x("eventScanUnread: feeds that need unread check: "+g.length);if(g.length>5){var Y=R.getUpdateThreads();x("Using "+Y+" threads to scan for updates...");var ab,ac=[];try{for(ab=0;ab<Y;ab++){ac.push(ab)}}catch(X){console.log("Error in setting number of scanning threads to use. Defaulting to 2.");ac.push(0);ac.push(1)}jQuery.each(ac,function(ad,ae){L(function(){},aa)})}else{L(function(){},aa)}}G=Z}};this.loadFeed=function(X){if(g.length==0){g.push(X);L()}};this.findFeeds=function(Y,ab,X,aa){var Z=O(Y);Z.setTimeout(25000);Z.setIndex(l.getDbIndex());if(ab!=undefined&&ab!=""&&ab.length>0){Z.setAuthentication(ab,X)}Z.findFeeds(aa)};this.previewFilter=function(ac){var Z,aa,X,ab=new feedbro.TagFilter();if(R.getFilterIframe()){ab.addTagFilter("iframe")}if(R.getFilterEmbed()){ab.addTagFilter("embed")}if(ac.feed&&ac.feed.entries){X=ac.feed.entries;for(Z=0;Z<X.length;Z++){aa=X[Z];try{aa.content=ab.filter(aa.content||"");aa.title=ab.filter(aa.title||"");aa.author=ab.filter(aa.author||"")}catch(Y){console.log(" Could not filter "+aa.title)}}}};this.previewFeed=function(aa,ab,ad,Z,ac){var X=O(aa);var Y=this;if(ab==2){X.setFullFeed(true);X.setAddMetaImage(true)}if(ab==3){X.setFullFeed(true);X.setAddMetaImage(false)}X.setTimeout(30000);if(ad!=undefined&&Z!=undefined&&ad.length>0){X.setAuthentication(ad,Z)}X.setMaxEntries(20);X.setIndex(Y.getDbIndex());X.load(function(ae){Y.previewFilter(ae);ac(ae)})};this.headerHandler=function(X){var ab,aa;if(X.type=="xmlhttprequest"&&X.tabId==-1&&(X.method=="GET"||X.method=="HEAD"||X.method=="POST")){try{var ad=X.originUrl||X.initiator||X.documentUrl;if(ad&&ad.length>30&&T.beginsWith(ad,W)){var ah=new URL(X.url).hostname;var ag,af,Y,ac,Z;if(ah=="api.twitter.com"){X.requestHeaders.push({name:"Origin",value:"https://twitter.com"});X.requestHeaders.push({name:"Referer",value:"https://twitter.com/home"})}else{X.requestHeaders.push({name:"Referer",value:X.url})}for(aa=0;aa<X.requestHeaders.length;aa++){ab=X.requestHeaders[aa];if(ab.name=="Cookie"||ab.name=="cookie"){if(ah=="vk.com"){M(ab,"remixlang");ab.value=ab.value+"; remixlang=3;"}else{if(ah=="www.linkedin.com"){Y=s(ab.value,"JSESSIONID");if(Y!=undefined){if(Y.length>1){if(Y.charAt(0)=='"'){feedbro.LiPlugin.csrfToken=Y.substring(1,Y.length-1)}else{feedbro.LiPlugin.csrfToken=Y}}}}}}else{if(ab.name=="Origin"||ab.name=="origin"){ac=ab}else{if(ab.name=="Referer"||ab.name=="Referer"){Z=ab}}}}if(ah=="www.facebook.com"){if(ac){ac.value="https://www.facebook.com"}else{X.requestHeaders.push({name:"Origin",value:"https://www.facebook.com"})}}}}catch(ae){console.log("headerHandler failed: "+ae)}}return{requestHeaders:X.requestHeaders}};function s(aa,Z){var X,Y=aa.indexOf(Z+"=");if(Y!=-1){X=aa.indexOf(";",Y);if(X==-1){X=aa.length}return aa.substring(Y+Z.length+1,X)}else{return undefined}}function M(ab,Z){var aa=ab.value;var Y=aa.indexOf(Z+"=");var X;if(Y!=-1){X=aa.indexOf("; ",Y);if(X==-1){X=aa.length}aa=aa.substring(0,Y)+aa.substring(X+1);ab.value=aa}}this.adjustHeaders=function(X){var ab=false;try{var ac,ad,Y,ag,Z,aa=X.responseHeaders;var ae=X.originUrl||X.initiator||X.documentUrl;if(ae&&ae.length>30&&T.beginsWith(ae,W)){for(ac=0;ac<aa.length;ac++){ad=aa[ac];Y=ad.name;if(Y=="x-frame-options"||Y=="X-Frame-Options"||Y=="frame-options"||Y=="Frame-Options"){ad.name=ad.name+"-disabled";ab=true}if(Y=="link"||Y=="Link"){ad.name=Y+"-disabled";ab=true}if(Y=="cross-origin-resource-policy"||Y=="Cross-Origin-Resource-Policy"){ad.name=Y+"-disabled";ab=true}if(Y=="content-security-policy"||Y=="Content-Security-Policy"){ad.value=ad.value.replace(/frame-ancestors[^;]+(;|$)/,"");ab=true}if(Y=="set-cookie"||Y=="Set-Cookie"){if(ag==undefined){ag=new URL(X.url).host}else{if(ag=="www.linkedin.com"){Z=s(ad.value,"JSESSIONID");if(Z!=undefined){feedbro.LiPlugin.csrfToken=Z.substring(1,Z.length-1)}}}}}}}catch(af){console.log("adjustHeaders error: "+af)}if(ab){return{responseHeaders:X.responseHeaders}}else{return{}}};this.initFeedbro=function(){Locale.start();N(function(){m(K)})};function K(){p.openConnection(function(){p.init(function(){l.setFeedScanInterval(30)})});D.setSettings(R);D.init();t.setSettings(R);k.setBackground(l);k.setSoundPlayer(t);k.setNotifications(D);k.init();Q.setActionHandler(k);Q.loadRules();Q.setEnabled(true);chrome.runtime.onMessage.addListener(l.handleMessageEvent);chrome.browserAction.setBadgeBackgroundColor({color:"#0000FF"});l.updateTotalUnread();var aa=(R.getIconClickMode()==1);if(aa==false){l.setPopupEnabled(aa)}v=true;var Z=true;var Y=true;try{chrome.webRequest.onBeforeSendHeaders.addListener(l.headerHandler,{urls:["https://twitter.com/*","https://api.twitter.com/*","https://vk.com/*","https://www.linkedin.com/feed/","https://www.linkedin.com/voyager/api/*","https://www.facebook.com/api/*"]},["blocking","requestHeaders","extraHeaders"]);console.log("webRequest handlers with extraHeaders setup successful.")}catch(X){Z=false}if(!Z){try{chrome.webRequest.onBeforeSendHeaders.addListener(l.headerHandler,{urls:["https://twitter.com/*","https://api.twitter.com/*","https://vk.com/*","https://www.linkedin.com/feed/","https://www.linkedin.com/voyager/api/*","https://www.facebook.com/api/*"]},["blocking","requestHeaders"]);console.log("webRequest handlers without extraHeaders setup successful.")}catch(X){Z=false}}if(R.getDisableHeaderListener()==false){try{W=T.getExtensionBaseUrl();chrome.webRequest.onHeadersReceived.addListener(l.adjustHeaders,{urls:["<all_urls>"]},["blocking","responseHeaders","extraHeaders"])}catch(X){Y=false}if(Y==false){try{chrome.webRequest.onHeadersReceived.addListener(l.adjustHeaders,{urls:["<all_urls>"]},["blocking","responseHeaders"])}catch(X){console.log("Failed to set adjustHeader handler")}}}console.log("Feedbro initialized.")}};var feedbro=feedbro||{};feedbro.Bookmarks=function(){var m=this;var e='<?xml version="1.0" encoding="UTF-8"?>\n<opml version="1.0">\n<head>\n    <title>Firefox Bookmarks as OPML</title>\n</head>\n<body>';var k="</body>\n</opml>";var l;var n=new feedbro.Options();var h=new feedbro.FeedIconManager();function f(){return chrome.extension.getBackgroundPage().feedbrobg}this.init=function(){try{Locale.start();Locale.activeMap=f().getActiveLocaleMap();Locale.translate(true);alertify.set({labels:{cancel:Locale.i18n("dialog_cancel",false),ok:Locale.i18n("dialog_ok",false)}})}catch(o){feedbro.log("Locale init error",o)}document.getElementById("bookmarkfile").addEventListener("change",a,false);$("button#download").click(function(){var p=b();if(p){n.downloadFile(p,"firefox-subscriptions.opml","application/xml")}});$("button#import").click(function(){var p=b();if(p){n.importFeeds(p,l)}});$("div#left").click(function(){n.restoreView()});$("div#right").click(function(){n.restoreView()})};function c(p){var o=p;o=o.replace(/outline/g,"div");o=o.substring(o.indexOf("<body>")+"<body>".length,o.indexOf("</body>"));$("div#results").html(o);$("div#results div").each(function(s,r){var w=$(r);var t=w.attr("type")=="rss"?"feed":"folder";if(w.attr("data-type")){t=w.attr("data-type")}w.addClass(t);var q;if(t=="folder"){q="<img class='folder' src='images/folder-icon.png'>"+w.attr("title")}else{if(t=="livebookmark"){q="<a target='_blank' href='"+w.attr("xmlUrl")+"'><img title='Live Bookmark' class='livebookmark' src='images/feed-icon.png'>"+w.attr("title")+"</a>"}else{if(t=="feed"){var v=w.attr("xmlUrl")||"";var u=h.getIconFromGoogleCache(v);q="<a target='_blank' href='"+w.attr("xmlUrl")+"'><img class='feed' src='"+u+"'>"+w.attr("title")+"</a>"}}}w.prepend("<input type='checkbox' class='"+t+"'><span class='title'>"+q+"</span>")});$("div#results input.folder").change(function(t){var q=$(this);var s=q.parent();var r=q.prop("checked");s.find("input").each(function(u,w){var v=$(w);v.prop("checked",r);v.parent().attr("data-checked",r)});i(s,r)});$("div#results input.feed").change(j);$("div#results input.livebookmark").change(j);$("input#file").val(null)}function j(r){var o=$(this);var q=o.parent();var p=o.prop("checked");q.attr("data-checked",p);i(q,p)}function b(){if($("div#results div[data-checked='true']").length==0){alertify.alert(Locale.i18n("options_error_bookmarks_noselection",false));return false}var o=$("div#results").clone();o.find("div[data-checked!='true']").remove();o.find("input").remove();o.find("span").remove();o.find("div").removeAttr("data-checked class");var p=o[0].innerHTML;p=p.replace(new RegExp("<div","g"),"<outline");p=p.replace(new RegExp("</div","g"),"</outline");p=p.replace(new RegExp("xmlurl=","g"),"xmlUrl=");p=p.replace(new RegExp("htmlurl=","g"),"htmlUrl=");return e+p+k}function i(p,o){p=p.parent();while(true){if(p.hasClass("folder")==false){break}if(p&&p.find("> input").prop("checked")==false&&o){p.find("> input").prop("checked",true);p.attr("data-checked",true)}p=p.parent()}}function d(o){if(o.indexOf("<!DOCTYPE NETSCAPE-Bookmark-file-1>")!=0){alertify.alert(Locale.i18n("options_error_bookmarks_invalidfile",false,l.name));return e+k}o=o.substring("<DL><p>".length+o.indexOf("<DL><p>"),o.length-"</DL>".length-1);o=o.replace(new RegExp("<DD>[^<]+<","g"),"<");o=o.replace(new RegExp("<HR>","g"),"");o=o.replace(new RegExp('<A FEEDURL="([^"]+)" HREF="([^"]+)">',"g"),function(p,r,q){return'<A xmlUrl="'+g(r)+'" htmlUrl="'+g(q)+'" data-type="livebookmark">'});o=o.replace(new RegExp("<DT><H3[^>]+>([^<]+)</H3>[\n ]+<DL><p>","g"),'<outline title="$1" text="$1">');o=o.replace(new RegExp("<DT><A ([^>]+)>([^<]+)</A>","g"),'<outline type="rss" title="$2" text="$2" $1/>');o=o.replace(new RegExp("</DL><p>","g"),"</outline>");o=o.replace(new RegExp(' (ICON|ICON_URI|ADD_DATE|LAST_MODIFIED|LAST_CHARSET|PRIVATE|TAGS)="[^"]+"',"g"),"");o=o.replace(new RegExp('<outline[^>]+HREF="(about|place|moz-extension|view-source):[^>]+/>',"g"),"");o=o.replace(new RegExp('HREF="([^"]+)"',"g"),function(p,q){return'xmlUrl="'+g(q)+'"'});return e+o+k}function a(p){var q=p.target.files;var o=new FileReader();l=q[0];o.onload=function(r){c(d(r.target.result))};o.readAsText(l)}function g(o){return o.replace(/&/g,"&amp;")}};var feedbro=feedbro||{};feedbro.Chrome={};feedbro.Chrome.openTab=function(b,a){chrome.tabs.query({title:b},function(e){var f=false;if(e.length>0){for(var d=0;d<e.length;d++){if(e[d].url&&e[d].url.indexOf("http")==0){continue}try{chrome.windows.update(e[d].windowId,{focused:true})}catch(c){}if(a==undefined){chrome.tabs.update(e[d].id,{active:true})}else{chrome.tabs.update(e[d].id,{active:true,url:a})}f=true;break}}if(!f){chrome.tabs.create({url:chrome.runtime.getURL(a)})}})};function fetchTimeout(c,b,f){var a=new AbortController();if(f==null){f={method:"GET"}}f.signal=a.signal;var e=fetch(c,f);var d=setTimeout(function(){a.abort()},b);return e["finally"](function(){clearTimeout(d)})}feedbro.FetchWrapper=function(a){this.status=a};feedbro.FetchWrapper.prototype.getResponseHeader=function(a){return null};var feedbro=feedbro||{};feedbro.ClearBody=function(){this.linkConverter=/<([^<>]*) (src|href)=["'](?!http|data|magnet|mailto)([^"']+)["']([^<>]*)>/gi;this.removeHeader=true;this.addmetaimageMode=true;this.timeout=30000;this.dataCache=new WeakMap();this.strings=new feedbro.Strings()};feedbro.ClearBody.makeMap=function(d){var c={},a=d.split(",");for(var b=0;b<a.length;b++){c[a[b]]=true}return c};feedbro.ClearBody.tagFlipMap={audio:"x-audio",video:"x-video",source:"x-source",svg:"x-svg",style:"x-style",canvas:"x-canvas"};feedbro.ClearBody.bannedExtensions=/\.pdf|doc|docx|png|jpg|xls|xlsx|gif|ppt|pptx|rtf$/i;feedbro.ClearBody.killTags=feedbro.ClearBody.makeMap("SCRIPT,META,LINK,NOSCRIPT,STYLE,X-STYLE,BUTTON,TEXTAREA,NAV,SELECT,LABEL,HEAD,FOOTER,ASIDE,HR,TIME,FIGURE,CANVAS,X-CANVAS");feedbro.ClearBody.killClasses=new RegExp("(comment|twitter|facebook|linkedin|email|slide|video|gallery|tag\\s|playlist|actions|footer|label-more|summaPremiumLinks|oembed-asset|cnn_strylceclbtn|advert|share|storyTools|xcContainer|linked-articles|kainalo|googleAd)","i");feedbro.ClearBody.killMainClasses=new RegExp("(hidden|banner|related|read-more|readAlso|subscribe|sponsor|byline|social-media|sharing|pagination|paywall|googleArticleAd|teaser|article-ad)| ad$|^ad $","i");feedbro.ClearBody.killIds=new RegExp("(comment|actions|footer|author|share|headlines|toolbar|hsonfb-links|bpr-guid)","i");feedbro.ClearBody.keepTags=feedbro.ClearBody.makeMap("ARTICLE");feedbro.ClearBody.boostClasses=new RegExp("content|main|primary|article|body|post","i");feedbro.ClearBody.boostTags=feedbro.ClearBody.makeMap("ARTICLE,ISENSE");feedbro.ClearBody.CHARCOUNT=0;feedbro.ClearBody.PCOUNT=1;feedbro.ClearBody.HCOUNT=2;feedbro.ClearBody.VISITED=3;feedbro.ClearBody.prototype.getNodeData=function(a){if(a==undefined){return undefined}var b=this.dataCache.get(a);if(b==undefined){b=[0,0,0,0];this.dataCache.set(a,b)}return b};feedbro.ClearBody.prototype.setTimeout=function(a){if(a<30000){a=30000}this.timeout=a};feedbro.ClearBody.prototype.setAddMetaImage=function(a){this.addmetaimageMode=a};feedbro.ClearBody.prototype.setRemoveHeader=function(a){this.removeHeader=a};feedbro.ClearBody.prototype.loadFeedEntries=function(b,e){var d,c=[];if(b==undefined||b.length<1){e();return}var a=this;for(d=0;d<b.length;d++){a.load(b[d].link,(function(f){return function(g){if(g!=undefined&&g!="undefined"){f.content=g}c.push(0);if(c.length==b.length){e()}}})(b[d]))}};feedbro.ClearBody.prototype.isValidExtension=function(a){return feedbro.ClearBody.bannedExtensions.test(a)==false};feedbro.ClearBody.prototype.load=function(b,d){var a=this;if(a.isValidExtension(b)==false){feedbro.log("  ClearBody: skipped link (banned file extension): "+b);d();return}var c=new XMLHttpRequest();c.onreadystatechange=function(f){var e=f.target;if(e.readyState==4){e.onreadystatechange=null;if(e.status==200){var g=e.getResponseHeader("Content-Type")||"";if(g.indexOf("text/html")!=-1){a.processHtmlText(b,e,d)}else{d()}}else{d()}}};c.open("GET",b,true);c.timeout=this.timeout;c.send()};feedbro.ClearBody.prototype.processHtmlText=function(c,f,h){var g=new DOMParser();try{var e=f.responseText;e=e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"");e=e.replace(new RegExp(" (src|srcset|rel|onload|preload|autoplay)=","gi")," data-$1=");e=this.strings.switchTags(e,feedbro.ClearBody.tagFlipMap);var d=g.parseFromString(e,"text/html");e=null;var a=d.children[0];this.processDom(c,a,h)}catch(b){h()}};feedbro.ClearBody.prototype.getChildTag=function(a,d){var c,b=a.children;for(c=0;c<b.length;c++){if(b[c].tagName==d){return b[c]}}return undefined};feedbro.ClearBody.prototype.getMetadata=function(b){var e,g={},d=b.children,c;c=this.getChildTag(b,"HEAD");if(c==undefined){return g}d=c.children;for(e=0;e<d.length;e++){if(d[e].tagName=="META"){var h=d[e];var a=h.getAttribute("property")+"";var f=h.getAttribute("content")+"";if(a!=undefined&&f!=undefined){g[a]=f}}}return g};feedbro.ClearBody.prototype.processDom=function(a,h,m){var o=this.getMetadata(h);var e=this.getChildTag(h,"BODY");this.depthFirst(e,this.filter2,function(i){});var p=this;this.depthFirst(e,this.filter1,this.calculateWeight);var b=e;var g=1;var q=[];var l;while(true){b=this.findLargestTextNode(b);l=p.getNodeData(b);if(b==undefined||(l[feedbro.ClearBody.CHARCOUNT]/g<0.5||b.tagName=="P"||b.tagName=="A")){b=q.pop();break}q.push(b);g=l[feedbro.ClearBody.CHARCOUNT];if(g==0){g=1}}if(b==undefined){feedbro.log("  No content found");m()}var k=true;var j=o["og:image"];if(j){var f=this.getImages(b);var d;for(d=0;d<f.length;d++){if(f[d].getAttribute("src")==j){k=false;break}}}else{k=false}if(b!=undefined){var c;if(this.addmetaimageMode&&k&&b!=undefined&&b.firstChild){c=this.serializeNodeTree('<img class="fbarticlemainimage" src="'+j+'">',b)}else{c=this.serializeNodeTree("",b)}c=c.replace(new RegExp(" data-(src|srcset|rel|onload|preload|autoplay)=","gi")," $1=");c=this.strings.switchTags(c,this.strings.reverseMap(feedbro.ClearBody.tagFlipMap));c=this.convertRelativeLinks(c,undefined,a);m(c)}else{m(undefined)}};feedbro.ClearBody.prototype.calculateWeight=function(d,b){var g=1;var e=b.getNodeData(d);var a;if(d.parentNode){a=b.getNodeData(d.parentNode)}if(d.nodeType==3){var c=d.nodeValue.trim().length;if(c<20){g=0.1}if(c>80){g=2}if(c>200){g=4}if(c>0){e[feedbro.ClearBody.CHARCOUNT]+=c*g}}if(d.parentNode){var f=d.parentNode.tagName;if(d.tagName=="P"){g=2;a[feedbro.ClearBody.PCOUNT]++}if(f=="LI"){g=0.01}if(f=="A"){g=0.001}if(f=="IFRAME"){g=1e-7}a[feedbro.ClearBody.PCOUNT]+=e[feedbro.ClearBody.PCOUNT];a[feedbro.ClearBody.CHARCOUNT]+=(e[feedbro.ClearBody.CHARCOUNT]*g)}};feedbro.ClearBody.prototype.serializeNodeTree=function(d,c){try{var b=new XMLSerializer();return d+b.serializeToString(c)}catch(a){return d+c.innerHTML}};feedbro.ClearBody.prototype.getImages=function(b){var a=[];this.breadthFirst(b,function(c){if(c.tagName=="IMG"){a.push(c)}return false});return a};feedbro.ClearBody.prototype.getTitle=function(a){return this.breadthFirst(a,function(b){return(b.tagName=="H1"?b:false)})};feedbro.ClearBody.prototype.findLargestTextNode=function(b){var a=-1,d,g;for(var c=0;c<b.childNodes.length;c++){var f=b.childNodes[c];g=this.getNodeData(f);var e=g[feedbro.ClearBody.CHARCOUNT];if(g[feedbro.ClearBody.PCOUNT]>0){e=e*g[feedbro.ClearBody.PCOUNT]}if(f.className!=undefined&&feedbro.ClearBody.boostClasses.test(f.className)){e=e*3}if(f.tagName in feedbro.ClearBody.boostTags){e=e*3}if(e>a){a=e;d=f}}return d};feedbro.ClearBody.prototype.breadthFirst=function(b,f){var d,e,a=[];if(b!=undefined){a.push(b)}while(true){if(a.length==0){break}e=a.shift();var c=f(e);if(c!=undefined&&c!=false){return c}for(d=0;d<e.childNodes.length;d++){a.push(e.childNodes[d])}}return false};feedbro.ClearBody.prototype.filter1=function(b){if(b==undefined){return false}var a=b.tagName;if(b.nodeType==8||a in feedbro.ClearBody.killTags){return true}else{if(b.className!=undefined&&!(a in feedbro.ClearBody.keepTags)&&feedbro.ClearBody.killClasses.test(b.className)){return true}else{if(b.id!=undefined&&feedbro.ClearBody.killIds.test(b.id)){return true}else{if(b.nodeType==1&&b.getAttribute("aria-hidden")=="true"){return true}else{return false}}}}};feedbro.ClearBody.prototype.filter2=function(a){if(a.className!=undefined&&feedbro.ClearBody.killMainClasses.test(a.className)){return true}else{return false}};feedbro.ClearBody.prototype.depthFirst=function(b,f,g){var e,c,d,a=[];if(b!=undefined){a.unshift(b)}d=b;while(a.length>0){d=a[0];e=this.getNodeData(d);if(e[feedbro.ClearBody.VISITED]==1||d.childNodes.length==0){g(d,this);d=a.shift();e=this.getNodeData(d);e[feedbro.ClearBody.VISITED]=0;continue}else{for(c=d.childNodes.length-1;c>=0;c--){var h=d.childNodes[c];if(f(h)){d.removeChild(h)}else{a.unshift(h)}}}e[feedbro.ClearBody.VISITED]=1}};feedbro.ClearBody.prototype.convertRelativeLinks=function(b,g,d){var f=this.getProtocol(d);var c=this.getServer(d);var e=this.getBase(d);var a=this;return b.replace(a.linkConverter,function(o,n,k,j,i){var h=n;var p=k;var q=j;var m=i;var r="<"+h+" "+p+'="';var l='"'+m+">";if(q.indexOf("://")!=-1||q.indexOf("data:")==0){return r+q+l}if(q.indexOf("//")==0){return r+f+":"+q+l}if(q.length>0&&q.charAt(0)=="/"){if(g!=undefined){return r+a.getProtocol(g)+"://"+a.getServer(g)+q+l}else{return r+f+"://"+c+q+l}}else{if(g!=undefined){if(q.length>0&&g.length>0&&(q.charAt(0)=="#"||q.charAt(0)=="?")){return r+g.substring(0,g.length-1)+q+l}else{return r+g+q+l}}else{return r+e+q+l}}})};feedbro.ClearBody.prototype.getServer=function(e){var d=e.indexOf("://");if(d<0){d=0}else{d=d+3}var c=e.indexOf("/",d);if(c<0){c=e.length}return e.substring(d,c)};feedbro.ClearBody.prototype.getProtocol=function(a){if(!a){return"http"}var b=a.indexOf(":");return b>0?a.substring(0,b):"http"};feedbro.ClearBody.prototype.getBase=function(e){if(e==undefined){return undefined}var d=e.indexOf("://");var c=e.lastIndexOf("/");if(d!=-1&&c>(d+3)){return e.substring(0,c+1)}else{if(e.charAt(e.length-1)!="/"){return e+"/"}else{return e}}};var feedbro=feedbro||{};feedbro.DbIndex=function(b){var d=[];var a={};var c={};var e;this.add=function(g,k,f,p,j,h,q,m,n,l,i){var o={timestamp:k,unread:j,starred:h,feedid:f,folderid:p,id:g,tags:q,link:m,guid:l};if(i==1){o.purge=1}if(n&&n!=0){o.points=n}d.push(o);a[g]=o;if(l!=undefined){c[f+"|"+l]=o}e=undefined};this.size=function(){return d.length};this.clear=function(){d=[];a={};c={};e=undefined};this.remove=function(k){var f,j={};for(f=0;f<k.length;f++){j[k[f]]=1}var h,g=[];for(f=0;f<d.length;f++){h=d[f];if(j[h.id]){a[h.id]=undefined;if(h.guid!=undefined){c[h.feedid+"|"+h.guid]=undefined}}else{g.push(h)}}d=g};this.moveFeed=function(f,j){var g,h;for(g=0;g<d.length;g++){h=d[g];if(h.feedid==f&&h.folderid!=j){h.folderid=j;h.dirty=1}}};this.get=function(f){return a[f]};this.sort=function(f){if(f==feedbro.DbIndex.SORT_DESCENDING){d.sort(function(h,g){if(h.timestamp>g.timestamp){return -1}if(h.timestamp<g.timestamp){return 1}return 0});e=f}else{if(f==feedbro.DbIndex.SORT_ASCENDING){d.sort(function(h,g){if(h.timestamp<g.timestamp){return -1}if(h.timestamp>g.timestamp){return 1}return 0});e=f}else{if(f==feedbro.DbIndex.SORT_POINTS){d.sort(function(h,g){var i=h.points||0;var j=g.points||0;if(i>j){return -1}if(i<j){return 1}if(h.timestamp>g.timestamp){return -1}if(h.timestamp<g.timestamp){return 1}return 0});e=f}}}};this.getTagCloud=function(m){var l,k,n,f,h,g={};if(m==undefined){m={}}for(l=0;l<d.length;l++){n=d[l];if(n.purge==1){continue}if(m.mindate>n.timestamp){continue}if(m.maxdate<n.timestamp){continue}if(m.feedid!=undefined&&n.feedid!=m.feedid){continue}if(m.folderid!=undefined&&n.folderid!=m.folderid){continue}if(m.unread!=undefined&&n.unread!=m.unread){continue}h=n.tags;if(h==undefined||h.length<1){continue}for(k=0;k<h.length;k++){f=h[k];if(g[f]!=undefined){g[f]++}else{g[f]=1}}}return g};this.getGuid=function(f,g){return c[f+"|"+g]};this.findEntryWithLink=function(f){var g,j,h;for(g=0;g<d.length;g++){h=d[g].link;if(h&&h==f){return d[g]}}return undefined};this.query=function(q,f){var n=[];var g={};var l=0;var m=0;var j,h,p,o;if(!q.mindate){q.mindate=0}if(!q.maxdate){q.maxdate=Number.MAX_VALUE}if(!q.start){q.start=0}if(!q.count){q.count=10000000}if(!q.sort){q.sort=feedbro.DbIndex.SORT_DESCENDING}if(!e||e!=q.sort){this.sort(q.sort)}for(j=0;j<d.length;j++){p=d[j];if(q.skipUntil){if(p.id!=q.skipUntil){continue}else{q.skipUntil=undefined;continue}}if(q.feedid!=undefined&&p.feedid!=q.feedid){continue}if(q.folderid!=undefined&&p.folderid!=q.folderid){continue}if(q.unread!=undefined&&p.unread!=q.unread){continue}if(q.mindate>p.timestamp){continue}if(q.maxdate<p.timestamp){continue}if(q.starred!=undefined&&p.starred!=q.starred){continue}if(q.dirty!=undefined&&p.dirty!=q.dirty){continue}if((q.purge!=undefined&&p.purge!=q.purge)||(q.purge==undefined&&p.purge==1)){continue}if(q.articleid!=undefined&&p.id!=q.articleid){continue}if(q.link!=undefined&&p.link!=q.link){continue}if(q.tag!=undefined){if(p.tags==undefined||Array.isArray(p.tags)==false){continue}o=false;for(h=0;h<p.tags.length;h++){if(p.tags[h]==q.tag){o=true;break}}if(!o){continue}}if(m>=q.start){if(l<q.count){if(q.maxitemsperfeed){if(!g[p.feedid]){g[p.feedid]=0}if(g[p.feedid]<q.maxitemsperfeed){g[p.feedid]++}else{continue}}if(f){f(p)}n.push(p.id);l++}else{break}}m++}return n}};feedbro.DbIndex.SORT_DESCENDING=1;feedbro.DbIndex.SORT_ASCENDING=2;feedbro.DbIndex.SORT_POINTS=3;var feedbro=feedbro||{};feedbro.dndTable={};feedbro.dndTable.create=function(c,a){$("table#"+c+" > tbody").on("drop",function(f){f.preventDefault();var g=f.originalEvent.dataTransfer.getData("text");var d=document.getElementById(g);var e=$(f.target).parent();if(f.offsetY/e.height()<0.5){$(d).insertBefore(e)}else{$(d).insertAfter(e)}if(a){a(d)}});var b=$("table#"+c+" > tbody > tr");b.on("dragstart",function(d){d.originalEvent.dataTransfer.setData("text",d.target.id)});b.on("dragover dragenter dragleave",function(d){d.preventDefault()})};var feedbro=feedbro||{};feedbro.DribbblePlugin=function(){};feedbro.DribbblePlugin.prototype.canParse=function(a){return a&&a.indexOf("https://dribbble.com/")==0};feedbro.DribbblePlugin.prototype.parse=function(e,c,a,f){var b=this;var d=new XMLHttpRequest();d.onerror=function(){a.error={};a.error.message="Network error";a.error.code=398;a.status=398};d.onreadystatechange=function(h){var g=h.target;if(g.readyState==4){g.onreadystatechange=null;if(g.status!=0){g.onerror=null}if(g.status==200){var k=g.responseText;var i="";try{i=b.parseProfile(e.url,k)}catch(j){feedbro.log("Failed to parse: "+e.url)}if(c){c(e.url,g,i,a,f,true)}}else{c(e.url,g,"",a,f,true)}}};if(e.url.indexOf("https://dribbble.com/shots/")==-1){d.open("GET",e.url+"?stream=recent&page=1&per_page=24&exclude_shot_ids=",true)}else{d.open("GET",e.url)}d.withCredentials=true;d.timeout=20000;d.setRequestHeader("Cache-Control","no-cache");d.send()};feedbro.DribbblePlugin.prototype.parseProfile=function(a,h){var o=new feedbro.Strings();var i=[];var c;var n={};c={stag:["var newestShots = "],etag:"}];",postfix:"}]"};o.findNext(h,c);try{n=this.relaxedParse(c.match)}catch(j){}c={stag:['<meta property="og:title" content="'],etag:'"'};o.findNext(h,c);var b,e,d,g,f=(c.match||"Dribbble");var k=a.indexOf("https://dribbble.com/shots/")==0;c={stag:["<li",'data-screenshot-id="'],etag:'"'};while(true){o.findNext(h,c);if(c.match==null){break}b=c.match;c.stag=['<img src="'];c.etag="?";o.findNext(h,c);if(c.match==null){break}var l={};l.content="<div class='dribble-entry'><div><img class='dribbble-image' src='"+c.match+"'></div>";c.stag=['alt="'];c.etag='"';o.findNext(h,c);l.content+="<div class='dribbble-description'>"+c.match+"</div></div>";c.stag=['href="'];o.findNext(h,c);l.link="https://dribbble.com"+c.match;c.stag=['shot-title">'];c.etag="<";o.findNext(h,c);l.title=c.match;d=n[b]?n[b]:{};try{l.author=d.ga[0][0]}catch(j){l.author=f}if(k){g={spos:c.spos,stag:['class="user-information"','"display-name">'],etag:"<"};o.findNext(h,g);if(g.match){l.author=g.match}}e=new Date(d.published_at);if(!isNaN(e)){l.publishedDate=e}i.push(l);c.stag=["<li",'data-screenshot-id="'];c.etag='"'}return feedbro.Strings.toRSS(f+" | Dribbble",a,i)};feedbro.DribbblePlugin.prototype.relaxedParse=function(c){var b,a,d={};c=c.replace(/(['"])?([a-z0-9A-Z_]+)(['"])?:/g,'"$2":');c=c.replace(/: '([\w\., ]+)'/g,': "$1"');a=JSON.parse(c);for(b=0;b<a.length;b++){d[a[b].id]=a[b]}return d};var feedbro=feedbro||{};feedbro.EbayPlugin=function(){this._timeout=15000;this._strings=new feedbro.Strings();this._debug=false};feedbro.EbayPlugin.RE_M1=/([^\-]{2,5})-(\d{1,2}) (\d\d):(\d\d)/;feedbro.EbayPlugin.RE_M2=/(\d\d)(?:[.\- ]+)(.{3})\.* (\d\d):(\d\d)/;feedbro.EbayPlugin.M_EN={Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12};feedbro.EbayPlugin.M_DE={Jan:1,Feb:2,"Mär":3,Apr:4,Mai:5,Jun:6,Jul:7,Aug:8,Sep:9,Okt:10,Nov:11,Dez:12};feedbro.EbayPlugin.M_FR={"janv.":1,"févr.":2,mars:3,"avr.":4,mai:5,juin:6,"juil.":7,"août":8,sept:9,"oct.":10,"nov.":11,"déc":12};feedbro.EbayPlugin.M_IT={gen:1,feb:2,mar:3,apr:4,mag:5,giu:6,lug:7,ago:8,set:9,ott:10,nov:11,dic:12};feedbro.EbayPlugin.M_ES={ene:1,feb:2,mar:3,abr:4,may:5,jun:6,jul:7,ago:8,sep:9,oct:10,nov:11,dic:12};feedbro.EbayPlugin.M_AT={Jan:1,"Jän":1,Feb:2,Mrz:3,Apr:4,Mai:5,Jun:6,Jul:7,Aug:8,Sep:9,Okt:10,Nov:11,Dez:12};feedbro.EbayPlugin.M_CH={Jan:1,"Jän":1,Feb:2,Mrz:3,Apr:4,Mai:5,Jun:6,Jul:7,Aug:8,Sep:9,Okt:10,Nov:11,Dez:12};feedbro.EbayPlugin.M_PL={sty:1,lut:2,mar:3,kwi:4,maj:5,cze:6,lip:7,sie:8,wrz:9,"paź":10,lis:11,gru:12};feedbro.EbayPlugin.M_NL={jan:1,feb:2,mrt:3,apr:4,mei:5,jun:6,jul:7,aug:8,sep:9,okt:10,nov:11,dec:12};feedbro.EbayPlugin.M_HK={"1月":1,"2月":2,"3月":3,"4月":4,"5月":5,"6月":6,"7月":7,"8月":8,"9月":9,"10月":10,"11月":11,"12月":12};feedbro.EbayPlugin.getMonth=function(a){return feedbro.EbayPlugin.M_EN[a]||feedbro.EbayPlugin.M_DE[a]||feedbro.EbayPlugin.M_FR[a]||feedbro.EbayPlugin.M_IT[a]||feedbro.EbayPlugin.M_ES[a]||feedbro.EbayPlugin.M_AT[a]||feedbro.EbayPlugin.M_CH[a]||feedbro.EbayPlugin.M_PL[a]||feedbro.EbayPlugin.M_NL[a]||feedbro.EbayPlugin.M_HK[a]};feedbro.EbayPlugin.prototype.parseDate=function(g){if(g==null){return null}var f,c,b,d;var a=g.match(feedbro.EbayPlugin.RE_M1);if(a==null){a=g.match(feedbro.EbayPlugin.RE_M2);if(a!=null){c=a[1];f=feedbro.EbayPlugin.getMonth(a[2]);b=a[3];d=a[4]}}else{f=feedbro.EbayPlugin.getMonth(a[1]);c=a[2];b=a[3];d=a[4]}if(a==null||f==null){return null}var e=new Date();e.setMonth(f-1);e.setDate(parseInt(c));e.setHours(parseInt(b));e.setMinutes(parseInt(d));e.setSeconds(0);e.setMilliseconds(0);return isNaN(e)?null:e};feedbro.EbayPlugin.prototype.setDebug=function(a){this._debug=a};feedbro.EbayPlugin.prototype.canParse=function(a){return a&&a.indexOf("https://www.ebay")!=-1};feedbro.EbayPlugin.prototype.parse=function(b,g,i,e){var h=this;var a={};try{a=this._strings.getQueryParams(new URL(b.url).search)}catch(c){}var f=new XMLHttpRequest();f.onerror=function(){i.error={};i.error.message="Network error";i.error.code=398;i.status=398};f.onreadystatechange=function(k){var j=k.target;if(j.readyState==4){j.onreadystatechange=null;if(j.status!=0){j.onerror=null}var m="";if(j.status==200){try{m=h.toRSS(j.responseText,b.url,a._nkw,b.maxEntries)}catch(l){}}g(b.url,j,m,i,e,true)}};var d=b.url;f.open("GET",d,true);f.timeout=b.timeout?(b.timeout+0):10000;f.send()};feedbro.EbayPlugin.prototype.toRSS=function(C,f,c,h){var v={stag:["<title>"],etag:"</title>"};var o=new feedbro.Strings();var b=new DOMParser();var A,j,k,u;o.findNext(C,v);var q=this;var l=[];var t=o.unescapeHtml(v.match||"");var z=new XMLSerializer();var n;var r=/https:\/\/([\.\w]+)\/itm\/(\d+)\?/;if(h==null){h=20}v={stag:["<li data-viewport="],etag:"</li>",prefix:"<li data-viewport="};while(true){o.findNext(C,v);if(v.match==undefined){break}n=v.match;n=n.replace(new RegExp(" (src|srcset|rel|onload|preload|autoplay)=","gi")," data-$1=");n=o.switchTags(n,feedbro.ClearBody.tagFlipMap);A=b.parseFromString(n,"text/html");var i=A.querySelector(".s-item__link").getAttribute("href");var p=A.querySelector(".s-item__image img").getAttribute("data-src");var D=A.querySelector(".s-item__title > span");var w=A.querySelector(".s-item__price");var B=A.querySelector(".s-item__listingDate > span");var a=A.querySelector(".s-item__location");var d=A.querySelector(".s-item__shipping");var g=A.querySelector(".s-item__purchaseOptionsWithIcon");var x=A.querySelector(".s-item__subtitle > span.SECONDARY_INFO");if(D&&D.firstElementChild&&D.firstElementChild.tagName=="SPAN"){D.firstElementChild.remove()}D=D.innerText;if(D=="Shop on eBay"){continue}var y={};k=[];k.push('<div class="ebay-entry"><div class="ebay-image" alt="eBay product"><img src="');k.push(p);k.push('"></div><div class="ebay-info"><div class="ebay-title">');k.push(D?q._strings.escapeHtml(D):"");k.push('</div><div class="ebay-subtitle">');k.push(x?q._strings.escapeHtml(x.innerText):"");k.push('</div><div class="ebay-price">');k.push(w?q._strings.escapeHtml(w.innerText):"");k.push('</div><div class="ebay-purchaseOptions">');k.push(g?q._strings.escapeHtml(g.innerText):"");k.push('</div><div class="ebay-shipping">');k.push(d?q._strings.escapeHtml(d.innerText):"");k.push('</div><div class="ebay-location">');k.push(a?q._strings.escapeHtml(a.innerText):"");k.push("</div></div></div>");u=i.match(r);y.link="https://"+u[1]+"/itm/"+u[2];y.title=D;y.guid=u[2];y.content=k.join("");y.author="eBay seller";if(B){y.publishedDate=q.parseDate(B.innerText)}if(l.length<h){l.push(y)}}return feedbro.Strings.toRSS(t,f,l)};var feedbro=feedbro||{};feedbro.EnclosureHandler=function(){this.createTag=function(l,g){if(g==undefined){return"<span></span>"}var h="",j=g.type,d=g.url;var k,e,i=false,f,c;j=(j||"").replace(/[^\w\/\-]+/g,"");d=(d||"").replace(/[<>"']+/g,"");c="<span class='enclosure-name'>"+feedbro.Strings.escapeHtml(b(d))+"</span>";if(j!=undefined){if(j!="null"){k="<span class='enclosure-type'>["+j+"]</span>"}else{k="<span class='enclosure-type'></span>";f=(g.url||"").match(/\.(png|gif|jpg|jpeg)/i);if(f){j="image/"+f[1];k="<span class='enclosure-type'>["+j+"]</span>"}}if(a(j,"audio/mpeg3")||a(j,"audio/mp3")||a(j,"audio/x-mpeg")||a(j,"audio/x-mpeg-3")||a(j,"audio/x-m4a")){j="audio/mp4"}if(a(j,"video/x-m4v")){j="video/mp4"}if(a(j,"image/")){h+='<div class="enclosure enclosure-image" data-url="'+d+'" data-type="'+j+'">'}else{if(a(j,"video/webm")||a(j,"video/ogg")||a(j,"video/mp4")||a(j,"video/mpeg")){h+='<div class="enclosure enclosure-video" data-url="'+d+'" data-type="'+j+'">'}else{if(a(j,"audio/webm")||a(j,"audio/mpeg")||a(j,"audio/ogg")||a(j,"audio/wav")){h+='<div class="enclosure enclosure-audio" data-url="'+d+'" data-type="'+j+'">'}else{h+='<div class="enclosure enclosure-other" data-url="'+d+'" data-type="'+j+'">';i=true}}}if(i==false){h+='<div class="enclosure-caption"><span class="enclosure-viewlink">'+Locale.i18n("article_action_enclosure_view",true)+"</span> "+Locale.i18n("article_action_enclosure_view_enclosure",true)+' <a class="enclosure-link" href="'+d+'">'+c+"</a> "+k+"</div></div>"}else{h+='<div class="enclosure-caption">'+Locale.i18n("article_action_enclosure_label",true)+' <a class="enclosure-link" href="'+d+'">'+c+"</a> "+k+"</div></div>"}h=$(h);h.find("span.enclosure-viewlink").click(function(){var m=$(this).parent().parent();if(m.hasClass("open-enclosure")){if(m.hasClass("enclosure-audio")){e=m.find("audio");e[0].pause();e.remove()}else{if(m.hasClass("enclosure-video")){e=m.find("video");e[0].pause();e.remove()}else{if(m.hasClass("enclosure-image")){e=m.find("img");e.remove()}}}m.find("div.enclosure-content").remove();m.removeClass("open-enclosure");$(this).html("View");return}if(m.hasClass("enclosure-audio")){m.append('<div id="enclosure-content-'+l+'" class="enclosure-content"><audio src="'+m.data("url")+'" type="'+m.data("type")+'" preload="metadata" controls="controls"></audio></div>')}else{if(m.hasClass("enclosure-video")){m.append('<div id="enclosure-content-'+l+'" class="enclosure-content"><video src="'+m.data("url")+'" type="'+m.data("type")+'" preload="metadata" controls="controls"></video></div>')}else{if(m.hasClass("enclosure-image")){m.append('<div id="enclosure-content-'+l+'" class="enclosure-content"><img src="'+m.data("url")+'"/></div>')}}}m.addClass("open-enclosure");$(this).html("Hide")})}return h};function b(e){var d,c=e.lastIndexOf("/");if(c<0){d=e}else{d=decodeURIComponent(e.substring(c+1))}if(d.length>100){return d.substring(0,100)+"..."}else{return d}}function a(d,c){return d.indexOf(c)==0}};var feedbro=feedbro||{};feedbro.Engine=function(){var aG=this;var c=0;var H;var a2;var r=-1;var d;var p='<a href="" id="" title="" target="" onclick="" style=""></a><br />';var a1=false;var aU=new feedbro.InviewObserver("div#feed");var M=new feedbro.Strings();var i=new feedbro.EnclosureHandler();var ah=new feedbro.FeedIconManager();var aY=new feedbro.FeedFinder();var m=new feedbro.MathJax();var L=new feedbro.TagSelect();var S;var q={email:"mailto:?subject={TITLE}&body={URL}",facebook:"https://www.facebook.com/sharer/sharer.php?u={URL}&t={TITLE}",google:"https://plus.google.com/share?url={URL}",twitter:"https://twitter.com/intent/tweet?text={TITLE}&url={URL}",linkedin:"https://www.linkedin.com/shareArticle?mini=true&url={URL}&title={TITLE}",digg:"https://digg.com/submit?phase=2&url={URL}&amp;title={TITLE}",stumbleupon:"http://www.stumbleupon.com/submit?url={URL}&title={TITLE}",reddit:"https://www.reddit.com/submit?title={TITLE}&url={URL}",tumblr:"https://www.tumblr.com/share/link?url={URL}&name={TITLE}",friendfeed:"https://friendfeed.com/?url={URL}&amp;title={TITLE}",instapaper:"https://www.instapaper.com/edit?url={URL}&title={TITLE}&summary=",gmail:"https://mail.google.com/mail/?view=cm&fs=1&su={TITLE}&body={URL}",yammer:"https://www.yammer.com/home/bookmarklet?t={TITLE}&u={URL}",pocket:"https://getpocket.com/save?url={URL}&title={TITLE}",evernote:"https://www.evernote.com/clip.action?url={URL}&title={TITLE}",readability:"https://www.readability.com/save?url={URL}",flipboard:"https://share.flipboard.com/bookmarklet/popout?v=2&title={TITLE}&url={URL}",hootsuite:"https://hootsuite.com/hootlet/social-share?partner=hootlet&url={URL}&title={TITLE}",buffer:"https://bufferapp.com/add?url={URL}&title={TITLE}",telegram:"https://t.me/share/url?url={URL}&text={TITLE}",vk:"https://vk.com/share.php?url={URL}&title={TITLE}",gtranslate:"https://translate.google.com/translate?tl={TOLANG}&sl=auto&ie=UTF-8&u={URL}"};function J(){return chrome.extension.getBackgroundPage().feedbrobg}function n(a5,a4){if(a1==false){return}if(a4==undefined){console.log(a5)}else{console.log(a5,a4)}}function af(a5,a4){chrome.tabs.query({title:a5},function(a6){if(a6.length>0){chrome.tabs.update(a6[0].id,{active:true})}else{chrome.tabs.create({url:chrome.runtime.getURL(a4)},function(a7){})}})}function u(){$("div#navigator").tree("selectNode",null);$("div#starreditems").removeClass("menu-selected");$("div#allitems").removeClass("menu-selected");$("div#stats").removeClass("menu-selected");$("div#rulenav").removeClass("menu-selected");$("div#tagnav").removeClass("menu-selected")}function f(){J().saveData()}function at(a4){return a4?a4.replace(/[&<>"'`]/g,function(a5){return"&#"+a5.charCodeAt(0)+";"}):a4}function aS(a4){return a4?a4.replace(/[<>]/g,function(a5){return"&#"+a5.charCodeAt(0)+";"}):a4}function ai(a5,a4){return"<span class='keepunread'><input class='unreadbox' style='vertical-align: middle;' type='checkbox' "+(a4&&a5.unread==1?"checked='checked' ":"")+"id='unread-"+a5.id+"' title='"+Locale.i18n("article_action_keepunread_title",true)+"'> <label for='unread-"+a5.id+"'>"+Locale.i18n("article_action_keepunread_body",true)+"</label></span>"}function ak(a4){return"<div class='tags' title='"+Locale.i18n("article_action_tags_title",true)+"' data-id='"+a4.id+"'></div>"}function aB(a4){return"<a class='delete-entry articletrash' data-id='"+a4.id+"' title='"+Locale.i18n("article_action_delete_title",true)+"'><img data-id='"+a4.id+"' src='images/trash.png' class='articletrashicon'>"+Locale.i18n("article_action_delete_body",true)+"</a>"}function N(a8,a6){var a5;var a7="images/feed-icon-bw.png";if(a6>0){a5='<div class="node"><div class="node-unread" title="'+Locale.i18n("navigator_tree_unread",true)+'">'+a6+"</div>";a7="images/feed-icon.png"}else{a5='<div class="node empty-node">'}if(S==undefined){S=J().getSettings()}if(a8.type==1&&S.getUseFavIcons()==true){a7=ah.getIconFromGoogleCache(a8.htmlUrl)}var a4="";if(a8.type==2){a4="<img src='images/folder-icon.svg' class='treeFolderIcon'>"}else{if(a8.type==1){a4="<img src='"+a7+"' class='treeFeedIcon'>"}}a5+='<div class="node-text'+(a6>0?" node-unreadtext":"")+'" style="float: none; width: auto; overflow: hidden;" title="'+at(a8.realname||a8.name)+" - "+Locale.i18n("navigator_tree_rightclickoptions",true)+'">'+a4+at(a8.name)+"</div>";a5+="</div>";return a5}function z(a4){var a5=J().getFeedTree().getNode(a4.id).data;return N(a5,a5.unread)}function U(){var a5,a4,a7,a6,a9,ba,a8=Object.assign([],J().getTreeData());for(a5=0;a5<a8.length;a5++){a7=a8[a5];if(a7.type==2){a6=a7;a9=0;for(a4=0;a4<a6.children.length;a4++){ba=a6.children[a4];a9+=ba.unread;ba.name=N(ba,ba.unread)}a6.name=N(a6,a9)}else{if(a7.type==1){a7.name=N(a7,a7.unread)}else{n("Unidentified tree data entry: "+JSON.stringify(a7))}}}return a8}function R(a7,a6){H=a7;if(!a7){return}var a5=a7.node;var a4={key:a5.name,id:a5.id};if(!a6){u()}if(a7.action){a4.action=a7.action;if(a4.action=="feedstats"){ae();return}if(a4.action=="tagcloud"){ag();return}if(a4.action=="rulelist"){d.printRuleList();return}if(a4.action=="loadstarred"){a4.starred=1}if(a4.action=="loadtag"){a4.tag=a7.tag}}else{if(a5.type==2){a4.action="loadgroupdao"}else{if(a5.type==1){a4.action="loadsingledao"}else{n("handleLoadEntries: invalid node type: "+a5.type);return}}}a4.firstload=true;Y(a4)}function aq(a4){switch(a4){case 0:case undefined:return Locale.i18n("loadstatus_0",true);case 200:case 304:return Locale.i18n("loadstatus_200",true);case 398:return Locale.i18n("loadstatus_398",true);case 399:return Locale.i18n("loadstatus_399",true);case 401:return Locale.i18n("loadstatus_401",true);case 403:return Locale.i18n("loadstatus_403",true);case 404:return Locale.i18n("loadstatus_404",true);case 500:return Locale.i18n("loadstatus_500",true);case 503:return Locale.i18n("loadstatus_503",true);case 601:return Locale.i18n("loadstatus_601",true);case 602:return Locale.i18n("loadstatus_602",true);case 603:return Locale.i18n("loadstatus_603",true);default:return Locale.i18n("loadstatus_broken",true)}}function aZ(){var a4=[];J().processNodes(function(a5){if(a5.data.type==1){a4.push(a5)}},5);a4.sort(function(a6,a5){if(a6.data.status&&!a5.data.status){return 1}if(!a6.data.status&&a5.data.status){return -1}if(!a6.data.status&&!a5.data.status){return 0}var a7=a6.data.status-a5.data.status;if(a7!=0&&(a6.data.status>304||a5.data.status>304)){return a7}return a5.data.latestitem-a6.data.latestitem});return a4}function ae(){var a5=aZ();$("div#feed").empty();if(a5.length==0){$("div#feed").html("<div class='info'><div class='info-message'>"+Locale.i18n("statsview_no_feeds",true)+"</div></div>");return}var a9,a7,a8,bg,be,a4,bf,ba="";var bd=Locale.i18n("statsview_table_rowclick_title",true);var a6=Locale.i18n("statsview_table_days",true);var bb=Locale.i18n("statsview_table_default",true);ba+="<table class='feedtable'><thead><tr><th></th>";ba+="<th style='text-align: left'>"+Locale.i18n("statsview_table_feedtitle",true)+"</th>";ba+="<th>"+Locale.i18n("statsview_table_properties",true)+"</th>";ba+="<th style='text-align: right'>"+Locale.i18n("statsview_table_latestupdate",true)+"</th>";ba+="<th>"+Locale.i18n("statsview_table_status",true)+"</th>";ba+="<th title='"+Locale.i18n("statsview_table_scandelay_title",true)+"'>"+Locale.i18n("statsview_table_scandelay",true)+"</th>";ba+="<th>"+Locale.i18n("statsview_table_selected",true)+"</th></tr></thead>";ba+="<tbody>";var bc=J().getSettings().getInactiveFeedLimit();for(a9=0;a9<a5.length;a9++){a7=a5[a9];a8="";bg=0;be=false;if(a7.data.latestitem>0){a4=new Date(a7.data.latestitem);bg=Math.ceil((new Date().getTime()-a4.getTime())/(24*60*60*1000));a8=bg+" "+a6}if(bg>bc||a7.data.status>=400){be=true}bf=a7.data.scandelay?a7.data.scandelay:bb;ba+="<tr class='feedtablerow'><td align='right'>"+(a9+1)+".</td>";ba+="<td><a class='feedlink' title='"+bd+"' id='link-"+(a7.data.id)+"'>"+at(a7.data.name)+"</a></td>";ba+="<td><img data-id='"+a7.data.id+"' class='feedProperties' src='images/settings.png'></td><td align='right'>"+a8+"</td>";ba+="<td align='center'>"+aq(a7.data.status)+"</td>";ba+="<td align='center'>"+bf+"</td><td align='center'><input "+(be?"checked='checked'":"")+" type='checkbox' class='feedcheck' id='noderm-"+a7.data.id+"'/></tr>"}ba+="</tbody>";ba+="</table>";ba+="<center>";ba+="  <button id='removefeeds' class='alertify-button alertify-button-ok'>"+Locale.i18n("statsview_button_deleteselected",true)+"</button>";ba+="  <button id='uncheckall' class='alertify-button alertify-button-ok'>"+Locale.i18n("statsview_button_unselectall",true)+"</button>";ba+="</center>";$("div#feed").append(ba);$("button#uncheckall").click(function(){$(".feedcheck").prop("checked",false)});$("button#removefeeds").click(function(){var bh=$("input[class='feedcheck']:checked:enabled");if(bh.length<1){return}alertify.confirm(Locale.i18n("statsview_confirm_delete",false,bh.length),function(bi){if(bi){bh.each(function(){var bj=$(this).attr("id").substring(7);J().deleteFeed(bj)});$("div#navigator").tree("loadData",U());f();$("div#stats").click()}})});$("img.feedProperties").click(function(bi){bi.preventDefault();var bk=parseInt($(this).attr("data-id"),10);var bh=$("div#navigator").tree("getNodeById",bk);var bj=J().getFeedTree().getNode(bh.id).data;G(bj,bh.parent);return false});$("a.feedlink").click(function(){var bh=parseInt($(this).attr("id").substring(5),10);aH(bh)});$(document).scrollTop(0)}function aH(a8){u();var a7=$("div#navigator");var a6=a7.tree("getNodeById",a8);a7.tree("selectNode",a6);try{var a5=a7;a5.scrollTop($(a6.element).offset().top-a5.offset().top+a5.scrollTop())}catch(a4){n("Failed to scroll feed tree to chosen node")}R({node:{id:a8,type:1}},true)}function a(a5,a4){if(a4==true||a4==1){J().markUnread(a5,0);J().markDeleted(a5,a4);$("div#blogentrypost-"+a5).remove()}}function ac(){var a4=$(this);var a5=parseInt(a4.attr("data-id"),10);J().markUnread(a5,0);$("div#feed > div#blogentrypost-"+a5).removeClass("unread")}function o(a7){var a5=$("div#navigator");var a6=a5.tree("getNodeById",a7);if(!a6){n("Non-existent tree node: "+a7);return}var a4=J();if(a6.type==1){a5.tree("updateNodeLabel",a6,z(a6));if(a6.parent.parent){a4.getFolderUnreadCount(a6.parent.id);a6=a5.tree("getNodeById",a6.parent.id);a5.tree("updateNodeLabel",a6,z(a6))}}else{if(a6.type==2){a4.getFolderUnreadCount(a7);a5.tree("updateNodeLabel",a6,z(a6))}else{n("Unidentified node type: "+a6.type)}}a4.updateTotalUnread()}function a3(a6){var a4=$("div#navigator").tree("getNodeById",a6);var a5=J().getFeedTree().getNode(a4.id).data;if(a4.type==1){alertify.confirm(Locale.i18n("navigator_action_deletefeed_confirm",false,a5.name),function(a8){if(a8){var a7=a4.parent;$("div#navigator").tree("removeNode",a4);J().deleteFeed(a6);if(a7.parent){o(a7.id)}f()}})}else{alertify.confirm(Locale.i18n("navigator_action_deletefolder_confirm",false,a5.name),function(a7){if(a7){$("div#navigator").tree("removeNode",a4);J().deleteFolder(a6);J().updateTotalUnread();f()}})}}function aV(a6){var a4=$("div#navigator").tree("getNodeById",a6);var a5=J().getFeedTree().getNode(a4.id).data;alertify.prompt(Locale.i18n("navigator_action_rename_prompt",false),function(a8,a9){if(a8){var a7=a9;if(a7.length<1||a7.length>60){alertify.error(Locale.i18n("navigator_action_rename_toolong",false,a7.length));return}a5.name=a7;o(a4.id);f()}},a5.name)}function aW(){$("div.entry-body").css({display:(c==feedbro.Engine.VIEWMODE_HEADLINES?"none":"block")});if(c==feedbro.Engine.VIEWMODE_HEADLINES){$("div.entry").addClass("compact-headline")}else{$("div.entry").removeClass("compact-headline")}}function aX(a5,a4){return function(){a5.find("input#feed-url").val($(this).attr("href"));a4.css({display:"none"});a5.find("button#feed-get").click();return false}}function aw(a4){var a5={node:{name:"searchtag"},action:"loadtag",tag:a4};R(a5,true)}function ag(){var a4=J().getTagCloud();var a8=Object.keys(a4);var a7,a6,a5="<div class='feed-header'></div>";M.sortIgnoreCase(a8);if(a8.length>0){a5+="<table class='feedtable tagtable'><thead><tr>";a5+="<th class='feedtableTh tagtableCount'>"+Locale.i18n("tagview_articles_body",true)+"</th>";a5+="<th class='feedtableTh'>"+Locale.i18n("tagview_tag_body",true)+"</th></tr></thead>";a5+="<tbody>";var a9=Locale.i18n("tagview_table_row_title",true);for(a7=0;a7<a8.length;a7++){a6=M.escapeHtml(a8[a7]);a5+="<tr class='feedtablerow'><td class='feedtableTd tagtableCount'>"+a4[a8[a7]]+"</td><td class='feedtableTd'><div class='taglink' data-key='"+a6+"' title='"+a9+"'>"+a6+"</div></td></tr>"}a5+="</tbody>";a5+="</table>"}else{a5+="<div class='info'><div class='info-message'>"+Locale.i18n("tagview_notags_body",true)+"</div></div>"}$("div#feed").empty();$("div#feed").html(a5);$("div#feed").find("div.taglink").click(function(){var ba=$(this).attr("data-key");aw(ba)})}function G(a9,be){var bc=$("div#feeddialog");a2=a9.id;bc.find("span#feed-alternatives").css({display:"none"});bc.find("input#feed-url").val(a9.url||"");bc.find("input#feed-title").val(a9.name||"");bc.find("span#feed-status").html(a9.status?aq(a9.status):"");bc.find("span#feed-lastposted").html(a9.latestitem>0?M.timeAgo(a9.latestitem):"-");bc.find("input#feed-username").val(a9.username||"");bc.find("input#feed-password").val(a9.password||"");bc.find("select#feed-proxy").val(a9.proxy||0);var a5=J().getFolders();var bb=be?be.id:J().getLastFolderId();if(bb==undefined){bb=-1}var a7=bc.find("select#feed-folder");var a6,bd,a8,a4,ba="<option value='-1'>"+Locale.i18n("common_root",true)+"</option>";for(a8=0;a8<a5.length;a8++){a4="";if(a5[a8].id==bb){a4=" selected='selected'"}ba+="<option"+a4+' value="'+a5[a8].id+'">'+a5[a8].name+"</option>"}a7.html(ba);bc.find("select#feed-maxitems").val(a9.maxitems||"default");bc.find("select#feed-scandelay").val(a9.scandelay||"default");bc.find("select#entrycontent").val(a9.entrycontent||"1");bc.css({display:"block"});a6=(window.innerWidth/2)-(bc.outerWidth()/2);bd=(window.innerHeight/2)-(bc.outerHeight()/2);bc.css({top:bd+"px",left:a6+"px"});bc.find("input#feed-url").focus()}function aQ(){var bi=$("div#feeddialog");var bc=bi.find("select#feed-maxitems option:selected").val();var bj=bi.find("select#feed-scandelay option:selected").val();var bh=parseInt(bi.find("select#feed-proxy option:selected").val(),10);var bd=J();var a9=bi.find("input#feed-url").val();if(!a9||a9==""||jQuery.trim(a9)==""||a9.length<5){alertify.alert(Locale.i18n("savefeed_error_url",false));return}var bo=bi.find("input#feed-title").val();if(!bo||bo==""||jQuery.trim(bo)==""||bo.length<2){alertify.alert(Locale.i18n("savefeed_error_title",false));return}if(bc=="default"){bc=undefined}else{bc=parseInt(bc,10)}if(bj=="default"){bj=undefined}else{bj=parseInt(bj,10)}var a7;var bm=bi.find("select#feed-folder").val();var bn=parseInt(bi.find("select#entrycontent").val(),10);bd.setLastFolderId(parseInt(bm,10));var bg=bd.getFeedTree().getNode(a2);if(!bg){var a4=bd.getNodesWithUrl(a9);if(a4.length>0){bg=a4[0];var bk;if(bg.parent&&bg.parent.data&&bg.parent.data.type==2){bk=bg.parent.data.name}if(bk){alertify.alert(Locale.i18n("savefeed_error_duplicate_infolder",false,bk,bg.data.name))}else{alertify.alert(Locale.i18n("savefeed_error_duplicate",false,bg.data.name))}return}var bf=bd.addFeed(a9,bo,bo,bm);if(bm!=-1){$("div#navigator").tree("appendNode",{name:bo,id:bf,type:1},$("div#navigator").tree("getNodeById",bm))}else{$("div#navigator").tree("appendNode",{name:bo,id:bf,type:1})}bg=bd.getFeedTree().getNode(bf);a7=bf}var bl=bg.data;bl.maxitems=bc;bl.scandelay=bj;bl.proxy=bh;bl.name=bo;bl.url=a9;bl.entrycontent=bn;var a6=bi.find("input#feed-username").val();var a5=bi.find("input#feed-password").val();if(a6&&a6!=""){bl.username=a6;bl.password=a5}var be=bg.parent.data?bg.parent.data.id:-1;if(bm!=be){bd.moveNode(bg.data.id,bm,"inside");var ba=$("div#navigator").tree("getNodeById",bg.data.id);var bb;if(bm!=-1){bb=$("div#navigator").tree("getNodeById",bm)}else{bb=$("div#navigator").tree("getRoot")}var a8=ba.parent.id;$("div#navigator").tree("moveNode",ba,bb,"inside");o(ba.id);if(a8){o(a8)}}if(a7!=undefined){bd.loadFeedItems(a7)}bd.saveData();bi.find("button#feed-cancel").click();if(bg){o(bg.data.id)}}function ar(a4){if(a4){var a5=J().getSettings().getConfirmMarkReadMode();if(a5==3){alertify.confirm(Locale.i18n("navigator_action_markread_confirm",false,J().getFeedTree().getNode(a4.id).data.name),function(a6){if(a6){J().markAsRead(a4.id);al(a4)}})}else{J().markAsRead(a4.id);al(a4)}}else{alertify.alert(Locale.i18n("navigator_action_markread_noselection",false))}}function x(){var a4=J().getSettings().getConfirmMarkReadMode();if(a4==2||a4==3){alertify.confirm(Locale.i18n("navigator_action_markread_all_confirm",false),function(a5){if(a5){J().markAllAsRead();al()}})}else{J().markAllAsRead();al()}}function al(a4){if($("div#navigator").tree("getSelectedNode")==a4||$("div#mainfunctions div#starreditems").hasClass("menu-selected")||$("div#mainfunctions div#allitems").hasClass("menu-selected")||$("div#mainfunctions div#tagnav").hasClass("menu-selected")){$("div#titles div.item").removeClass("unread")}}function s(){if(H&&H.action=="loadall"){x()}else{ar($("div#navigator").tree("getSelectedNode"))}}function t(a7,a6,a9){if(a7.action=="addfeed"){var a8=J().getFeedTree().getNode(a7.id).data;if(a7.parentid<0){$("div#navigator").tree("appendNode",{name:a8.name,id:a7.id,type:1})}else{var a5=$("div#navigator").tree("getNodeById",a7.parentid);$("div#navigator").tree("appendNode",{name:a8.name,id:a7.id,type:1},a5)}o(a7.id)}else{if(a7.action=="updatenode"){o(a7.id)}else{if(a7.action=="reloaddata"){$("div#navigator").tree("loadData",U())}else{if(a7.action=="updatetheme"){w()}else{if(a7.action=="updateview"){aL()}else{if(a7.action=="updatecss"){ad()}}}}}}if(a9){try{a9()}catch(a4){n(a4)}}}function Y(a4){if(!a4.start){a4.start=0}if(!a4.count){a4.count=30}if(J().isUnreadSearch(a4)&&a4.single!=true){a4.unread=1}chrome.runtime.sendMessage(a4,function(a6){var a5=J().getFeedEntries();W(a4,a5,a5.length<1?{message:Locale.i18n("showarticles_nomatches",true)}:undefined);if(a4.id){o(a4.id)}})}function O(a6,a5){var a4=$("div#blogentrypost-"+a6+" > div.entry-title span.readtoggle-entry-upper > img");a4.attr("src",a5?"images/icon-unread.png":"images/icon-read.png")}function aI(a5){var a6=a5.prop("checked");var a8=parseInt(a5.attr("id").substring(7),10);J().markUnread(a8,a6?1:0);O(a8,a6);var a4=$("div#titles > div.activetitle");if(a4.length>0){if(a6){a4.addClass("unread")}else{a4.removeClass("unread")}}var a7=$("div.entry.active");if(a7.length>0){if(a6){a7.addClass("unread")}else{a7.removeClass("unread")}}}function aO(a7){var a8,a5=a7.attr("id");var a4=$("div.activetitle");if(!a5){return}var a6;if(a5.indexOf("topstar")==0){a8=a5.substring(8);a6=$("span#star-"+a8)}else{a8=a5.substring(5);a6=$("span#topstar-"+a8)}a8=parseInt(a8,10);if(a7.hasClass("starred")){a7.removeClass("starred");a6.removeClass("starred");if(a4.length>0){a4.find("div.item-pin").removeClass("pinned")}}else{a7.addClass("starred");a6.addClass("starred");if(a4.length>0){a4.find("div.item-pin").addClass("pinned")}}J().toggleItemStarred(a8)}function y(){var a5=1024;var a4=850;if(a4>screen.height){a4=screen.height-50}var a7=Math.round((screen.width/2)-(a5/2));var a6=Math.round((screen.height/2)-(a4/2));chrome.windows.create({url:chrome.runtime.getURL("help.html"),type:"popup",width:a5,height:a4,top:a6,left:a7})}function C(bb){var a6,a9,a4,a8,a5,bc,a7=$(bb.target);if(bb.target&&(a7.is("input")||a7.is("select")||a7.is("textarea"))){return}if(aM(bb,79,"S")||aM(bb,13,"S")){a4=$("div#navigator").tree("getSelectedNode");R({node:a4},true);ap(bb)}else{if(aM(bb,78,"S")||aM(bb,40,"S")){bc=$("div#navigator");a4=bc.tree("getSelectedNode");a8=J().getFeedTree().getNodeSibling(a4.id,2);if(a8){bc.tree("selectNode",bc.tree("getNodeById",a8.data.id))}ap(bb)}else{if(aM(bb,80,"S")||aM(bb,38,"S")){bc=$("div#navigator");a4=bc.tree("getSelectedNode");a8=J().getFeedTree().getNodeSibling(a4.id,1);if(a8){bc.tree("selectNode",bc.tree("getNodeById",a8.data.id))}ap(bb)}else{if(aM(bb,85)){an();ap(bb)}else{if(aM(bb,87)){$("div#togglepanel").click();ap(bb)}else{if(aM(bb,88,"S")){bc=$("div#navigator");a4=bc.tree("getSelectedNode");if(!a4){return}var ba=a4.parent;if(!ba.parent){ba=a4}bc.tree(ba.is_open?"closeNode":"openNode",ba,false);bc.tree("selectNode",ba);ap(bb)}else{if(bb.key=="?"||(bb.keyCode==187&&bb.shiftKey)){y();ap(bb)}else{if(aM(bb,65,"S")){s();ap(bb)}else{if(aM(bb,84)){aT();ap(bb)}else{if(aM(bb,33)||aM(bb,32,"S")){a5=$("div#feed");a5.scrollTop(a5.scrollTop()-a5.height());ap(bb)}else{if(aM(bb,34)||aM(bb,32)){a5=$("div#feed");a5.scrollTop(a5.scrollTop()+a5.height());ap(bb)}else{if(aM(bb,49)){au(0);ap(bb)}else{if(aM(bb,50)){au(1);ap(bb)}else{if(aM(bb,51)){au(2);ap(bb)}else{if(aM(bb,52)){au(3);ap(bb)}else{if(aM(bb,53)){au(4);ap(bb)}else{if(aM(bb,54)){au(5);ap(bb)}else{if(aM(bb,49,"A")){a9=J().getSettings().getQuickTag("qtag1");if(a9&&a9!=""){Z(a9)}ap(bb)}else{if(aM(bb,50,"A")){a9=J().getSettings().getQuickTag("qtag2");if(a9&&a9!=""){Z(a9)}ap(bb)}else{if(aM(bb,51,"A")){a9=J().getSettings().getQuickTag("qtag3");if(a9&&a9!=""){Z(a9)}ap(bb)}else{if(aM(bb,52,"A")){a9=J().getSettings().getQuickTag("qtag4");if(a9&&a9!=""){Z(a9)}ap(bb)}else{if(aM(bb,53,"A")){a9=J().getSettings().getQuickTag("qtag5");if(a9&&a9!=""){Z(a9)}ap(bb)}else{if(aM(bb,69)){a6="entry.active";if(c==2){a6="entry"}$("div."+a6).find("a.share").click();$("div.opt.email").click();ap(bb)}else{if(aM(bb,71)){a6="entry.active";if(c==2){a6="entry"}$("div."+a6).find("a.share").click();$("div.opt.gtranslate").click();ap(bb)}else{if(aM(bb,82)&&H){aL();ap(bb)}else{if(c==feedbro.Engine.VIEWMODE_OPERA||c==feedbro.Engine.VIEWMODE_OPERA_IFRAME){P(bb)}else{aE(bb)}}}}}}}}}}}}}}}}}}}}}}}}}}}function aM(a9,a8,a7){if(a9.keyCode!=a8){return false}var a6=false,ba=false,a4=false,a5=false;if(a7!=null){a6=(a7.indexOf("S")!=-1);ba=(a7.indexOf("C")!=-1);a4=(a7.indexOf("M")!=-1);a5=(a7.indexOf("A")!=-1)}return((a9.shiftKey==true)==a6)&&((a9.ctrlKey==true)==ba)&&((a9.metaKey==true)==a4)&&((a9.altKey==true)==a5)}function aL(){R(H,true)}function ap(a5){try{if(a5.preventDefault){a5.preventDefault()}}catch(a4){n("skipDefault failed: "+a4)}}function aE(bd){var a9=$("div.active");var ba,a8,bb;if(aM(bd,74)||aM(bd,78)||aM(bd,39,"S")){ba=a9.nextAll("div.entry:first");ap(bd)}else{if(aM(bd,75)||aM(bd,80)||aM(bd,37,"S")){ba=a9.prevAll("div.entry:first");ap(bd)}else{if(aM(bd,86)&&a9.length>0){chrome.tabs.create({url:a9.find("a.entry-link").attr("href"),active:false},function(bl){});a9.removeClass("unread");try{var a6=a9.attr("id");if(a6){a6=parseInt(a6.substring(a6.indexOf("-")+1),10);J().markUnread(a6,0)}}catch(be){n("Open post 'v' error: ",be)}ap(bd)}else{if(aM(bd,76)&&a9.length>0){var bk=a9.find("a.entry-link");var a4=bk.attr("href");var bh=bk.text();h(a4,bh);ap(bd)}else{if((aM(bd,13)||aM(bd,79))&&a9.length>0){if($("section#alertify").hasClass("alertify-confirm")==false){if(c==feedbro.Engine.VIEWMODE_NEWS||c==feedbro.Engine.VIEWMODE_NEWSLINEMODE){if(a9.hasClass("entry-newspaper")){a9.find("div.entry-newspaper-section").click()}else{a9.addClass("entry-newspaper");a9.find("div.entry-newspaper-section").css("display","block");var bc=$("div#feed");var a7=parseInt(bc.css("padding-top"),10);if(isNaN(a7)){a7=0}bc.scrollTop(bc.scrollTop()+Math.round(a9.offset().top)-A()-a7)}}else{a9.find("div.entry-header").click()}ap(bd)}}else{if((aM(bd,83)||aM(bd,83,"C"))&&a9.length>0){var bj=a9.find("> div.entry-body > div.itemlinks > span.star");aO(bj);ap(bd)}else{if(aM(bd,68,"S")){$("div.entry").each(function(bl,bn){var bm=$(bn);var bp=bm.attr("id");var bo=bp.indexOf("-");if(bo>0){bp=bp.substring(bo+1);a(bp,1)}});alertify.success(Locale.i18n("navigator_action_deleteall_success",false));ap(bd)}else{if(a9.length>0&&(aM(bd,68)||aM(bd,46))){var a5=a9.attr("id");if(a5==undefined){return}var bf=a5.indexOf("-");if(bf>0){a5=a5.substring(bf+1);$("div#blogentrypost-"+a5).hide();if(a9.nextAll("div.entry:first").length>0){C({keyCode:74})}else{C({keyCode:75})}a(a5,1)}ap(bd)}else{if(a9.length>0&&aM(bd,77)){av(parseInt(a9.attr("data-id"),10));ap(bd)}}}}}}}}}if(ba&&ba.length>0){var bi=$("div#feed");var bg=parseInt(bi.css("padding-top"),10);if(isNaN(bg)){bg=0}a9.removeClass("active");ba.addClass("active");bi.scrollTop(bi.scrollTop()+Math.round(ba.offset().top)-A()-bg)}}function P(bd){var a7=$("div.activetitle");var a9,a6,ba,a8;if(aM(bd,74)||aM(bd,78)||aM(bd,39,"S")){a9=a7.nextAll("div.item:first");ap(bd)}else{if(aM(bd,75)||aM(bd,80)||aM(bd,37,"S")){a9=a7.prevAll("div.item:first");ap(bd)}else{if(aM(bd,86)&&a7.length>0){chrome.tabs.create({url:$("div.entry").find("a.entry-link").attr("href"),active:false},function(bl){});ap(bd)}else{if(aM(bd,76)&&a7.length>0){var bk=$("div.entry").find("a.entry-link");var a4=bk.attr("href");var bf=bk.text();h(a4,bf);ap(bd)}else{if((aM(bd,83)||aM(bd,83,"C"))&&a7.length>0){var bi=$("div#feed div.entry-body div.itemlinks span.star");aO(bi);ap(bd)}else{if(bd.keyCode==68&&bd.shiftKey){$("div#titles > div.item[data-key]").each(function(bl,bn){var bm=$(bn);var bo=bm.attr("data-key");a(bo,1);bm.remove()});$("div.entry").remove();alertify.success(Locale.i18n("navigator_action_deleteall_success",false));ap(bd)}else{if(a7.length>0&&(aM(bd,68)||aM(bd,46))){var a5=a7.attr("data-key");$("div#blogentrypost-"+a5).hide();if(a7.nextAll("div.item:first").length>0){C({keyCode:74})}else{C({keyCode:75})}a7.remove();a(a5,1);ap(bd)}else{if(a7.length>0&&aM(bd,77)){av(parseInt($("div.entry").attr("data-id"),10));ap(bd)}}}}}}}}if(a9&&a9.length>0){a7.removeClass("activetitle");a9.addClass("activetitle");var bb=$("div#titles");var bh={top:bb.position().top,left:bb.position().left};bh.bottom=bh.top+bb.height();bh.right=bh.left+bb.width();if(!X(a9,bh)){var bc=a9.position().top;var be=a9.outerHeight();var bg=bc+be;var bj=bb.height();if(bg>bj){bb.scrollTop(bb.scrollTop()+bg-bj-A())}else{if(bc<bh.top){bb.scrollTop(bb.scrollTop()-(bh.top-bc))}}}a9.click()}}function h(a5,a7,a4){var a6="https://getpocket.com/edit.php?url="+a5+"&title="+a7;if(a4){a6=a6+"?tags="+encodeURIComponent(a4.replace(/,/g," "))}$.get(a6,function(ba){if(ba.indexOf("You have successfully saved")!=-1){alertify.set({delay:2000});alertify.success(Locale.i18n("article_action_pocket_success",false,a7))}else{var a9=870;var a8=700;var bc=(screen.width/2)-(a9/2);var bb=(screen.height/2)-(a8/2);window.open(a6,"pocket","toolbar=no,scrollbars=0,width="+a9+",height="+a8+",top="+bb+",left="+bc)}})}function X(a6,a4){var a7=$(a6);var a5={top:a7.offset().top,left:a7.offset().left};a5.bottom=a5.top+a7.height();a5.right=a5.left+a7.width();if(a5.top<a4.top||a5.bottom>a4.bottom||a5.left<a4.left||a5.right>a4.right){return false}else{return true}}function l(){G({id:-1000})}function b(){alertify.prompt(Locale.i18n("navigator_action_addfolder_prompt",false),function(a5,a6){if(a5){var a4=a6;if(!a4||a4==""){return}if(a4.length<1||a4.length>35){alertify.error(Locale.i18n("navigator_action_addfolder_toolong",false));return}var a7=J().addFolder(a4);$("div#navigator").tree("appendNode",{name:a4,id:a7,type:2});o(a7);f()}})}function k(a4){var a6=a4.position();var a5=$("div#feedbro-sharebox");a5.css({display:"block",top:(1+a6.top+a4.outerHeight())+"px",left:a6.left+"px"});if(a5.position().top-$(window).scrollTop()+a5.outerHeight()>$(window).height()){a5.css({top:a6.top-a5.outerHeight()-1})}a5.attr("data-url",a4.attr("data-url"));a5.attr("data-title",a4.attr("data-title"));return false}function g(a4){var a6=a4.getAttribute("id");var a5=parseInt(a6.substring(8),10);J().markUnread(a5,0)}function E(a4){var a7,bc,ba,a6,a9=$(a4.target);var bb=false;if(a9.hasClass("star")){aO(a9);bb=true}else{if(a9.hasClass("unreadbox")){aI(a9);bb=true}else{if(a9.hasClass("articletrashicon")||a9.hasClass("articletrash")){B(a4);a4.preventDefault();bb=true}else{if(a9.hasClass("share")){k(a9);bb=true}else{if(a9.hasClass("articlemarkreadicon")){av(parseInt(a9.attr("data-id"),10));bb=true}else{if(a9.hasClass("fromlinefavicon")){aH(parseInt(a9.attr("data-feedid"),10));bb=true}}}}}}if(bb){a4.stopPropagation();return}if(a4.target!=this&&a9.hasClass("itemlinks")==false&&a9.hasClass("entry-title-wrapper")==false&&a9.hasClass("entry-title-wrapper-dummy")==false&&a9.hasClass("entry-header")==false&&a9.hasClass("entry-title")==false&&a9.hasClass("fromline")==false&&a9.hasClass("entry-date")==false&&a9.hasClass("entry-title-td")==false){return}a7=$("div.active");if(a7.length>0){a7.removeClass("active")}a6=$(this);a6.addClass("active");if(c==feedbro.Engine.VIEWMODE_HEADLINES){var a5=a6.find("div.entry-body");var a8=a6.find("td.entry-title-td > div");bc=a5.css("display")||"block";ba=(bc=="none"?"block":"none");if(ba=="block"){aD(a5.find("blockquote:first"))}a5.css({display:ba});if(ba=="block"){a6.removeClass("clickopen");a6.attr("title","");a8.removeClass("entry-title-wrapper");a8.addClass("entry-title-wrapper-dummy")}else{a6.addClass("clickopen");a6.attr("title",Locale.i18n("article_header_clickopen",true));a8.removeClass("entry-title-wrapper-dummy");a8.addClass("entry-title-wrapper")}}}function aC(a5,a4){J().removeTag(a5,a4)}function az(a5,a4){J().addTag(a5,a4)}function ab(a4){aw(a4)}function K(a9){var a6=J().getTagCloud();var a8,a5=Object.keys(a6);var a7=a9.toLowerCase();var a4=[];for(a8=0;a8<a5.length;a8++){if(a5[a8].toLowerCase().indexOf(a7)==0){a4.push(a5[a8])}}return a4}function B(a6){if(c==feedbro.Engine.VIEWMODE_OPERA||c==feedbro.Engine.VIEWMODE_OPERA_IFRAME){C({keyCode:68})}else{var a5=$(a6.target);var a8=a5.attr("data-id");var a7=$("div.entry.active");if(a7.length>0&&a7.attr("id")==("blogentrypost-"+a8)){var a4=a7.next("div.entry");if(a4.length==0){a4=a7.prev("div.entry")}if(a4.length>0){a7.removeClass("active");a4.addClass("active")}}a(a8,1)}a6.stopPropagation();return false}this.setDebug=function(a4){a1=a4};this.previewFeed=function(a5,a6,a8,a7,a4){J().previewFeed(a5,a6,a7,a4,function(a9){var bb={action:"preview",firstload:true};var bd={author:a9.feed.author,title:a9.feed.title,link:a9.feed.link,url:a5,name:a9.feed.title,status:a9.status,latestitem:0};if(a9.feed.latestitemdate){bd.latestitem=a9.feed.latestitemdate.getTime()}if(a9.feed.entries){var ba,bc=a9.feed.entries.length;for(ba=0;ba<bc;ba++){a9.feed.entries[ba].feed=bd}}bb.feed=bd;W(bb,a9.feed.entries);if(a8){a8()}})};function W(a7,a4){S=J().getSettings();if(a7.action=="loadsingle"||a7.action=="preview"){try{var a5=c;c=feedbro.Engine.VIEWMODE_FULL;ao(a7,a4);c=a5}catch(a6){n("displayFeedItems load single failed",a6)}}else{if(c==feedbro.Engine.VIEWMODE_FULL||c==feedbro.Engine.VIEWMODE_HEADLINES||c==feedbro.Engine.VIEWMODE_NEWS||c==feedbro.Engine.VIEWMODE_NEWSLINEMODE){try{ao(a7,a4)}catch(a6){n("displayFeedItemsStandard failed",a6)}}else{if(c==feedbro.Engine.VIEWMODE_OPERA||c==feedbro.Engine.VIEWMODE_OPERA_IFRAME){try{F(a7,a4)}catch(a6){n("displayFeedItemsOpera failed",a6)}}}}V()}function V(){try{feedbro.Youtube.process()}catch(a4){n("Failed to process Youtube video elements",a4)}}function aa(a4){if(a4){$("div#titles").show();$("div#dragbar2").show()}else{$("div#titles").hide();$("div#dragbar2").hide()}}function aP(a6,a5,a9){if(a6.firstload==true){aU.clear();var a8=$("div#titles");a8.find("div.item").removeData("feeditem");a8.empty();var a4=$("div#feed");a4.empty();a4.html("<div class='feed-header'></div>");a4.attr("data-viewmode",(c+1));if(a6.action=="preview"&&a6.feed){if(a6.feed.status!=200){a4.append("<div class='previewheader-error'>"+Locale.i18n("preview_error",true)+": <a rel='noopener noreferrer' href='"+a6.feed.url+"'>"+a6.feed.status+"</a> "+aq(a6.feed.status)+"</div>")}else{a4.append("<div class='previewheader'><div class='previewheader-text'>"+Locale.i18n("preview_header",true)+" <a rel='noopener noreferrer' href='"+a6.feed.url+"'>"+M.escapeHtml(a6.feed.title)+"</a></div><button id='addpreviewfeed' class='alertify-button alertify-button-ok'>"+Locale.i18n("preview_subscribe",true)+"</button></div>");a4.find("button#addpreviewfeed").click(function(){G(a6.feed)})}}else{if(a9){var a7=a9.url?'<div class="info-link"><a href="'+a9.url+'">'+a9.url+"</a></div>":"";a4.append("<br><div class='info'>"+(a9.code?"<div class='info-code'>"+a9.code+"</div>":"")+"<div class='info-message'>"+a9.message+"</div>"+a7+"</div>")}else{if(a5.length<1){a4.append("<div class='info'><div class='info-message'>"+Locale.i18n("showarticles_noentries",true)+"</div></div>");return false}}}r=-1}return true}function ao(bh,ba,a4){aa(false);if(!aP(bh,ba,a4)){return}if(!bh.index){bh.index=0}var a7=J();var bc=a7.getRuleEngine();var bd=a7.getSettings().getDateFormat();var a5=$("div#feed");if(bh.metaStart){bh.start=bh.metaStart}if(bh.metaIndex){bh.index=bh.metaIndex}var a8=bh.index;var bf="load-"+(parseInt(bh.start,10)+bh.count)+"-"+bh.count;var bb;var a6,be,a9=false;for(a6=0;a6<ba.length;a6++,a8++){be=ba[a6];aR(be,a6,a8,bh,bb,bc,bd);if(a6+2==ba.length&&ba.length==bh.count&&bh.action!="preview"){a5.append("<div class='lazyload' id='"+bf+"' data-skipuntil='"+ba[a6+1].id+"'></div>");a9=true}}if(bh.firstload==true){a5.scrollTop(0)}if(bh.action!="preview"&&a9){aU.once(bf,T(a8,bh,true))}a5.focus();a7.getSoundPlayer().playQueueUniques();aU.addEvents()}function F(a9,bc,bm){var bj,ba="",bs,a4,bb,bq,a5,a7;if(a9.metaStart){a9.start=a9.metaStart}if(a9.metaIndex){a9.index=a9.metaIndex}var bp="load-"+(parseInt(a9.start,10)+a9.count)+"-"+a9.count;var a8;var a6=J();var be=a6.getRuleEngine();var bl=a6.getSettings();var bi=bl.getDateFormat();var bd=bl.getUseFavIconsTitles();var bo;var bn;var bh=$("div#titles");var bk=$("div#feed");var br=false;aa(true);if(!aP(a9,bc,bm)){return}if(!a9.index){a9.index=0}a8=a9.index;for(bj=0;bj<bc.length;bj++){a4=bc[bj];if(a4.content==p){a6.markUnread(a4.id,0);continue}if(a4.title==undefined||a4.title.length<2){M.fixTitle(a4)}ba="";bb=M.getDateTag(a4.publishedDate.getTime());if(!a9.prevtag||bb.tag!=a9.prevtag.tag){bh.append("<div class='datedivider'>"+bb.tag+"</div>");a9.prevtag=bb}bq=a4.publishedDate.format(bb.format);ba+='<div class="item" data-key="'+a4.id+'">';ba+='<div class="item-title'+(v(a4.title)?" rtl-layout":"")+'" id="item-title-'+a4.id+'">'+aS(M.stripTags(a4.title))+"</div>";ba+='<div class="item-pin"></div>';ba+='<div class="item-author'+(v(a4.feed.title)?" rtl-layout":"")+'">'+(bd?aj(a4.link):"")+aS(M.stripTags(a4.feed.title))+"</div>";ba+='<div class="item-date">'+bq+"</div>";ba+="</div>";a5=$(ba);try{be.process(feedbro.RuleEngine.EVENT_ITEM_VIEWED,a4,a5,feedbro.RuleEngine.IGNORE_ACTIONS_VIEW)}catch(bf){n("ruleEngine.process failed: ",bf,be,a5)}if(a4.starred==1){a5.find("div.item-pin").addClass("pinned")}if(a4.unread==1){a5.addClass("unread")}if(a9.firstload==true&&a7==undefined&&a5.hasClass("item")){a5.addClass("activetitle");bn=a5;a7=true}a5.data("feeditem",jQuery.extend({},a4));bh.append(a5);if(S.getMathJaxEnabled()){try{if(m.shouldRender(a4.title)){m.render("item-title-"+a4.id)}}catch(bf){n("Could not render MathJax: ",bf)}}if(bj+2==bc.length&&bc.length==a9.count){bh.append("<div class='lazyload' id='"+bp+"' data-skipuntil='"+bc[bj+1].id+"'></div>");br=true}a5.click(D(bj,a8,a9));a5.bind("contextmenu",aN);a8++}if(br){aU.once(bp,T(a8,a9,false))}aU.addEvents();if(bn!=undefined&&S.getDisableAutoSelect()!=true){bn.click()}if(a9.firstload==true){bh.scrollTop(0)}}function aN(a6){var a5=$(this);var a4=a5.data("feeditem");chrome.tabs.create({url:a4.link,active:a6.ctrlKey},function(a7){});chrome.extension.getBackgroundPage().feedbrobg.markUnread(a4.id,0);a5.removeClass("unread");a6.preventDefault();a6.stopPropagation();return false}function aj(a4){return'<img src="'+ah.getIconFromGoogleCache(a4)+'" class="titlesfavicon">'}function w(){$("link#theme").attr("href","styles/theme-"+J().getSettings().getTheme()+".css")}function ad(){var a9=J().getSettings();var a4="font-size: "+a9.getArticleBodyFontSize()+"%";var a7="line-height: "+a9.getArticleLineHeight()+"; ";var a6="";a6+="div.entry-body > blockquote { "+a7+a4+"; } div.entry-npsummary { "+a7+a4+" !important; } ";a6+="div#titles div.item, div#feed div.entry { font-family: "+a9.getArticleFontFamily()+" !important; } ";if(a9.getJustifyText()==true){a6+="div#feed > div.entry > div.entry-body > blockquote { text-align: justify; } "}if(a9.getTruncateTitles()==false){a6+=".entry-title-wrapper { white-space: normal !important; overflow: visible !important; } "}var a5,a8;for(a5=1;a5<=6;a5++){a8=a9.getArticleWidth(a5);if(a8!=-1&&a8!="-1"){switch(a5){case 1:case 2:a6+='div#feed[data-viewmode="'+a5+'"] > div.entry { max-width: '+a8+"px; margin-left: auto; margin-right: auto; }";break;case 3:a6+='div#feed[data-viewmode="'+a5+'"] > div.entry { max-width: '+a8+"px; margin-left: auto; margin-right: auto; }";break;case 4:a6+='div#feed[data-viewmode="'+a5+'"] > div.entry.active { width: '+a8+"px; margin-left: auto; margin-right: auto; }";break;case 5:a6+='div#feed[data-viewmode="'+a5+'"] > div.entry.linemode { width: '+a8+"px; }";break;case 6:a6+='div#feed[data-viewmode="'+a5+'"] > div.entry { max-width: '+a8+"px; margin-left: auto; margin-right: auto; }";break;default:break}}}a8=a9.getTitleFontSize();if(a8!=100){a6+=".entry-link, .entry-nptitle-a { font-size: "+a8+"%; }"}a8=a9.getCardHeight();if(a8!=-1){a6+='div#feed[data-viewmode="4"] > div.entry > .entry-newspaper-section { height: '+a8+"px; }"}$("style#settings").html(a6)}function D(a6,a4,a5){return function(){var a8=$(this);var ba=a8.data("feeditem");var bb=$("div#feed");var a9=J();var bd=S.getMarkReadMode();var a7=S.getDateFormat();var bc=a9.getRuleEngine();bb.empty();aR(ba,a6,a4,a5,undefined,bc,a7);$("div.item").removeClass("activetitle");a8.addClass("activetitle");if(bd!=3){a9.markUnread(ba.id,0);a8.removeClass("unread")}$("div#feed > div.entry").removeClass("active");bb.scrollTop(0);a9.getSoundPlayer().playQueueUniques();V()}}function T(a4,a5,a6){return function(ba){var a7=ba.getAttribute("id");var a9=parseInt(ba.getAttribute("data-skipuntil"),10);var a8=a7.substring(5).split("-");if(a5.unread==1){a5.start=0;a5.skipUntil=a9;a5.metaStart=parseInt(a8[0],10);a5.metaIndex=a4}else{a5.start=parseInt(a8[0],10);a5.index=a4}a5.count=parseInt(a8[1],10);a5.firstload=false;Y(a5)}}this.engineInit=function(){if(chrome.extension.getBackgroundPage()==null){$("body").css({"background-color":"#25003E"});$("body").html("<div style='font-size: 2em; color: #fff; font-family: \"Open Sans\", sans-serif; position: absolute; width: 700px; height: 150px; top: 50%; left: 50%; margin-left: -350px; margin-top: -75px;'>Feedbro is not available in Private Browsing Mode</div>");return}var a8=J();var a5=a8.getSettings();ah.setSettings(a5);w();ad();Locale.start();Locale.activeMap=a8.getActiveLocaleMap();Locale.translate(true);alertify.set({labels:{cancel:Locale.i18n("dialog_cancel",false),ok:Locale.i18n("dialog_ok",false)}});var a4=$("div#navigator");a4.tree({data:U(),autoEscape:false,slide:false,dragAndDrop:true,selectable:true,onCanMoveTo:function(bb,bc,ba){if(bc.type==1&&ba=="inside"){return false}else{if(bb.type==2&&bc.parent!=null&&(bc.parent.type==2||ba=="inside")){return false}else{return true}}}});$("#markread").click(s);$("#addfeed").click(l);$("#addfolder").click(b);$("div#togglepanel").click(function(){var ba=$("div#leftpane").css("display");ba=(ba=="flex")?"none":"flex";$("div#leftpane").css("display",ba)});$("div#openfbhelp").click(y);$("div#reloadall").click(function(){alertify.success(Locale.i18n("navigator_action_reload",false));J().scanUnread(true)});$("div#starreditems").click(function(){u();var ba={node:{name:"starred"},action:"loadstarred"};$("div#starreditems").addClass("menu-selected");R(ba,true)});$("div#allitems").click(function(){u();var ba={node:{name:"allitems"},action:"loadall"};$("div#allitems").addClass("menu-selected");R(ba,true)});$("button#prevItem").click(function(){C({keyCode:75})});$("button#nextItem").click(function(){C({keyCode:74})});$("a.link-import").click(function(){af("Feedbro - Options","options.html");return false});$("a.link-addfeed").click(function(){l();return false});$("a.link-addfolder").click(function(){b();return false});$("a.link-settings").click(function(){af("Feedbro - Options","options.html");return false});$("a.link-readall").click(function(){$("div#allitems").click();return false});$("a.link-help").click(function(){y();return false});$("div#stats").click(function(){u();$("div#stats").addClass("menu-selected");aa(false);var ba={node:{name:"feedstats"},action:"feedstats"};R(ba,true)});d=new feedbro.RuleEngineUI();d.setContainerName("div#feed");d.init();$("div#rulenav").click(function(){u();$("div#rulenav").addClass("menu-selected");aa(false);var ba={node:{name:"rulelist"},action:"rulelist"};R(ba,true)});$("div#tagnav").click(function(){u();$("div#tagnav").addClass("menu-selected");aa(false);var ba={node:{name:"tagcloud"},action:"tagcloud"};R(ba,true)});$(document).keydown(C);a4.bind("tree.move",function(bc){bc.preventDefault();var be=bc.move_info.target_node;var bb=bc.move_info.moved_node;var ba=bc.move_info.position;var bd=bb.parent;if(be.type==1&&ba=="inside"){alertify.alert(Locale.i18n("navigator_tree_error_underfeed",false));return}if(bb.type==2&&be.parent!=null&&(be.parent.type==2||ba=="inside")){alertify.alert(Locale.i18n("navigator_tree_error_underfolder",false));return}bc.move_info.do_move();J().moveNode(bb.id,be.id,ba);f();o(bb.id);if(bd&&bd.id){o(bd.id)}});a4.bind("tree.open",function(ba){if(ba.node.id){J().getFeedTree().getNode(ba.node.id).data.is_open=true}});a4.bind("tree.close",function(ba){if(ba.node.id){J().getFeedTree().getNode(ba.node.id).data.is_open=false}});a4.bind("tree.contextmenu",function(bd){var bc=bd.node;var ba=bd.click_event.pageX;var bf=bd.click_event.pageY;var bb='<div id="contextmenu" style="z-index: 11000; padding: 0px; border: 1px outset white; background-color: #ededed; position: absolute; width: 200px; top: '+bf+"px; left: "+ba+'px;">';bb+='<div id="ctx-markread" class="contextitem">'+Locale.i18n("navigator_ctxmenu_markread",true)+"</div>";bb+='<div id="ctx-rename" class="contextitem">'+Locale.i18n("navigator_ctxmenu_rename",true)+"</div>";if(bc.type==2){bb+='<div id="ctx-sortfolderfeeds" class="contextitem">'+Locale.i18n("navigator_ctxmenu_sortfeeds",true)+"</div>"}bb+='<div id="ctx-delete" class="contextitem">'+Locale.i18n("navigator_ctxmenu_delete",true)+"</div>";if(bc.type==1){bb+='<div id="ctx-load" class="contextitem">'+Locale.i18n("navigator_ctxmenu_updatefeed",true)+"</div>";bb+='<div id="ctx-properties" class="contextitem">'+Locale.i18n("navigator_ctxmenu_properties",true)+"</div>"}else{if(bc.type==2){bb+='<div id="ctx-loadfolderfeeds" class="contextitem">'+Locale.i18n("navigator_ctxmenu_updatefolder",true)+"</div>"}}bb+="</div>";$("div#contextmenu").remove();var be=$(bb);$("body").append(be);if((bf+be.height())>$(window).height()){be.css({top:bf-be.height()})}be.bind("contextmenu",function(bg){return false});be.find("div#ctx-delete").click(function(){n("Delete "+bc.id);a3(bc.id)});be.find("div#ctx-rename").click(function(){n("Rename "+bc.id);aV(bc.id)});be.find("div#ctx-markread").click(function(){n("Mark read "+bc.id);ar(bc)});if(bc.type==1){be.find("div#ctx-load").click(function(){alertify.success(Locale.i18n("navigator_ctxmenu_updatefeed_success",false));J().loadFeedItems(bc.id)});be.find("div#ctx-properties").click(function(){var bg=J().getFeedTree().getNode(bc.id).data;G(bg,bc.parent)})}else{if(bc.type==2){be.find("div#ctx-loadfolderfeeds").click(function(){alertify.success(Locale.i18n("navigator_ctxmenu_updatefolder_success",false));J().loadFolderFeeds(bc.id)});be.find("div#ctx-sortfolderfeeds").click(function(){J().sortFolder(bc.id)})}}});$("select#itemage").val(a5.getMaxItemAge());$("select#itemage").change(function(){J().getSettings().setMaxItemAge($(this).val());J().saveSettings()});$("select#itemsortorder").val(a5.getItemSortOrder());$("select#itemsortorder").change(function(){J().getSettings().setItemSortOrder($(this).val());J().saveSettings()});aA(a5.getOnlyUnread());$("div#unreadtoggle").click(function(){an()});au(a5.getViewMode(),true);var a6=$("div#feeddialog");a6.keydown(function(ba){ba.stopPropagation()});a6.find("button#feed-cancel").click(function(){$("div#feeddialog").css({display:"none"})});a6.find("button#feed-save").click(aQ);a6.find("button#feed-preview").click(function(){var bb=a6.find("input#feed-url").val();var bc=parseInt(a6.find("select#entrycontent").val(),10);var bd=a6.find("input#feed-username").val();var ba=a6.find("input#feed-password").val();if(bb!=undefined&&bb.length>0){a6.css({cursor:"wait"});aG.previewFeed(bb,bc,function(){a6.css({cursor:"default"})},bd,ba)}});a6.find("button#feed-get").click(function(){var bb=a6.find("input#feed-url").val();if(!bb||bb==""){alertify.alert(Locale.i18n("addfeed_load_error_nourl",false));return}a6.css({cursor:"wait"});var bc=a6.find("input#feed-username").val();var ba=a6.find("input#feed-password").val();J().findFeeds(bb,bc,ba,function(bd){a6.css({cursor:"default"});if(bd.length==0){alertify.alert(Locale.i18n("addfeed_load_error_invalidurl",false,bb))}if(bd.length==1){a6.css({cursor:"wait"});J().previewFeed(bd[0].href,1,bc,ba,function(bi){a6.css({cursor:"default"});var bj=bi.feed.title||"";a6.find("input#feed-url").val(bd[0].href);a6.find("span#feed-status").html(aq(bi.status));a6.find("input#feed-title").val(bj);a6.find("span#feed-lastposted").html(bi.feed.latestitemdate?M.timeAgo(bi.feed.latestitemdate.getTime()):"-");if(bi.error){alertify.alert(Locale.i18n("addfeed_load_error_loadfailed",false,bd[0].href,bi.error.code,bi.error.message))}})}if(bd.length>1){var bg,bf="";var be=a6.find("span#feed-alternatives");var bh=a6.find("input#feed-url");be.css({display:"block",width:bh.outerWidth()});for(bg=0;bg<bd.length;bg++){bf+="<div class='feed-alternative' id='select-feed-"+bg+"' href='"+feedbro.Strings.escapeHref(bd[bg].href)+"' title='"+Locale.i18n("addfeed_alternatives_clicktip",true)+"'><a href='#'>["+feedbro.Strings.escapeHtml(bd[bg].type)+"] "+feedbro.Strings.escapeHtml(bd[bg].title)+"</a></div>"}be.html(bf);for(bg=0;bg<bd.length;bg++){be.find("div#select-feed-"+bg).click(aX(a6,be))}}})});$("div#feedbro-sharebox > div.opt").click(function(){var bg=$(this).attr("class");var bc=bg.substring(4);var bb=q[bc];var bh=$("div#feedbro-sharebox");bb=bb.replace("{URL}",encodeURIComponent(bh.attr("data-url")));bb=bb.replace("{TITLE}",encodeURIComponent(bh.attr("data-title")));var bd=870;var bj=700;var be=(screen.width/2)-(bd/2);var bi=(screen.height/2)-(bj/2);var bf;if(bc=="email"){$('<iframe src="'+bb+'" style="display: none" id="mailTrigger">').appendTo("body");setTimeout(function(){$("iframe#mailTrigger").remove()},4000)}else{if(bc=="gtranslate"){var ba=J().getSettings().getTargetLanguage();bb=bb.replace("{TOLANG}",ba?ba:"en");bf=window.open(bb,"_blank")}else{bf=window.open(bb,bc,"toolbar=no,scrollbars=0,width="+bd+",height="+bj+",top="+bi+",left="+be)}}bh.css({display:"none"});return false});$(document).click(function(ba){$("div#contextmenu").remove();if($(ba.target).prop("class")!="share"){$("div#feedbro-sharebox").css({display:"none"})}});a4.bind("tree.click",R);$("div#normalview").click(function(){au(0)});$("div#headlineview").click(function(){au(1)});$("div#3cola").click(function(){au(2)});$("div#newsview").click(function(){au(3)});$("div#newslinemode").click(function(){au(4)});$("div#3colaiframe").click(function(){au(5)});$("div#reload").click(function(){aL()});$("div#prevItem").click(function(){C({keyCode:75})});$("div#nextItem").click(function(){C({keyCode:74})});$("div#gotosettings").click(function(){document.location.href="/options.html"});$("div#dragbar1").mousedown(function(ba){I(ba,"div#leftpane","div#titles")});$("div#dragbar2").mousedown(function(ba){I(ba,"div#titles","div#feed")});$("div#leftpane").css("width",a5.getNavigatorWidth());$("div#titles").css("width",a5.getTitlesWidth());if(a8.isInitialized()==false){alertify.error(Locale.i18n("startup_error_background",false));return}if(a8.getFeedEntryManagerErrorStatus()!=0){alertify.alert(Locale.i18n("startup_error_indexeddb",false));return}chrome.runtime.onMessage.addListener(t);window.addEventListener("beforeunload",e);aY.init();L.configure({remove:aC,add:az,search:ab,autocomplete:K});n("Engine init done.");aJ();var a7=new feedbro.Strings();var a9=a7.getQueryParams(document.location.search);if(a9&&a9.article!=undefined){Q();Y({articleid:parseInt(a9.article,10),single:true,action:"loadsingle",firstload:true})}else{if(a9&&a9.preview!=undefined){Q();$("div#feed").html("<div class='previewheader'>"+Locale.i18n("preview_loading",true)+"</div>");aG.previewFeed(a9.preview)}else{if(a5.getStartPageAllItems()==true){$("div#allitems").click()}}}};function e(){window.feedbro=undefined;window.feedbroengine=undefined;window.MathJax=undefined;window.removeEventListener("beforeunload",e);S=undefined;aY=undefined;i=undefined;d=undefined;aU.clear();aU=undefined;L.destroy();L=undefined;J().saveData()}function aJ(){try{if(navigator.userAgent.indexOf("Firefox")!=-1){$("a#feedbro-feedback").attr("href","https://addons.mozilla.org/firefox/addon/feedbroreader/")}}catch(a4){n("Failed to update feedback link")}}function Q(){try{history.pushState({},"Feedbro","reader.html")}catch(a4){}}function A(){return $("div#toolbar").outerHeight()}function I(a9,a6,a7){a9.preventDefault();var ba=$(a9.target),a5=$(a7),a8=$(a6);var a4=$("<div>",{id:"ghostbar",css:{height:ba.height(),top:ba.offset().top,left:a9.pageX}}).appendTo("body");$(document).mousemove(function(bb){a4.css("left",bb.pageX)});$(document).mouseup(function(bb){a8.css("width",bb.pageX-a8.offset().left);$(document).unbind("mousemove");$(document).unbind("mouseup");a4.remove();a0()})}function a0(){var a5=parseInt($("div#leftpane").width(),10);var a6=parseInt($("div#titles").width(),10);var a4=J().getSettings();a4.setNavigatorWidth(a5);a4.setTitlesWidth(a6);J().saveSettings()}function ay(bb,a9){var a7,a8="";var ba,a5;try{var a4=M.findImages(bb.content,6);a8+=" <div class='entry-newspaper-section'>";if(a4.length>0){a5=" <div class='entry-npmainimage"+(a9?" linemode":"")+"'><img class='entry-npmainimage-img' src='"+a4[0].s+"'></div>"}else{a5=" <div class='entry-npmainimage"+(a9?" linemode":"")+"'></div>"}a8+=" <div class='entry-nptitle"+(M.isTextRTL(bb.title,true,100)?" rtl-layout":"")+"'><a class='entry-nptitle-a' data-id='"+bb.id+"' rel='noopener' title='"+Locale.i18n("article_header_clicktip",true)+"' href='"+bb.link+"'>"+aS(M.stripTags(bb.title))+"</a></div>";a8+=" <div class='entry-sourceline'><div class='entry-source'><a class='entry-source-link' href='"+bb.feed.link+"'>"+aS(M.stripTags(bb.feed.title))+"</a></div> <div class='timeago'>"+M.timeAgo(bb.publishedDate)+"</div></div>";a7=M.htmlText(bb.content,a9?350:180,"...");ba=" <div title='"+Locale.i18n("article_header_clickopen",true)+"' class='entry-npsummary"+(M.isTextRTL(a7,true)?" rtl-layout":"")+(a9?" linemode":"")+"'>"+a7+"</div>";if(a9){a8+=a5+ba}else{a8+=ba+a5}a8+=" </div>"}catch(a6){n("could not create news html",a6)}return a8}function aK(a4){return"<a class='share' data-url='"+at(a4.link)+"' data-title='"+at(a4.title)+"' title='"+Locale.i18n("article_links_sendto_title",true)+"'>"+Locale.i18n("article_links_sendto_body",true)+" &gt;</a>"}function aR(bo,bl,a8,bc,bp,bf,bj){var bk,br,bm,bd,bn,a9,a6,bg,bi,a4,ba,a7;var bs="";var bq="";if(a8==undefined){a8=0}if(bo.content==p){J().markUnread(bo.id,0);return}if(bo.title==undefined||bo.title.length<2){M.fixTitle(bo)}r=bo.id;if(!bo.feed){bo.feed={}}bk="entry";if(c==feedbro.Engine.VIEWMODE_HEADLINES){bk=bk+" clickopen compact-headline";bs=Locale.i18n("article_header_clickopen",true)}if(c==feedbro.Engine.VIEWMODE_NEWS){bk+=" entry-newspaper";bq=ay(bo,false)}if(c==feedbro.Engine.VIEWMODE_NEWSLINEMODE){bk+=" entry-newspaper linemode";bq=ay(bo,true)}if(c==feedbro.Engine.VIEWMODE_OPERA_IFRAME){bk+=" iframe-content"}br="star";bm="style='display: "+(c==feedbro.Engine.VIEWMODE_HEADLINES?"none":"block")+"'";a7="<div class='readtrigger' id='trigger-"+bo.id+"'></div>";var be=S.getMarkReadMode();var a5="";if(bc.action!="preview"){a5="<div class='itemlinks noPrint' id='item-"+bo.id+"'><span id='star-"+bo.id+"' class='"+br+"' title='"+Locale.i18n("article_links_addstar",true)+"'>&nbsp;</span> "+aK(bo)+ai(bo,be==3)+aB(bo)+ak(bo)+"</div>"}bd=$("<div id='blogentrypost-"+bo.id+"' data-id='"+bo.id+"' class='"+bk+"' title='"+bs+"'>"+ax(bo,a8+1,bj,bc)+(be==1?a7:"")+bq+"<div class='entry-body' "+bm+"><blockquote class='entry-blockquote' id='content-"+bo.id+"'></blockquote>"+(be==2?a7:"")+a5+"</div></div>");try{bf.process(feedbro.RuleEngine.EVENT_ITEM_VIEWED,bo,bd,feedbro.RuleEngine.IGNORE_ACTIONS_VIEW)}catch(bh){n("ruleEngine.process failed: "+bh)}try{j(bo)}catch(bh){n("convertSrcAttributess failed: "+bh)}a4=bd.find("blockquote#content-"+bo.id);if(c==feedbro.Engine.VIEWMODE_OPERA_IFRAME){a4.addClass("iframe-content");a4.append("<iframe src='"+bo.link+"' class='feedbroviewmode6iframe' sandbox='allow-scripts allow-forms' referrerpolicy='no-referrer'></iframe>")}else{a4.append(bo.content)}bd.find("img").on("error",function(bt){bt.target.style.display="none"});bd.find("div.entry-title a.entry-link").click(ac);bd.find("div.entry-nptitle > a").click(ac);if(M.isTextRTL(bo.content,true,100)){a4.addClass("rtl-layout")}if(bo.starred==1){bd.find("span#topstar-"+bo.id).addClass("starred");bd.find("span#star-"+bo.id).addClass("starred")}if(bo.unread==1){bd.addClass("unread")}if(bc.firstload==true&&bc.activelink==undefined&&bd.hasClass("entry")){bd.addClass("active");bc.activelink=true}try{L.createSelector(bd.find("div.tags"),bo.tags)}catch(bb){n("Error: cannot initialize tag selector for entry "+bo.id)}bd.click(E);if(c==feedbro.Engine.VIEWMODE_NEWS||c==feedbro.Engine.VIEWMODE_NEWSLINEMODE){bd.find("div.entry-newspaper-section").click(am)}try{bg=bo.enclosures;if(bg!=undefined&&Array.isArray(bg)&&bg.length>0){for(bi=0;bi<bg.length;bi++){ba=bg[bi];if(ba==undefined){continue}if(ba.url!=undefined){ba.url=aS(ba.url)}if(ba.type!=undefined){ba.type=aS(ba.type)}if(ba.length!=undefined){ba.length=aS(ba.length)}a4.append(i.createTag(bo.id+"-"+bi,ba))}}}catch(bh){n("Error: could not initialize enclosure for entry: "+bo.id)}$("div#feed").append(bd);if(S.getMathJaxEnabled()){try{if(m.shouldRender(bo.title)||m.shouldRender(bo.content)){m.render("blogentrypost-"+bo.id)}}catch(bh){n("Could not render MathJax: "+bh)}}if(bc.action!="preview"&&bo.unread==1&&be!=3){aU.once("trigger-"+bo.id,g)}}function am(a6){var a7=$(this);var a5=a7.parent();if($(a6.target).is("a")){return}aD(a5.find("div.entry-body > blockquote:first"));a5.removeClass("entry-newspaper");a7.css("display","none");$("div.active").removeClass("active");a5.addClass("active");var a4=$("div#feed");a4.scrollTop(a4.scrollTop()+parseInt(a5.offset().top,10)-parseInt($("div#toolbar").outerHeight(),10)-1)}function av(ba){var a8=$("div#blogentrypost-"+ba);try{var a5=a8.find("span.readtoggle-entry-upper > img");var a9=a5.attr("src")=="images/icon-read.png";var a7=a8.find("div.itemlinks > span.keepunread > input.unreadbox");var bb=parseInt(a7.attr("id").substring(7),10);J().markUnread(bb,a9?1:0);var a4=$("div#titles > div.activetitle");if(a4.length>0){if(a9){a4.addClass("unread")}else{a4.removeClass("unread")}}if(a9){a8.addClass("unread");a5.attr("src","images/icon-unread.png");a7.prop("checked",true)}else{a8.removeClass("unread");a5.attr("src","images/icon-read.png");a7.prop("checked",false)}}catch(a6){n(a6)}}function j(a4){if(c==feedbro.Engine.VIEWMODE_NEWS||c==feedbro.Engine.VIEWMODE_NEWSLINEMODE||c==feedbro.Engine.VIEWMODE_HEADLINES){if(a4.content){a4.content=a4.content.replace(M.getRegexp("<(img|iframe|audio|video|embed)([^>]*)src=([^>]*)","gi"),function(a8,a7,a6,a5){var a9="<"+a7+a6+"data-lazysingle="+a5;a9=a9.replace(/srcset=/g,"data-lazymulti=");return a9})}}}function aD(a4){a4.find("[data-lazysingle],[data-lazymulti]").each(function(a6,a7){var a5;a5=a7.getAttribute("data-lazymulti");if(a5!=undefined&&a5!=""){a7.setAttribute("srcset",a5)}a5=a7.getAttribute("data-lazysingle");if(a5!=undefined&&a5!=""){a7.setAttribute("src",a5)}})}function ax(a8,a5,a4,a7){var a6="";a6+='<div class="entry-title'+(v(a8.title)?" rtl-layout":"")+'">';if(a7.action!="preview"){a6+='<table border="0" width="100%" class="entry-table"><tr><td class="entry-title-td">';if(c==feedbro.Engine.VIEWMODE_HEADLINES){a6+='<div class="entry-title-wrapper">'}else{a6+='<div class="entry-title-wrapper-dummy">'}a6+='<a data-id="'+a8.id+'" class="entry-link" href="'+a8.link+'" target="_blank" rel="noopener" title="'+Locale.i18n("article_header_clicktip",true)+'">'+aS(M.stripTags(a8.title))+"</a> ";if(a8.points!=undefined&&a8.points!=0){a6+='<span class="feedbro-points" title="'+Locale.i18n("article_header_pointstip",true)+'">('+a8.points+")</span>"}a6+="</div>";a6+='</td><td class="entry-title-topcorner">';a6+='<span id="topstar-'+a8.id+'" class="star" title="'+Locale.i18n("article_links_addstar",true)+'">&nbsp;</span>';a6+='<span class="readtoggle-entry-upper noPrint" title="'+Locale.i18n("article_header_markread_title",true)+'"><img data-id="'+a8.id+'" src="images/icon-'+(a8.unread?"unread":"read")+'.png" class="articlemarkreadicon"></span>';a6+='<span class="delete-entry-upper noPrint" title="'+Locale.i18n("article_action_delete_title",true)+'"><img data-id="'+a8.id+'" src="images/trash.png" class="articletrashicon"></span>';a6+="</td></tr></table>"}else{a6+='<a data-id="'+a8.id+'" class="entry-link" href="'+a8.link+'" target="_blank" rel="noopener" title="'+Locale.i18n("article_header_clicktip",true)+'">'+aS(M.stripTags(a8.title))+"</a> "}a6+='</div><div class="entry-header">';a6+='<div class="fromline">';if(S.getFaviconOnFromline()){a6+='<img title="'+Locale.i18n("article_fromline_clicktoload",true)+'" data-feedid="'+a8.feedid+'" class="fromlinefavicon" src="'+ah.getIconFromGoogleCache(a8.link)+'">'}a6+=Locale.i18n("article_fromline_from",true)+' <div class="entry-bloglink makeinline'+(v(a8.feed.title)?" rtl-layout":"")+'"><a class="entry-bloglink-a" target="_blank" href="'+a8.feed.link+'">';a6+=aS(M.stripTags(a8.feed.title))+"</a></div>";if(a8.author!=undefined&&a8.author!=""){a6+=" "+Locale.i18n("article_fromline_by",true)+' <div class="entry-author makeinline'+(v(a8.author)?" rtl-layout":"")+'">'+aS(M.stripTags(a8.author))+"</div>"}a6+='</div><div class="entry-date">'+aF(a8.publishedDate,a4)+'</div><div class="entry-number"> # '+a5+".</div></div>";return a6}function aF(a5,a4){if(a5!=undefined&&a4!=undefined){return a5.format(a4)+" ("+M.timeAgo(a5)+") "}else{return""}}function v(a4){return M.isTextRTL(a4,true,100)}function au(a6,a4){var a5=c;c=a6;$("div.mode").removeClass("active-mode");$("div#feed").attr("data-viewmode",(c+1));if(a6==0){$("div#normalview").addClass("active-mode");aa(false);aW()}else{if(a6==1){$("div#headlineview").addClass("active-mode");aa(false);aW()}else{if(a6==2){$("div#3cola").addClass("active-mode");aa(true)}else{if(a6==3){aa(false);$("div#newsview").addClass("active-mode")}else{if(a6==4){aa(false);$("div#newslinemode").addClass("active-mode")}else{if(a6==5){$("div#3colaiframe").addClass("active-mode");aa(true)}}}}}}if((a5==feedbro.Engine.VIEWMODE_OPERA||a5==feedbro.Engine.VIEWMODE_OPERA_IFRAME||a5==feedbro.Engine.VIEWMODE_NEWS)&&(a6==feedbro.Engine.VIEWMODE_HEADLINES||a6==feedbro.Engine.VIEWMODE_FULL)){aL()}else{if((a6==feedbro.Engine.VIEWMODE_OPERA||a6==feedbro.Engine.VIEWMODE_OPERA_IFRAME)&&(a5==feedbro.Engine.VIEWMODE_HEADLINES||a5==feedbro.Engine.VIEWMODE_FULL||a5==feedbro.Engine.VIEWMODE_NEWS||a5==feedbro.Engine.VIEWMODE_NEWSLINEMODE)){aL()}else{if(a6==feedbro.Engine.VIEWMODE_NEWS&&a5!=feedbro.Engine.VIEWMODE_NEWS){aL()}else{if(a6==feedbro.Engine.VIEWMODE_NEWSLINEMODE&&a5!=feedbro.Engine.VIEWMODE_NEWSLINEMODE){aL()}else{if((a6==0||a6==1)&&(a5!=0&&a5!=1)){aL()}else{if(a6==feedbro.Engine.VIEWMODE_FULL&&a5==feedbro.Engine.VIEWMODE_HEADLINES){$("blockquote.entry-blockquote").each(function(a7,a8){aD($(a8))})}}}}}}if(a4!=true){J().getSettings().setViewMode(c);J().saveSettings()}}function an(){var a4=!$("input#onlyunread").prop("checked");aA(a4);J().getSettings().setOnlyUnread(a4);J().saveSettings()}function aA(a4){if(a4==true){$("div#unreadtoggle").addClass("active-mode");$("input#onlyunread").prop("checked",true)}else{$("div#unreadtoggle").removeClass("active-mode");$("input#onlyunread").prop("checked",false)}}function Z(a6){var a4=$("div#feed > div.entry.active > div.entry-body > div.itemlinks > div.tags");if(a4.length==0){a4=$("div#feed > div.entry > div.entry-body > div.itemlinks > div.tags")}if(a4.length==0){return}var a5=a4.find(".tagicon");a5.click();a4.find("input").val(a6+"");a4.find(".tagadd").click()}function aT(){var a4=$("div#feed > div.entry.active > div.entry-body > div.itemlinks > div.tags");if(a4.length==0){a4=$("div#feed > div.entry > div.entry-body > div.itemlinks > div.tags")}if(a4.length==0){return}if(!a4.is(":visible")){return}a4.find(".tagicon").click()}};feedbro.Engine.VIEWMODE_FULL=0;feedbro.Engine.VIEWMODE_HEADLINES=1;feedbro.Engine.VIEWMODE_OPERA=2;feedbro.Engine.VIEWMODE_NEWS=3;feedbro.Engine.VIEWMODE_NEWSLINEMODE=4;feedbro.Engine.VIEWMODE_OPERA_IFRAME=5;var feedbro=feedbro||{};feedbro.FaPlugin=function(){};feedbro.FaPlugin.prototype.canParse=function(a){return a&&a.indexOf("facebook.com/")!=-1};feedbro.FaPlugin.prototype.parse=function(f,d,a,g){var b=this;var e=new XMLHttpRequest();var c=f.url;if(c.indexOf("sorting_setting")==-1){if(c.indexOf("?")==-1){c=c+"?sorting_setting=CHRONOLOGICAL"}else{c=c+"&sorting_setting=CHRONOLOGICAL"}}e.onerror=function(){a.error={};a.error.message="Network error";a.error.code=398;a.status=398};e.onreadystatechange=function(i){var h=i.target;if(h.readyState==4){h.onreadystatechange=null;if(h.status!=0){h.onerror=null}if((h.responseURL||"").indexOf("https://www.facebook.com/login/")==0){a.error={message:"Authorization required",code:401};a.status=401;d(f.url,h,"",a,g,true)}else{if(h.status==200){try{b.loadPage(h.responseURL,h.responseText,7,f.datelimit,function(n,l){var m,k=[];for(m=0;m<l.length;m++){if(l[m].node!=null){k.push(l[m].node)}}d(f.url,h,feedbro.Strings.toRSS(n+" | Facebook",f.url,k),a,g,true)})}catch(j){a.error={message:"Invalid XML",code:601};a.status=601;d(f.url,h,"",a,g,true)}}else{d(f.url,h,"",a,g,true)}}}};e.withCredentials=true;e.open("GET",c,true);e.setRequestHeader("Accept","text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9");e.setRequestHeader("Accept-Language","en-US,en;q=0.5");e.timeout=15000;e.send()};feedbro.FaPlugin.prototype.loadPage=function(a,h,k,q,n){var o=this;var c;var j=[];var p=new feedbro.Strings();var e="6070506089647539";var l;c={stag:["<title>"],etag:"</title>"};p.findNext(h,c);l=c.match;var i=l.match(/^\(\d+\) (.*)/);if(i&&i.length>1){l=i[1]}c={stag:['"pageID":"'],etag:'"'};p.findNext(h,c);if(c.match==null){e="6015372605194228";c={stag:['"fb://'],etag:'"'};p.findNext(h,c);if(c.match!=null){i=c.match.match(/(\d+)/);if(i!=null){c.match=i[1]}}}if(a.indexOf("facebook.com/groups/")!=-1){e="5734281603315284"}var d=c.match;o.parseHtmlStories(h,j);var g=o.getJsonObject(h,'"server_revision"');var b=o.getJsonObject(h,'"login_data"');if(b==null||b.login_data==null||b.login_data.jazoest==null||b.login_data.lsd==null){b={login_data:{jazoest:{},lsd:{}}};c={stag:['["LSD",[],{"token":"'],etag:'"'};p.findNext(h,c);b.login_data.lsd={value:c.match+""};c={stag:["&jazoest="],etag:'"'};p.findNext(h,c);b.login_data.jazoest={value:c.match+""}}var f={login_data:b.login_data,server_data:g,title:l,datelimit:q};var m=o.getLastCursor(j);if(o.shouldContinue(j,q)&&d!=null){o.getNextPage(a,e,d,m,j,k,f,n)}else{n(l,j)}};feedbro.FaPlugin.prototype.parseHtmlStories=function(f,b){var a,c,e=f.search(/"(timeline_feed_units|timeline_list_feed_units|group_feed)":/);a=1;for(c=e;c<f.length;c++){if(f.charAt(c)=="{"){a++}if(f.charAt(c)=="}"){a--}if(a==0){break}}var d=JSON.parse("{"+f.substring(e,c)+"}");d=d.timeline_feed_units||d.timeline_list_feed_units||d.group_feed;for(e=0;e<d.edges.length;e++){if(d.edges[e].node.__isFeedUnit=="Story"){b.push(d.edges[e])}}};feedbro.FaPlugin.prototype.shouldContinue=function(a,c){var d,f,b=new Date().getTime();for(d=0;d<a.length;d++){if(a[d].processed!=true){a[d].node=this.parseJsonStory(a[d].node);a[d].processed=true}f=a[d].node.publishedDate.getTime();if(f<b){b=f}}var e=true;if(c!=undefined&&c>=b){e=false}return e};feedbro.FaPlugin.prototype.getNextPage=function(a,c,b,h,e,f,d,g){var i=this;i.getPublicPage(a,c,b,h,d,function(q,l){if(l==null){g(q,e);return}var r,k,n,j,o,m=e.length;try{r=JSON.parse(l);for(k=0;k<r.length;k++){n=r[k];if(n.data&&n.data.node&&n.data.node.timeline_list_feed_units){i.addEntries(n.data.node.timeline_list_feed_units,e)}else{if(n.data&&n.data.node&&n.data.node.group_feed){i.addEntries(n.data.node.group_feed,e)}else{if(n.data&&n.data.node&&n.data.node.timeline_feed_units){i.addEntries(n.data.node.timeline_feed_units,e);if(n.data.node.timeline_feed_units.page_info.has_next_page){j=n.data.node.timeline_feed_units.page_info.end_cursor}}else{if(n.label=="ProfileCometTimelineFeed_user$stream$ProfileCometTimelineFeed_user_timeline_list_feed_units"||n.label=="GroupsCometFeedRegularStories_paginationGroup$stream$GroupsCometFeedRegularStories_group_group_feed"){if(n.data&&n.data.node&&n.data.node.__typename=="Story"){e.push(n.data)}}else{if(n.label=="ProfileCometTimelineFeed_user$defer$ProfileCometTimelineFeed_user_timeline_list_feed_units$page_info"||n.label=="GroupsCometFeedRegularStories_paginationGroup$defer$GroupsCometFeedRegularStories_group_group_feed$page_info"){if(n.data&&n.data.page_info&&n.data.page_info.has_next_page){j=n.data.page_info.end_cursor}}}}}}}o=i.shouldContinue(e,d.datelimit)}catch(p){r={errors:1}}if(!o||r.errors||e.length>=f||j==h||j==null||e.length==m){g(q,e)}else{i.getNextPage(a,c,b,j,e,f,d,g)}})};feedbro.FaPlugin.prototype.getLastCursor=function(a){if(a.length>0){return a[a.length-1].cursor}else{return null}};feedbro.FaPlugin.prototype.addEntries=function(c,a){var b;for(b=0;b<c.edges.length;b++){if(c.edges[b].node.__typename=="Story"){a.push(c.edges[b])}}};feedbro.FaPlugin.prototype.getPublicPage=function(b,d,h,e,c,g){var f;if(d=="5734281603315284"){f={UFI2CommentsProvider_commentsKey:"CometGroupDiscussionRootSuccessQuery",count:3,displayCommentsContextEnableComment:null,displayCommentsContextIsAdPreview:null,displayCommentsContextIsAggregatedShare:null,displayCommentsContextIsStorySet:null,displayCommentsFeedbackContext:null,feedLocation:"GROUP",feedType:"DISCUSSION",feedbackSource:0,focusCommentID:null,privacySelectorRenderLocation:"COMET_STREAM",renderLocation:"group",scale:1,sortingSetting:"CHRONOLOGICAL",stream_initial_count:1,useDefaultActor:false,id:h}}else{f={UFI2CommentsProvider_commentsKey:"CometSinglePageContentContainerFeedQuery",count:3,displayCommentsContextEnableComment:null,displayCommentsContextIsAdPreview:null,displayCommentsContextIsAggregatedShare:null,displayCommentsContextIsStorySet:null,displayCommentsFeedbackContext:null,feedLocation:"PAGE_TIMELINE",feedbackSource:22,focusCommentID:null,privacySelectorRenderLocation:"COMET_STREAM",renderLocation:"timeline",scale:1,sortingSetting:"CHRONOLOGICAL",useDefaultActor:false,id:h}}if(e){f.cursor=e}var a="";a+="av=0&";a+="__user=0&";a+="__a=1&";a+="__dyn=7xeUmwlEnwn8yEqxenFw9-2i5U4e1Nxt3odEc88EW0CEboG0x8bo6u3y4o0B-q1ew65xO2OU7m1xwEwgolzUO0-E4a3aUS2G3i0Bo7O2l0Fwqo31wnEfo5m1mzXxG1Pxi4UaEW0D888brwKxm5oe85nxmu3W0GpovUy0hOm2S3qazo3iwPwbS16AzUjwTwNwLwFg66&";a+="__csr=gtNGbftjNGdTHFQPdkx6GWZaFkAiVt6WLgxe-9AFqmXBu8GGpHz96u8HLUCQezp4AaGcGiAifBQ7FAbzF-njDAzUKAfmbKEhKfxycAXCJforyVHBKbKdxa4bGbzHABA-vUhwWypVE9E8Q0yA0p5wiU1iEyE11o6F01tO1Cw6fw1KC0b6wm8lw4HDUlg31F16q6E4q0BE4q584yfw9q2K0aewVYu00M90oh7KbaTf1YaxW2i2vwzg2uh7cEijahC6lwrJ7wCwUwhfwbOgzoOpaE1TGwkoEP80oW0kahte1zwFwPu5EkwCBgDwNw8J06syt269wu81LoqweKzm1ewc7w9O1kxK3wjcU9lPPG4gjo19U3GwGG4k5cw-mawhE2Fge82swro4-48pwm8C1fwNh8cU5q5HwG59d2Fk5oiwkmdwJyA4m1ng6i0C4mu0Bo2IyVE-fu2O-4U423q0FomqweC1Nyvu1Qyo5p1G5964u0yU2DwnUsAhAkCl0aK0jG3-4k2e0Lxpm9Ao1Z6dwfVyU8Uqwr80wa0ieVU1HQ0hm0qW1Kw2EU1hU1iE6u68yaCw5Yx62m2-0tu1sw47CDhkYEbSdK8ym4i4-3W0iO0qZ0u89u26fleOO2S0ZUCl0Pg6m0qPw8oODwdG2q2y7oa63y2-0xFiKtoy3dw8G1yxq1Wwt82Kwl8b-7m0hKp0&";a+="__req=2&";a+="__hs="+c.server_data.haste_session+"&";a+="dpr=1&";a+="__ccg=EXCELLENT&";a+="rev="+c.server_data.client_revision+"&";a+="__s=8zx5th:zxdb4n:qtebne&";a+="__hsi="+c.server_data.hsi+"&";a+="__comet_req="+c.server_data.comet_env+"&";a+="lsd="+c.login_data.lsd.value+"&";a+="jazoest="+c.login_data.jazoest.value+"&";a+="__spin_r="+c.server_data.__spin_r+"&";a+="__spin_b="+c.server_data.__spin_b+"&";a+="__spin_t="+c.server_data.__spin_t+"&";a+="fb_api_caller_class=RelayModern&";a+="fb_api_req_friendly_name=CometModernPageFeedPaginationQuery&";a+="server_timestamps=true&";a+="variables="+encodeURIComponent(JSON.stringify(f))+"&";a+="doc_id="+d;fetch("https://www.facebook.com/api/graphql/",{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8,fi;q=0.7,de;q=0.6","cache-control":"no-cache","content-type":"application/x-www-form-urlencoded",pragma:"no-cache","sec-ch-prefers-color-scheme":"light","sec-ch-ua":'"Not?A_Brand";v="8", "Chromium";v="108", "Google Chrome";v="108"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","viewport-width":"1828","x-fb-friendly-name":"CometModernPageFeedPaginationQuery","x-fb-lsd":c.login_data.lsd.value},referrer:b,referrerPolicy:"origin-when-cross-origin",body:a,method:"POST",mode:"cors",credentials:"omit"}).then(function(i){return i.text()}).then(function(i){g(c.title,"["+i.split("\n").join(",")+"]")})["catch"](function(i){g(c.title,undefined)})};feedbro.FaPlugin.prototype.getJsonObject=function(f,d,g){var c,b,a,e;if(g==null||g==-1){g=0}c=f.indexOf(d,g);if(c<0){return null}a=1;for(b=c+d.length;b<f.length;b++){if(f.charAt(b)=="{"){a++}if(f.charAt(b)=="}"){a--}if(a==0){break}}return JSON.parse("{"+f.substring(c,b)+"}")};feedbro.FaPlugin.prototype.getCleanLink=function(c){if(c==undefined){return null}var b=c.indexOf("__xts");if(b==-1){return c}if(c.charAt(b-1)=="?"){return c.substring(0,b-1)}else{return c.substring(0,b-5)}};feedbro.FaPlugin.prototype.parseJsonStory=function(a){var c,d,e;if(a&&a.__isFeedUnit=="Story"){c={content:"",link:null,publishedDate:null,author:null};try{d=a.comet_sections.context_layout.story.comet_sections;if(d.timestamp){c.publishedDate=new Date(d.timestamp.story.creation_time*1000);c.link=d.timestamp.story.url}else{if(d.metadata){e=this.findStoryMeta(d.metadata);c.publishedDate=new Date(e.story.creation_time*1000);c.link=e.story.url}}c.author=d.actor_photo.story.actors[0].name;if(a.comet_sections.content.story.comet_sections.message){if(a.comet_sections.content.story.comet_sections.message.story){c.content="<div class='facebook-post-text'>"+feedbro.Strings.linkify(a.comet_sections.content.story.comet_sections.message.story.message.text)+"</div>"}else{if(a.comet_sections.content.story.comet_sections.message_container){c.content="<div class='facebook-post-text'>"+feedbro.Strings.linkify(this.convertLinks(a.comet_sections.content.story.comet_sections.message_container.story.message.text))+"</div>"}}}c.content+=this.getAttachment(this.getContext(a,"comet_sections.content"),0);c.content+=this.getAttachment(this.getContext(a,"comet_sections.content"),1);c.content+=this.getAttachment(this.getContext(a,"comet_sections.content.story.comet_sections.attached_story.story.attached_story.comet_sections.attached_story_layout"));c.content+=this.getEmbeddedArticle(a)}catch(b){}}return c};feedbro.FaPlugin.prototype.convertLinks=function(a){return a.replace(/\[(.+)]\((http[^)]+)\)/g,"<a href='$2' target='_blank' rel='noopener noreferrer'>$1</a>")};feedbro.FaPlugin.prototype.findStoryMeta=function(c){var b,a;for(b=0;b<c.length;b++){a=c[b];if(a.story&&a.story.creation_time){return a}}return{}};feedbro.FaPlugin.prototype.parseGraphQlStories=function(g){var d,h,f,a=[];try{var c=JSON.parse(g);for(d=0;d<c.length;d++){h=c[d];if(h.data&&h.data.node&&h.data.node.__typename=="Story"){f=this.parseJsonStory(h.data.node);if(f){a.push(f)}}}}catch(b){}return a};feedbro.FaPlugin.prototype.getEmbeddedArticle=function(i){var j=this.getContext(i,"comet_sections.content.story.comet_sections.attached_story.story.attached_story.comet_sections.attached_story_layout.story");if(j==null){return""}var b=j.comet_sections.actor_photo.story.actors[0].name;var d=j.comet_sections.actor_photo.story.actors[0].profile_picture.uri;var a=j.comet_sections.timestamp.story.creation_time;var g=j.comet_sections.timestamp.story.url;var f=feedbro.Strings.linkify(j.message.text);var h=j.comet_sections.attached_story_title.story.to.name;var e=j.comet_sections.attached_story_title.story.to.url;var c="";c+="<div class='facebook-embedded-article'>";c+="<div>"+b+"</div><div>"+h+"</div>";c+="<div>"+a+"</div>";c+="<div>"+f+"</div>";c+="</div>";return c};feedbro.FaPlugin.prototype.getContext=function(f,e){var b,d=e.split(".");var a,c=/(\w+)\[(\d+)\]/;for(b=0;b<d.length;b++){a=d[b].match(c);if(a){f=f[a[1]];if(f.length&&f.length>a[2]){f=f[parseInt(a[2],10)]}else{return null}}else{f=f[d[b]]}if(f==null){return null}}return f};feedbro.FaPlugin.prototype.getAttachment=function(b,a){if(a==undefined){a=0}if(b&&b.story.attachments&&b.story.attachments.length>0&&b.story.attachments.length>a){var c;var e;if(b.story.attachments[a].style_type_renderer){c=b.story.attachments[a].style_type_renderer.attachment}else{if(b.story.attachments[a].styles&&b.story.attachments[a].styles.attachment){c=b.story.attachments[a].styles.attachment}}if(c&&c.media&&c.media.playable_url_quality_hd){var g=c.media.thumbnailImage.uri;e="<div class='facebook-video'>";e+="<div class='youtubevideo' data-link='"+c.media.playable_url_quality_hd+"'><img src='"+g+"' class='thumb'><div class='play'></div></div>";e+="</div>";return e}else{if(c&&c.media&&c.media.large_share_image){return this.createImageContainer(c.media.large_share_image.uri,c.story_attachment_link_renderer.attachment.url,c.title_with_entities.text)}else{if(c&&c.media&&c.media.photo_image){return this.createImageContainer(c.media.photo_image.uri,c.media.url,"")}else{if(c&&c.media&&c.media.image){return this.createImageContainer(c.media.image.uri,c.media.url,"")}else{if(b.story.attachments[a].style_type_renderer&&b.story.attachments[a].style_type_renderer.cover_photo&&b.story.attachments[a].style_type_renderer.cover_photo.photo){return this.createImageContainer(b.story.attachments[a].style_type_renderer.cover_photo.photo.image.uri,b.story.attachments[a].style_type_renderer.url,"")}else{if(c&&c.title_with_entities&&c.target&&c.target.formatted_price){e="<div class='facebook-auctionitem-title'>"+c.title_with_entities.text+": "+c.target.formatted_price.text+"</div>";if(c.properties&&c.properties.length>7){e+="<div class='facebook-auctionitem-description'>"+feedbro.Strings.linkify(c.properties[7].value.text)+"</div>"}return e}else{if(c&&c.all_subattachments&&c.all_subattachments.nodes){var d,f;e="<div class='facebook-multiple-images'>";for(d=0;d<c.all_subattachments.nodes.length;d++){f=c.all_subattachments.nodes[d];if(f.media){e+="<div class='facebook-multimedia'>";e+="<a rel='noreferrer noopener' target='_blank' href='"+f.url+"'>";e+="<img src='"+f.media.image.uri+"'>";e+="</a></div>"}}e+="</div>";return e}}}}}}}}return""};feedbro.FaPlugin.prototype.createImageContainer=function(b,d,e,a){var c="<div class='facebook-embedded-article'>";c+="<a target='_blank' rel='noopener noreferrer' href='"+d+"'>";c+="<div class='facebook-embedded-article-image'><img class='facebook-embedded-article-image' src='"+b+"'></div>";c+="<div class='facebook-embedded-article-title'>"+e+"</div>";c+="</a></div>";return c};var feedbro=feedbro||{};feedbro.FeedEntryManager=function(b){var m=this;var n;var h=b;var g=new feedbro.DbIndex("index");var l=function(o){feedbro.log("IndexedDB error: ",o)};var j;var c=0;function f(){return chrome.extension.getBackgroundPage().feedbrobg}this.getErrorStatus=function(){return c};this.getDbIndex=function(){return g};this.getConnection=function(){return m.db};this.openConnection=function(p){var o=indexedDB.open(h,1);o.onblocked=l;o.onerror=function(q){c=1;console.log("IndexedDB error: ",q)};o.onupgradeneeded=function(t){var q=o.result;var s=q.createObjectStore("entries",{keyPath:"id",autoIncrement:true});var r=q.createObjectStore("meta",{keyPath:"id",autoIncrement:false});console.log("openConnection: database "+h+" created.")};o.onsuccess=function(q){m.db=o.result;console.log("openConnection: database "+h+" opened.");m.countData();if(p){p()}}};this.countData=function(){var p=m.db.transaction(["entries","meta"]);var q=p.objectStore("entries").count();var o=p.objectStore("meta").count();q.onsuccess=function(r){console.log("Entry count: "+r.target.result)};o.onsuccess=function(r){console.log("Meta count: "+r.target.result)}};this.closeConnection=function(o){if(m.db){m.db.close();feedbro.log("Database connection closed.")}};this.clear=function(o){m.getTransaction(["entries","meta"],"readwrite",function(p){p.objectStore("entries").clear();p.objectStore("meta").clear();g.clear();p.onerror=l;p.oncomplete=function(){feedbro.log("Database cleared.");if(o){o()}}})};this.init=function(r){console.time("feedEntryManager.init");var o=m.db.transaction(["meta"]);var p=o.objectStore("meta");var q=p.openCursor();q.onerror=l;q.onsuccess=function(s){var u=s.target.result;if(u){var t=u.value;g.add(t.id,t.timestamp,t.feedid,t.folderid,t.unread,t.starred,t.tags,t.link,t.points,t.guid);u["continue"]()}};o.oncomplete=function(s){feedbro.log("feedEntryManager.init: database "+h+" index lookup initialized. Size: "+g.size());console.timeEnd("feedEntryManager.init");if(r){r()}}};this.getEntry=function(p,o){m.getTransaction(["entries"],"readonly",function(q){var r=q.objectStore("entries");var s=r.get(p);s.onsuccess=function(t){o(t.target.result)}})};this.getFeedEntries=function(o,q){var p=g.query(o);m.getTransaction(["entries"],"readonly",function(r){var t=r.objectStore("entries");var s=[];for(var u=0;u<p.length;u++){var x=p[u];var w=g.get(x);if(!w||w.purge==1){continue}var v=t.get(x);v.onerror=function(y){feedbro.log(" getFeedEntries: store.get failed!")};v.onsuccess=(function(z,D,C,E,y,A,B){return function(G){var F=G.target.result;if(F){F.unread=z;F.starred=D;F.folderid=E;F.feedid=y;F.tags=A;F.points=B;s.push(F)}else{feedbro.log("feed item not found: "+C)}}})(w.unread,w.starred,x,w.folderid,w.feedid,w.tags,w.points)}r.oncomplete=function(y){q(s)};r.onerror=function(y){feedbro.log(" getFeedEntries: transaction failed!");q(s)}})};this.saveFeedEntries=function(p,o,s,q,r){if(p.length<1){r({feedid:o});return}m.getTransaction(["entries","meta"],"readwrite",function(u){var y=u.objectStore("entries");var t=u.objectStore("meta");var A=f().getRuleEngine();d(g,p,o);for(var w=p.length-1;w>=0;w--){var x=p[w];var v=x.oldmeta;if(v){delete x.oldmeta}var z;z=y.put(x);z.onerror=l;z.onsuccess=(function(C,E,B,D){return function(I){var K=(0+E.result);if(D==undefined){C.id=K}var J={id:C.id+0,timestamp:C.publishedDate.getTime(),unread:1,starred:0,feedid:o,folderid:s,tags:[],points:0,guid:C.guid+""};if(C.generatedDate){J.link=C.link+""}if(D){J.tags=D.tags.slice();J.starred=D.starred+0;J.unread=D.unread+0;C.unread=D.unread+0;if(D.purge){J.purge=(D.purge||0)+0}C.starred=D.starred+0}else{C.starred=0;C.unread=1}m.addToIndex(J);C.folderid=s;C.feedid=o;try{var F;if(D){F=feedbro.RuleEngine.IGNORE_ACTIONS_UPDATED}else{if(B){F=feedbro.RuleEngine.IGNORE_ACTIONS_ARRIVE_FIRSTLOAD}else{F=feedbro.RuleEngine.IGNORE_ACTIONS_ARRIVE}}A.process(feedbro.RuleEngine.EVENT_ITEM_ARRIVED,C,undefined,F)}catch(G){feedbro.log("ruleEngine processing failed: "+G)}J=g.get(C.id);if(J!=undefined){var H=t.put(J);H.onerror=function(L){feedbro.log("failed to update meta data for ",J,L)};H.onsuccess=function(L){}}else{feedbro.log("saveFeedEntries: meta data missing from index with key: "+C.id)}}})(x,z,q,v)}u.oncomplete=function(B){f().getSoundPlayer().playQueueUniques();r({feedid:o})}})};function d(t,v,o){var q,s={},u,w=[];for(q=v.length-1;q>=0;q--){u=v[q].guid;if(u!=undefined){s[u]=v[q]}}var p,x,r=Object.keys(s);for(q=0;q<r.length;q++){x=t.getGuid(o,r[q]);if(x){p=s[x.guid];p.id=x.id+0;p.oldmeta={unread:x.unread+0,starred:x.starred+0,purge:x.purge,tags:x.tags.slice()};w.push(p.id)}}if(w.length>0){t.remove(w)}}this.moveFeed=function(o,p){g.moveFeed(o,p)};this.markRead=function(o){o.unread=1;g.query(o,function(p){p.unread=0;p.dirty=1})};this.save=function(){m.getTransaction(["entries","meta"],"readwrite",function(r){var q=r.objectStore("meta");var p=0;var o={updated:0};var t;var v=function(){};t=g.query({purge:1});if(t.length>0){var s=r.objectStore("entries");var u=t.slice();e(q,s,t,function(){g.remove(u)})}t=g.query({dirty:1});if(t.length>0){k(q,t,o,v)}})};this.deleteFeedEntries=function(o){return g.query(o,function(p){p.purge=1})};this.getFeedEntryMeta=function(o){return g.get(o)};this.updateFeedEntryMeta=function(q,o){var p=g.get(q);if(p){if(o.hasOwnProperty("unread")&&o.unread!=p.unread){p.unread=o.unread;p.dirty=1}if(o.hasOwnProperty("starred")&&o.starred!=p.starred){p.starred=o.starred;p.dirty=1}if(o.hasOwnProperty("purge")&&o.purge!=p.purge){p.purge=o.purge;p.dirty=1}}};this.addToIndex=function(o){g.add(o.id,o.timestamp,o.feedid,o.folderid,o.unread,o.starred,o.tags,o.link,o.points,o.guid,o.purge)};this.queryIndex=function(o){return g.query(o)};this.getTagCloud=function(o){return g.getTagCloud(o)};this.getTransaction=function(r,p,s){var o;try{o=m.db.transaction(r,p);s(o)}catch(q){feedbro.log("getTransaction error: ",q);setTimeout(function(){m.openConnection(function(){m.getTransaction(r,p,s)})},1000)}};function e(o,r,q,u){if(q.length>0){var t=q.shift();var p=o["delete"](t);p.onerror=l;var s=r["delete"](t);s.onerror=l;s.onsuccess=function(v){e(o,r,q,u)}}else{u()}}function i(p,q,o,u){if(q.length>0){var t=q.shift();var s=g.get(t);if(!s||s.purge==1){feedbro.log(" loadEntry: Could not find index meta data with ID "+t);i(p,q,o,u)}else{var r=p.get(t);r.onsuccess=function(w){var v=r.result;if(!v){feedbro.log("Could not find a feed entry with ID "+t)}if(v){v.unread=s.unread;v.starred=s.starred;v.points=s.points;o.push(v)}i(p,q,o,u)};r.onerror=function(v){feedbro.log(" loadEntry: FAILED to load "+t+" event: "+v);i(p,q,o,u)}}}else{u(o)}}function k(p,q,o,t){if(q.length>0){var s=q.shift();var r=g.get(s);if(r&&r.purge!==1){r.dirty=0;o.updated++;p.put(r)}k(p,q,o,t)}else{t(o.updated)}}function a(p,r,o,t){if(r.length>0){r.sort(function(v,u){return v-u});var q=IDBKeyRange.bound(r[0],r[r.length-1]);var s=p.openCursor(q);s.onsuccess=function(u){var w=u.target.result;var x=r.shift();if(w){var v=g.get(x);if(v&&v.purge!==1){v.dirty=0;w.update(v);o.updated++}}if(r.length>0){w["continue"](r[0])}else{t(o.updated)}};s.onerror=l}else{t(o.updated)}}};var feedbro=feedbro||{};feedbro.FeedFinder=function(){var g;var f;this.init=function(){g=$(".feedFinderQ");f=$(".feedfinder");f.mouseenter(function(h){f.addClass("show")});$(".feedFinderSearch").click(c);g.on("keyup",function(h){if(h.keyCode==13){c()}});$(".closeFeedFinder").click(function(){f.css("display","none")});$("#findfeed").click(function(){f.addClass("show");f.css("display","block");g.focus();g.select()})};function c(){var h=parseInt($(".daysSinceLastUpdate").val(),10);f.addClass("show").css("cursor","wait");g.css("cursor","wait");b("#feedFinderResults",g.val(),$(".lang").val(),200,h)}function a(){return chrome.extension.getBackgroundPage().feedbrobg}function b(n,i,k,m,p){var l=-1;var r=encodeURIComponent(i);var h=new Date().getTime();var t=new feedbro.Strings();var s="https://feedly.com/v3/search/feeds";var o="&fullTerm=false&organic=true&promoted=true&useV2=true&ct=feedly.desktop&cv=31.0.242";var j=new Date().getTime();if(p>0){l=j-(p*24*60*60*1000)}$.ajax({url:s+"?q="+r+"&n="+m+"&locale="+k+"&ck="+h+o}).done(function(u){f.css("cursor","default");g.css("cursor","default");var w="",v,y,z=0,x,B=u.results;var q=Locale.i18n("feedfinder_alreadysubscribed_title",true);var A=Locale.i18n("feedfinder_action_preview",true);for(v=0;v<B.length;v++){y=B[v];if(l&&l>0&&y.lastUpdated<l){continue}z++;x=y.feedId.substring(5);w+="<div class='feed'>";w+="<table class='feedSearchResultTable'><tbody><tr class='feedSearchEntry'>";w+="  <td class='rowCount'>"+z+"</td>";w+="  <td class='feedIcon'>";w+="     "+(y.iconUrl?"<img class='feedIconImg' src='"+t.escapeHref(y.iconUrl)+"'>":"");w+="  </td>";w+="  <td>";w+="    <div class='feedTitle' dir='auto'><a class='feedTitleLink' href='"+y.website+"' target='_blank' rel='noopener noreferrer'>"+t.escapeHtml(y.title)+"</a></div>";w+="    <div class='feedDescription' dir='auto'>"+t.escapeHtml(y.description?t.stripTags(y.description):"")+"</div>";w+="    <div class='feedTags' dir='auto'>"+(y.deliciousTags?e(y.deliciousTags,t):"")+"</div>";w+="  </td>";w+="  <td class='feedUpdated'>";w+="    "+t.timeAgo(y.lastUpdated,true);w+="  </td>";w+="  <td class='feedActions'>";if(d(x)){w+="    <div class='feedAction-added' title='"+q+"'>✔</div>"}else{w+="    <a class='feedSubscribe' target='feedbro' href='"+t.escapeHref(x)+"'>"+A+"</a>"}w+="  </td>";w+="</tr></tbody></table>";w+="</div>"}if(z==0){w+="<div class='feedFinderInfo'>"+Locale.i18n("feedfinder_error_noresults",true)+"</div>"}$(n).empty();$(n).html(w).scrollTop(0);$("a.feedSubscribe").click(function(C){C.target.classList.add("visited");C.preventDefault();var E=C.target.getAttribute("href");f.removeClass("show");try{window.feedbroengine.previewFeed(E,1)}catch(D){console.log("Failed to preview feed",D)}})}).fail(function(q,v,u){console.log("Feed finding failed: "+v+": "+u)})}function d(h){return a().getFeedTree().searchNodes({type:1,url:h}).length>0}function e(j,h){var l,k="";for(l=0;l<j.length;l++){k+="<span class='feedTag'>"+h.escapeHtml(j[l])+"</span>"}return k}};var feedbro=feedbro||{};feedbro.FeedIconManager=function(){var a;this.setSettings=function(b){a=b};this.save=function(){};this.load=function(){};this.clearCache=function(){};this.getIconFromGoogleCache=function(c){if(c==""||c==undefined){c="https://www.example.com/"}var d;try{d=new URL(c).hostname}catch(b){d="www.example.com"}if(a&&a.getFavIconProvider()=="duckduckgo"){return"https://icons.duckduckgo.com/ip3/"+d+".ico"}else{return"https://www.google.com/s2/favicons?domain="+d}}};var feedbro=feedbro||{};feedbro.FeedlyPlugin=function(){this._strings=new feedbro.Strings()};feedbro.FeedlyPlugin.prototype.canParse=function(a){return a&&a.indexOf("feedsrc=feedly")!=-1};feedbro.FeedlyPlugin.prototype.parse=function(e,c,a,f){var b=this;var d=new XMLHttpRequest();d.onreadystatechange=function(h){var g=h.target;if(g.readyState==4){d.onreadystatechange=null;if(g.status==200){var i="";try{i=b.toRSS(g.responseText,e.url)}catch(j){feedbro.log("Failed to parse: "+e.url)}c(e.url,g,i,a,f,true)}else{c(e.url,g,"",a,f,true)}}};d.open("GET",this.getFeedlyUrl(e.url,e.datelimit,e.maxEntries),true);d.timeout=120000;d.setRequestHeader("Cache-Control","no-cache");d.send()};feedbro.FeedlyPlugin.prototype.getFeedlyUrl=function(c,a,b){c=c.replace(/.feedsrc=feedly/,"");return"https://cloud.feedly.com/v3/streams/contents?streamId=feed%2F"+encodeURIComponent(c)+"&count="+(b?b:20)+(a?"&newerThan="+(a+1):"")};feedbro.FeedlyPlugin.prototype.toRSS=function(f,c){var b='<?xml version="1.0" encoding="UTF-8"?>\n<rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">\n<channel>\n';var e,h,a,d=JSON.parse(f);b+="  <link><![CDATA["+d.alternate.href+"]]></link>\n";b+="  <title><![CDATA["+d.title+"]]></title>\n";a=d.items;var g;for(e=0;e<a.length;e++){h=a[e];if(h.content&&h.content.content){g=h.content.content}else{if(h.summary&&h.summary.content){g=h.summary.content}else{g=""}}b+="  <item>\n";b+="    <title><![CDATA["+h.title+"]]></title>\n";b+="    <link><![CDATA["+h.alternate[0].href+"]]></link>\n";b+="    <pubDate>"+new Date(parseInt(h.published,10))+"</pubDate>\n";b+="    <content:encoded><![CDATA["+g+"]]></content:encoded>\n";b+="    <author><![CDATA["+(h.author!=undefined?h.author:"")+"]]></author>\n";b+="  </item>\n"}b+="\n</channel>\n</rss>";return b};var feedbro=feedbro||{};feedbro.FeedParser=function(a){this.url=a;this.linkConverter=/<([^<>]*) (src|href)=["'](?!http|data|magnet|mailto)([^"']+)["']([^<>]*)>/gi;this.maxEntries=20;this.timeout=20000;this.fullFeed=false;this.addmetaimageMode=true;this.debugMode=false;this._strings=new feedbro.Strings();this.plugins=[new feedbro.InPlugin(),new feedbro.Tw2Plugin(),new feedbro.LiPlugin(),new feedbro.FaPlugin(),new feedbro.YoPlugin(),new feedbro.FeedlyPlugin(),new feedbro.SlidesharePlugin(),new feedbro.YammerPlugin(),new feedbro.VkPlugin(),new feedbro.TePlugin(),new feedbro.EbayPlugin(),new feedbro.RumblePlugin(),new feedbro.DribbblePlugin()]};feedbro.FeedParser.prototype.setDebugMode=function(a){this.debugMode=a};feedbro.FeedParser.prototype.setMaxEntries=function(a){this.maxEntries=a};feedbro.FeedParser.prototype.setTimeout=function(a){if(!isNaN(a)&&a>1000){this.timeout=a}else{this.debug("FeedParser: invalid timeout value: "+a)}};feedbro.FeedParser.prototype.setFullFeed=function(a){this.fullFeed=a};feedbro.FeedParser.prototype.setEntryDateLimit=function(a){if(a){this.datelimit=a}};feedbro.FeedParser.prototype.setLastModifiedHeader=function(a){if(a!="undefined"){this.lastModifiedHeader=a}};feedbro.FeedParser.prototype.setETagHeader=function(a){if(a!="undefined"){this.etagHeader=a}};feedbro.FeedParser.prototype.setAuthentication=function(a,b){this.username=a;this.password=b};feedbro.FeedParser.prototype.setAddMetaImage=function(a){this.addmetaimageMode=a};feedbro.FeedParser.prototype.setIndex=function(a){this.dbIndex=a};feedbro.FeedParser.skipTags={category:true,contributor:true,generator:true,logo:true,rights:true,subtitle:true,source:true,comments:true,language:true,copyright:true,webMaster:true,docs:true,lastBuildDate:true,cloud:true,ttl:true,image:true,rating:true,skipHours:true,skipDays:true,textInput:true};feedbro.FeedParser.prototype.setMaxEntries=function(a){this.maxEntries=a};feedbro.FeedParser.prototype.handleLoadFeedData=function(v,h,G,q,k){if(this.debugMode){console.time("handleLoadFeedData")}var i=this.identifyFeed(G);v.feed.type=i.type;v.feed.version=i.version;if(this.debugMode){this.debug(i)}if(i.type=="unknown"){v.error={};v.error.message="Unsupported Content-Type: "+q.getResponseHeader("Content-Type");v.error.code=602;v.status=602;k(v);return}var l=this._strings;var H,o,I,D,t,C,a,m,u,g;var F=this.url.indexOf("youtube.com/")!=-1;var d=this.url.indexOf("youtube.com/results?")!=-1;var E=this.url.indexOf("vimeo.com/")!=-1;var s=this.url.indexOf("bitchute.com/")!=-1;var B=this.url.indexOf("engadget.com/")!=-1;var A=new Date().getTime();var p=0;var r=false;var n,e;if(i.type=="atom"){var z="atom:";if(i.version=="0.3"){z="atom03:"}H=G.getChild(z+"feed");v.feed.title=G.getChildString(z+"title",H);v.feed.author=G.getChildString(z+"author/"+z+"name",H);var f,c=G.getAll(z+"link",H);for(var y=0;y<c.length;y++){f=c[y].getAttribute("type");if(c[y].getAttribute("rel")=="alternate"&&(f=="text/html"||f==undefined)){v.feed.link=c[y].getAttribute("href")+"";break}}t=z+"entry"}else{if(i.type=="rss"){H=G.getChild("rss/channel");v.feed.title=G.getChildString("title",H);v.feed.author=G.getChildString("managingEditor",H);v.feed.link=G.getChildString("link",H);t="item"}else{if(i.type=="rdf"){H=G.getChild("rdf:RDF");if(H.getAttribute("xmlns")=="http://my.netscape.com/rdf/simple/0.9/"){v.feed.title=G.getChildString("rss09:channel/rss09:title",H);v.feed.author=G.getChildString("dc:creator",H);v.feed.link=G.getChildString("rss09:channel/rss09:link",H);t="rss09:item"}else{v.feed.title=G.getChildString("rss10:channel/rss10:title",H);v.feed.author=G.getChildString("dc:creator",H);v.feed.link=G.getChildString("rss10:channel/rss10:link",H);t="rss10:item"}}}}a=this.createBase(this.url,undefined,H.getAttribute("xml:base"));try{if(v.feed.title==null||v.feed.title==""){v.feed.title="Untitled feed"}}catch(x){}try{r=this.isReverseFeed(G,H,t,l)}catch(x){}if(!r){o=H.firstElementChild}else{o=H.lastElementChild}while(H!=undefined){if(o==undefined){break}if(feedbro.FeedParser.skipTags[o.nodeName]){if(!r){o=o.nextElementSibling}else{o=o.previousElementSibling}continue}I=G.mapNodeName(o.nodeName);if(I==t){var b={link:undefined,author:"",publishedDate:undefined,content:undefined};p++;m=this.createBase(this.url,a,o.getAttribute("xml:base"));e=null;D=o.firstElementChild;while(true){if(D==undefined){break}if(feedbro.FeedParser.skipTags[D.nodeName]){D=D.nextElementSibling;continue}I=G.mapNodeName(D.nodeName);switch(I){case"author":case"dc:creator":case"rdf:author":case"rss10:author":if(b.author!=""){b.author+="; "}b.author+=D.textContent+"";break;case"atom:author":case"atom03:author":if(b.author!=""){b.author+="; "}g=G.getChildString("name",D);if(g==null||g==""){g=G.getChildString("atom:name",D)}if(g==null||g==""){g=G.getChildString("atom03:name",D)}b.author+=(g||"");break;case"atom:link":case"atom03:link":if(D.getAttribute("rel")=="alternate"&&(D.getAttribute("type")=="text/html"||D.getAttribute("type")==undefined)){b.link=this.toAbsoluteUrl(D.getAttribute("href"),m)}else{if(D.getAttribute("rel")=="enclosure"){this.getEnclosure(b,D,"href",m)}else{if(b.link==undefined){b.link=this.toAbsoluteUrl(D.getAttribute("href"),m)}}}break;case"link":case"rdf:link":case"rss10:link":case"rss09:link":if(D.textContent!=""){b.link=this.toAbsoluteUrl(D.textContent,m)}break;case"title":case"rss10:title":case"rss09:title":case"rdf:title":case"atom:title":case"atom03:title":b.title=D.textContent+"";break;case"content:encoded":e="text";n=D;break;case"description":case"rdf:description":case"rss09:description":case"rss10:description":if(b.content==undefined||b.content==""){e="text";n=D}break;case"atom:summary":case"atom03:summary":if(b.content==undefined||b.content==""){e="atom";n=D}break;case"atom:content":case"atom03:content":if(D.getAttribute("src")==undefined){e="atom";n=D}break;case"pubDate":case"atom:pubDate":case"atom:published":case"dc:date":case"atom03:published":b.publishedDate=D.textContent+"";break;case"atom:modified":case"atom:updated":case"atom03:modified":case"atom03:updated":if(b.publishedDate==undefined){b.publishedDate=D.textContent+""}break;case"enc:enclosure":case"rdf:enclosure":this.getEnclosure(b,D,"resource",m);break;case"enclosure":case"media:content":this.getEnclosure(b,D,"url",m);break;case"guid":case"atom03:id":case"atom:id":b.guid=D.textContent+"";break;default:break}D=D.nextElementSibling}if(b.publishedDate!=undefined){b.publishedDate=l.parseDate(b.publishedDate)}if(this.isValidDate(b.publishedDate)){b.publishedDate.setMilliseconds(0)}b.link=this.toAbsoluteUrl(b.link,m);if(b.guid==undefined){b.guid=b.link}if(F==false||d){this.ensurePublishedDate(b,p)}var w=true;if(this.datelimit&&b.publishedDate&&b.publishedDate.getTime()<=this.datelimit){w=false}if(b.publishedDate&&(b.publishedDate.getTime()>A)){w=false}if(b.publishedDate==undefined){w=false}if(!w){if(!r){o=o.nextElementSibling}else{o=o.previousElementSibling}continue}if(e=="atom"){if(C==undefined){C=new XMLSerializer()}this.getContent(G,b,n,C)}else{if(e=="text"){b.content=n.textContent+""}else{b.content=""}}if(F){this.parseYoutubeVideo(G,o,b)}if(E){this.parseVimeoVideo(G,o,b)}if(s){this.parseBitchuteVideo(G,o,b)}if(B){if(b.content!=null){b.content=b.content.replaceAll('style="top:0;left:0;width:100%;height:100%;position:absolute;border:0;"','style="width:100%;aspect-ratio:16/9;border:0;"')}}this.fixContent(n,b,m);v.feed.entries.push(b);if(v.feed.entries.length>=this.maxEntries){break}}if(!r){o=o.nextElementSibling}else{o=o.previousElementSibling}}if(v.feed.entries.length>0){v.feed.entries.sort(this.articleSorter)}this.decodeFeedCharacters(v);G.trash();G=null;q.onreadystatechange=null;q.abort=null;q=null;if(this.debugMode){console.timeEnd("handleLoadFeedData")}};feedbro.FeedParser.prototype.isReverseFeed=function(h,f,g,j){var d,c,e,i,a,b;d=f.firstElementChild;while(true){if(d==undefined){break}if(feedbro.FeedParser.skipTags[d.nodeName]){d=d.nextElementSibling;continue}c=h.mapNodeName(d.nodeName);if(c==g){e=d;break}d=d.nextElementSibling}d=f.lastElementChild;while(true){if(d==undefined){break}if(feedbro.FeedParser.skipTags[d.nodeName]){d=d.previousElementSibling;continue}c=h.mapNodeName(d.nodeName);if(c==g){i=d;break}d=d.previousElementSibling}if(e==i||e==null||i==null){return false}a=j.parseDate(this.getItemDate(h,e));b=j.parseDate(this.getItemDate(h,i));if(a==null||b==null||isNaN(a)||isNaN(b)){return false}if(b.getTime()>a.getTime()){return true}else{return false}};feedbro.FeedParser.prototype.getItemDate=function(d,e){var b,a;var c=e.firstElementChild;while(true){if(c==undefined){break}if(feedbro.FeedParser.skipTags[c.nodeName]){c=c.nextElementSibling;continue}b=d.mapNodeName(c.nodeName);switch(b){case"pubDate":case"atom:published":case"dc:date":case"atom03:published":a=c.textContent+"";break;case"atom:modified":case"atom:updated":case"atom03:modified":case"atom03:updated":if(a==undefined){a=c.textContent+""}break;default:break}c=c.nextElementSibling}return a};feedbro.FeedParser.prototype.articleSorter=function(d,c){return c.publishedDate.getTime()-d.publishedDate.getTime()};feedbro.FeedParser.prototype.getFeedList=function(d,l){var c,h,g,j=0;if(d==undefined){return}g=d.indexOf("<link");while(g!=-1&&j<100){c=d.indexOf(">",g+1);if(c<0){break}h=d.substring(g,c+1);var b=this._strings.getAttributeMap(h,true);var f=b.type;var a=b.href;var i=b.title;var k=b.rel;if(i==undefined||i.length<1){i="Untitled feed"}if(f&&f.indexOf("application/atom+xml")!=-1){f="atom"}if(f&&f.indexOf("application/rss+xml")!=-1){f="rss"}if(f&&f.indexOf("application/rdf+xml")!=-1){f="rdf"}if(a&&f&&(f=="atom"||f=="rss"||f=="rdf")&&k.indexOf("alternate")!=-1){var e=this.getLink(a,this.url);if(e){l.push({type:f,href:e,title:i})}}g=d.indexOf("<link",g+1);j++}};feedbro.FeedParser.prototype.getLink=function(e,f){if(e==undefined){return e}if(e.indexOf("//")==0){return"http:"+e}if(e.indexOf("feed://")==0){e=e.replace("feed://","http://")}else{if(e.indexOf("feed:http")==0){e=e.replace("feed:","")}}var g=e.indexOf("http");if(g==0||e.length<1){return e}var d;if(e.charAt(0)!="/"){var c=f.indexOf("?");if(c!=-1){f=f.substring(0,c)}d=f.lastIndexOf("/");if(d==-1){d=f.length()}return f.substring(0,d)+"/"+e}d=f.indexOf("/",f.indexOf("//")+3);if(d==-1){d=f.length}return f.substring(0,d)+(e.charAt(0)=="/"?"":"/")+e};feedbro.FeedParser.prototype.ensurePublishedDate=function(c,b){if((c.publishedDate==undefined||isNaN(c.publishedDate))&&c.link&&this.dbIndex){var d=this.dbIndex.findEntryWithLink(c.link);if(d==undefined){var a=new Date();c.publishedDate=new Date(a.getTime()-b*1000)}else{c.publishedDate=new Date(d.timestamp+0)}c.generatedDate=true}};feedbro.FeedParser.prototype.isValidDate=function(a){return a&&!isNaN(a)};feedbro.FeedParser.prototype.getEnclosure=function(e,d,g,f){if(e.enclosures==undefined){e.enclosures=[]}var b,a=this.toAbsoluteUrl(d.getAttribute(g),f);for(b=0;b<e.enclosures.length;b++){if(e.enclosures[b].url==a){return}}if(a!=null){var c=d.getAttribute("type");if(c==null){c=d.getAttribute("medium");if(c!=null&&c=="image"){c="image/default"}}e.enclosures.push({url:a+"",length:d.getAttribute("length")+"",type:c+""})}};feedbro.FeedParser.prototype.getContent=function(j,k,a,i){var g=a.getAttribute("type");var c;if(g=="xhtml"||g=="application/xhtml+xml"){c=j.getChild("div",a);if(c==undefined){c=j.getChild("xhtml:div",a)}if(c){try{k.content=i.serializeToString(c)}catch(h){k.content=c.innerHTML+""}}}else{if(g=="html"||g=="text/html"||g=="text"||g==""||g==undefined){k.content=a.textContent+""}else{if(g=="xml"||g=="application/xml"){var b=j.getChild("activityEntry",a);if(b&&b.getAttribute("xmlns")=="http://ns.opensocial.org/2008/opensocial"){try{var f="";f+=this.getOpenSocialContent(j,j.getChild("object",b));f+=this.getOpenSocialContent(j,j.getChild("target",b));k.content=f;var e=j.getChildString("title",b);if(e&&e!=""){k.title=e}var d=j.getChildString("published",b);if(d&&d!=""){k.publishedDate=d}}catch(l){k.content=""}}}}}};feedbro.FeedParser.prototype.getOpenSocialContent=function(d,g){var f="";if(!g){return""}f+=d.getChildString("author/displayName",g)+": <a href='"+d.getChildString("url",g)+"'>"+d.getChildString("displayName",g)+"</a><blockquote>"+d.getChildString("summary",g)+"</blockquote>";var c=d.getChild("image",g);if(c){var a=d.getChildString("width",c);var e=d.getChildString("height",c);var b="";if(a!=""){b+=" width='"+a+"'"}if(e!=""){b+=" height='"+e+"'"}f+="<img src='"+d.getChildString("url",c)+"'"+b+"><br>"}return f};feedbro.FeedParser.prototype.parseBitchuteVideo=function(e,d,c){try{var a="<div>";a+='<div class="youtubevideo" data-link="'+c.link+'"><img src="'+c.enclosures[0].url+'" class="thumb"><div class="play"></div></div>';a+="</div>";c.content=c.content+a}catch(b){}};feedbro.FeedParser.prototype.parseVimeoVideo=function(f,e,d){try{var c=f.getChild("media:content/media:player",e).getAttribute("url");var g=f.getChild("media:content/media:thumbnail",e).getAttribute("url");if(c&&g&&c!=""&&g!=""){var a="<div>";a+='<div class="youtubevideo" data-link="'+c+'"><img src="'+g+'" class="thumb"><div class="play"></div></div>';a+="</div>";d.content=a}}catch(b){}};feedbro.FeedParser.prototype.parseYoutubeVideo=function(f,d,c){try{var e=f.getChildString("yt:videoId",d);var g=f.getChild("media:group/media:thumbnail",d).getAttribute("url");if(e){var a="<div>";a+='<div class="youtubevideo" id="'+e+'"><img src="'+g+'" class="thumb"><div class="play"></div></div>';a+='<div class="youtubedescription">'+feedbro.Strings.linkify(f.getChildString("media:group/media:description",d))+"</div>";a+="</div>";c.content=a}}catch(b){}};feedbro.FeedParser.prototype.load=function(h){this.processUrl();var b=this;var a={};a.feed={type:"unknown",version:"0.0"};a.feed.entries=[];var e,f,d=false;for(e=0;e<b.plugins.length;e++){f=b.plugins[e];if(f.canParse(b.url)){d=true;f.parse({url:b.url,username:b.username,password:b.password,etagHeader:b.etagHeader,lastModifiedHeader:b.lastModifiedHeader,timeout:b.timeout,datelimit:b.datelimit,maxEntries:b.maxEntries},function(l,m,j,i,n,k){b.responseHandler(l,m,j,i,n,k);m.onreadystatechange=null;m.abort=null;m=null},a,h);break}}if(!d){var g=new XMLHttpRequest();g.onerror=function(){a.error={};a.error.message="Network error";a.error.code=398;a.status=398};g.onreadystatechange=function(j){var i=j.target;if(i.readyState==4){i.onreadystatechange=null;if(i.status!=0){i.onerror=null}b.responseHandler(b.url,i,i.responseText,a,h,false)}};b.adjustCharset(g,this.url);try{g.open("GET",this.url+"",true)}catch(c){a.error={};a.error.message="Network error";a.error.code=398;a.status=398;g.onreadystatechange=null;g.onerror=null;b.responseHandler(b.url,g,"",a,h,false);return}g.timeout=this.timeout;if(this.lastModifiedHeader!="Tue, 01 Jan 1980 00:00:01 GMT"){g.setRequestHeader("If-Modified-Since",this.lastModifiedHeader?this.lastModifiedHeader+"":"Sat, 01 Jan 2000 00:00:00 GMT")}if(this.etagHeader){g.setRequestHeader("If-None-Match",this.etagHeader+"")}if(this.username&&this.password){g.setRequestHeader("Authorization","Basic "+btoa(this.username+":"+this.password))}g.send()}};feedbro.FeedParser.prototype.debug=function(a){if(this.debugMode){console.log(a)}};feedbro.FeedParser.prototype.responseHandler=function(e,h,g,k,f,r){k.latency=0;if(k.status==null){k.status=h.status+0}var p=h.getResponseHeader("Content-Type");var s=h.getResponseHeader("Last-Modified");var a=h.getResponseHeader("ETag");k.lastModified=s?s:(this.lastModifiedHeader?this.lastModifiedHeader+"":undefined);k.etag=a?a:(this.etagHeader?this.etagHeader+"":undefined);if(k.error){}else{if(h.status==200){var l=g;var d;var t=new feedbro.XmlDocumentWrapper();try{if(r!=true&&h.responseXML instanceof XMLDocument){d=h.responseXML;t.setDocument(h.responseXML)}else{d=this.textToXml(t,l)}if(d==undefined){k.error={};k.error.message="Invalid XML";k.error.code=601;k.error.url=e+"";k.status=601;f(k);this.cutObjectLinks();return}}catch(j){k.error={};k.error.message="Invalid XML";k.error.code=601;k.error.url=e+"";k.status=601;f(k);this.cutObjectLinks();return}try{this.handleLoadFeedData(k,e,t,h,f)}catch(n){k.error={};k.error.message="Invalid Feed";k.error.url=e+"";k.error.code=601;k.status=601}}else{if(h.status==404){k.error={};k.error.message="Feed does not exist";k.error.code=404}else{if(h.status==403){k.error={};k.error.message=h.statusText+"";k.error.code=403}else{if(k.error&&k.error.code==398){this.debug("398 Network Down for "+this.url)}else{if(h.status==0){k.error={};k.error.message="Site did not respond within timeout: "+this.timeout+" ms";k.error.code=399;k.status=399}else{if(h.status==304){this.debug("304 Not Modified "+this.url)}else{k.error={};k.error.message="Unable to read feed: "+e;k.error.code=(h.status+0)}}}}}}}if(k.feed&&k.feed.entries&&k.feed.entries.length>0){var b=new Date().getTime();var o,m;try{k.feed.latestItemAge=915360000000;for(o=0;o<k.feed.entries.length;o++){m=b-k.feed.entries[o].publishedDate.getTime();if(m<k.feed.latestItemAge){k.feed.latestItemAge=m;k.feed.latestitemdate=new Date(k.feed.entries[o].publishedDate.getTime())}}}catch(q){}}if(k.error){k.error.url=e+""}if(this.fullFeed&&k.feed&&k.feed.entries&&k.feed.entries.length>0){var c=new feedbro.ClearBody();c.setAddMetaImage(this.addmetaimageMode?true:false);c.setTimeout(this.timeout+45000);this.cutObjectLinks();c.loadFeedEntries(k.feed.entries,function(){f(k)})}else{this.cutObjectLinks();setTimeout(function(){h.onerror=null;h=null;f(k)},100)}};feedbro.FeedParser.prototype.cutObjectLinks=function(){this.dbIndex=undefined;this.lastModifiedHeader=undefined;this.etagHeader=undefined;this.username=undefined;this.password=undefined;this.plugins=undefined;this.url=undefined;this.maxEntries=undefined;this.generateHashes=undefined;this.timeout=30000;this.datelimit=undefined;this.fullFeed=false;this.linkConverter=undefined;this._strings=undefined};feedbro.FeedParser.prototype.identifyFeed=function(b){var c,a={type:"unknown",version:"0.0"};if(b==undefined){return a}try{c=b.getChild("atom:feed");if(c){a.type="atom";a.version="1.0";a.title=b.getChildString("atom:title",c);if(a.title==undefined||a.title==""){a.title="Untitled feed"}return a}c=b.getChild("rss");if(c){a.type="rss";a.version=c.getAttribute("version")+"";a.title=b.getChildString("channel/title",c);if(a.title==undefined||a.title==""){a.title="Untitled feed"}return a}c=b.getChild("rdf:RDF");if(c){a.type="rdf";if(c.getAttribute("xmlns")=="http://my.netscape.com/rdf/simple/0.9/"){a.version="0.9";a.title=b.getChildString("rss09:channel/rss09:title",c)}else{a.version="1.0";a.title=b.getChildString("rss10:channel/rss10:title",c)}if(a.title==undefined||a.title==""){a.title="Untitled feed"}return a}c=b.getChild("atom03:feed");if(c){a.type="atom";a.version="0.3";a.title=b.getChildString("atom03:title",c);if(a.title==undefined){a.title="Untitled feed"}return a}}catch(d){this.debug("identifyFeed: "+d+" url: "+this.url)}return a};feedbro.FeedParser.prototype.createBase=function(c,b,a){if(b==undefined&&a==undefined){return undefined}a=this.getBase(a);if(b==undefined){b=this.getBase(c)}if(b!=undefined&&b.length>0&&b.charAt(b.length-1)!="/"){b=b+"/"}if(a!=undefined&&a.length>0){if(a.charAt(0)=="/"){return this.getProtocol(b)+"://"+this.getServer(b)+a}else{if(a.indexOf("://")==-1){if(a.charAt(0)=="#"||a.charAt(0)=="?"){return b.substring(0,b.length-1)+a}else{return b+a}}else{if(a.indexOf("://")!=-1){return a}}}}return b};feedbro.FeedParser.prototype.getBase=function(e){if(e==undefined){return undefined}var d=e.indexOf("://");var c=e.lastIndexOf("/");if(d!=-1&&c>(d+3)){return e.substring(0,c+1)}else{if(e.charAt(e.length-1)!="/"){return e+"/"}else{return e}}};feedbro.FeedParser.prototype.fixContent=function(c,b,d){if(b.content==undefined){b.content="";return}if(c==undefined){return}var a=c.getAttribute("xml:base");if(a!=undefined){b.content=this.convertRelativeLinks(b.content,this.createBase(this.url,d,a),this.url)}else{if(d!=undefined){b.content=this.convertRelativeLinks(b.content,d,this.url)}else{b.content=this.convertRelativeLinks(b.content,undefined,this.url)}}};feedbro.FeedParser.prototype.convertRelativeLinks=function(b,g,d){var f=this.getProtocol(d);var c=this.getServer(d);var e=this.getBase(d);var a=this;this.linkConverter.lastIndex=0;return b.replace(this.linkConverter,function(o,n,k,j,i){var h=n;var p=k;var q=j;var m=i;var r="<"+h+" "+p+'="';var l='"'+m+">";if(q.length>2&&q.charAt(0)=="/"&&q.charAt(1)=="/"){return r+f+":"+q+l}if(q.length>0&&q.charAt(0)=="/"){if(g!=undefined){return r+a.getProtocol(g)+"://"+a.getServer(g)+q+l}else{return r+f+"://"+c+q+l}}else{if(g!=undefined){if(q.length>0&&g.length>0&&(q.charAt(0)=="#"||q.charAt(0)=="?")){return r+g.substring(0,g.length-1)+q+l}else{return r+g+q+l}}else{return r+e+q+l}}})};feedbro.FeedParser.prototype.toAbsoluteUrl=function(a,b){if(a!=undefined&&a.indexOf("magnet:")==0){return a}if(a!=undefined&&a.indexOf("//")==0){return"http:"+a}else{if(a!=undefined&&a.length>0&&a.indexOf("://")==-1){a=a.trim();if(b==undefined||b.length==0){if(a.charAt(0)=="/"){return this.getProtocol(this.url)+"://"+this.getServer(this.url)+a}else{return this.getBase(this.url)+a}}else{if(b.charAt(b.length-1)!="/"){b=this.getBase(b)}if(a.charAt(0)=="/"){a=a.substring(1)}return b+a}}}return a};feedbro.FeedParser.prototype.getServer=function(e){var d=e.indexOf("://");if(d<0){d=0}else{d=d+3}var c=e.indexOf("/",d);if(c<0){c=e.length}return e.substring(d,c)};feedbro.FeedParser.prototype.getProtocol=function(a){if(!a){return"http"}var b=a.indexOf(":");return b>0?a.substring(0,b):"http"};feedbro.FeedParser.prototype.decodeFeedCharacters=function(b){try{if(b.error){return}var d,e,a=b.feed.entries;for(d=0;d<a.length;d++){e=a[d];e.title=this._strings.decodeHtmlEntities(e.title);e.author=this._strings.decodeHtmlEntities(e.author);e.content=this._strings.decodeHtmlEntities(e.content);e.decoded=1}}catch(c){this.debug("decodeFeedCharacters failed for feed: "+b.feed.title+" error: "+c)}};feedbro.FeedParser.prototype.textToXml=function(k,g){var h;try{h=k.parse(g);return h}catch(c){try{var b="    ";if(g.indexOf("<feed")!=-1){b="\n<!DOCTYPE feed ["+feedbro.FeedParser.ENTITIES+"]>\n"}else{if(g.indexOf("<rss")!=-1){b="\n<!DOCTYPE rss ["+feedbro.FeedParser.ENTITIES+"]>\n"}else{if(g.indexOf("<rdf:RDF")!=-1){b="\n<!DOCTYPE rdf:RDF ["+feedbro.FeedParser.ENTITIES+"]>\n"}}}var j=g.indexOf(">");g=g.substring(0,j+1)+b+g.substring(j+1);h=k.parse(g);return h}catch(e){try{var i=g.indexOf("<?xml");var f=g.indexOf("?>");if(i!=-1&&i!=0&&f>i){var a=g.substring(i,f+2);g=a+"\n"+g.substring(f+2)}g=g.replace(/[\x01-\x08\x0B-\x0C\x0E-\x1F\x7F-\x84\x86-\x9F]/g,"");h=k.parse(g);return h}catch(d){return undefined}}}};feedbro.FeedParser.prototype.adjustCharset=function(c,b){try{var d=this.getCharset(b);if(d&&d!=""){c.overrideMimeType("application/xml; charset="+d)}}catch(a){this.debug("adjustCharset error: "+a)}};feedbro.FeedParser.prototype.getCharset=function(e){var d=e.indexOf("charset=");if(d==-1){return undefined}var c=e.indexOf("&",d);if(c==-1){c=e.length}return e.substring(d+8,c)};feedbro.FeedParser.prototype.findFeeds=function(g){this.processUrl();var e,f,c=this;var b={},a=[],d=false;for(e=0;e<c.plugins.length;e++){f=c.plugins[e];if(f.canParse(c.url)){d=true;f.parse({url:c.url,username:c.username,password:c.password},function(k,n,j,i,o){if(n.status==200){var m=new feedbro.XmlDocumentWrapper();var h=c.textToXml(m,j);var l=c.identifyFeed(m);if(l.type!="unknown"){a.push({type:l.type,href:k,title:l.title})}n.onreadystatechange=null;n.onerror=null;n.abort=null;n=null;o(a)}else{n.onreadystatechange=null;n.onerror=null;n.abort=null;n=null;o(a)}},b,g);break}}if(!d){this.findFeedsDefault(g)}};feedbro.FeedParser.prototype.findFeedsDefault=function(k){var o=[];var l=new XMLHttpRequest();var n=this;var g=n.url;try{if(n.url.indexOf("youtube.com/channel/")!=-1){var d=n.url;var c=d.indexOf("youtube.com/channel/");c+="youtube.com/channel/".length;var a=d.indexOf("/",c+1);if(a==-1){a=d.length}var j=d.substring(c,a);n.url="https://www.youtube.com/feeds/videos.xml?channel_id="+j}else{if(n.url.indexOf("https://www.youtube.com/playlist?list=")==0){n.url="https://www.youtube.com/feeds/videos.xml?playlist_id="+n.url.substring(38)}else{if(n.url.indexOf("https://www.reddit.com/")==0&&n.url.indexOf(".rss")!=(n.url.length-4)){n.url=n.url+".rss"}}}}catch(h){this.debug("Failed to modify URL to find Youtube feed")}try{if(n.url.indexOf("https://vimeo.com/")==0&&n.url.indexOf("rss")==-1){n.url=n.url+"/videos/rss"}}catch(h){this.debug("Failed to modify URL to find Vimeo feed")}try{if(n.url.indexOf("https://www.deviantart.com/")==0){n.url="https://backend.deviantart.com/rss.xml?type=deviation&q=by%3A"+n.url.substring(27)+"+sort%3Atime+meta%3Aall"}}catch(h){this.debug("Failed to modify URL to find DeviantArt feed")}try{if(n.url.indexOf("behance.net/")!=-1){var b=n.url.match(/behance.net\/([A-z0-9_-]+)$/);if(b!=null){n.url="https://www.behance.net/feeds/user?username="+b[1]}}}catch(h){this.debug("Failed to modify URL to find Behance feed")}try{if(n.url.indexOf("pinterest.com/")!=-1&&n.url.indexOf(".rss")==-1){var e=n.url.substring(8).split("/");if(e.length>1&&e[e.length-1]==""){e.pop()}if(e.length==2){n.url="https://"+e.join("/")+"/feed.rss"}if(e.length==3){n.url="https://"+e.join("/")+".rss"}}}catch(h){this.debug("Failed to modify URL to find Pinterest feed")}try{if(n.url.indexOf("https://medium.com/@")==0){var f=n.url.indexOf("/",n.url.indexOf("@"));n.url=n.url.substring(0,f>0?f:n.url.length());n.url=n.url.replace("medium.com/@","medium.com/feed/@")}}catch(h){this.debug("Failed to modify URL to find Medium feed")}l.onreadystatechange=function(w){var t=w.target;if(t.readyState==4){t.onreadystatechange=null;var r=new feedbro.Strings();if(t.status==200){var q=t.responseText;try{if(t.responseURL&&t.responseURL.indexOf("https://www.youtube.com/c/")==0){n.scanYouTubeProfile(r,q,o)}else{if(t.responseURL&&t.responseURL.indexOf("https://www.bitchute.com/channel/")==0){n.scanBitchuteProfile(r,q,o)}else{var u=new feedbro.XmlDocumentWrapper();var y=n.textToXml(u,q);var v=n.identifyFeed(u);if(v.type!="unknown"){o.push({type:v.type,href:n.url,title:v.title})}}}}catch(m){}if(o.length<1){n.getFeedList(q,o)}if(o.length<1&&g.indexOf("youtube.com/")!=-1){var i={stag:["videos.xml?channel_id="],etag:'"'};r.findNext(q,i);if(i.match){var p=i.match;i.stag=['<meta property="og:title" content="'];i.spos=0;r.findNext(q,i);var s="Youtube Feed";if(i.match){s=i.match}o.push({type:"atom",href:"https://www.youtube.com/feeds/videos.xml?channel_id="+p,title:s})}}}if(o.length<1&&!r.endsWith(n.url,"/feed")){n.url=n.url+"/feed";n.findFeedsDefault(k)}else{k(o)}}};l.withCredentials=true;try{l.open("GET",this.url,true)}catch(h){k(o);return}l.timeout=this.timeout;if(this.username&&this.password){l.setRequestHeader("Authorization","Basic "+btoa(this.username+":"+this.password))}l.setRequestHeader("If-Modified-Since","Sat, 01 Jan 2000 00:00:00 GMT");l.send()};feedbro.FeedParser.prototype.scanBitchuteProfile=function(b,e,a){var d;var c={stag:['<p class="creator">',"<a",">"],etag:"</a>"};b.findNext(e,c);if(c.match){d=c.match+""}if(d){a.push({type:"rss",href:"https://www.bitchute.com/feeds/rss/channel/"+d,title:d+" | BitChute"})}};feedbro.FeedParser.prototype.scanYouTubeProfile=function(b,f,a){var e,d;var c={stag:['<meta name="title" content="'],etag:'"'};b.findNext(f,c);if(c.match){e=c.match+""}c.spos=0;c.stag=['<meta itemprop="channelId" content="'];b.findNext(f,c);if(c.match){d=c.match+""}if(e&&d){a.push({type:"atom",href:"https://www.youtube.com/feeds/videos.xml?channel_id="+d,title:e+" | YouTube"})}};feedbro.FeedParser.prototype.processUrl=function(){if(this.url.indexOf("://")==-1){this.url="http://"+this.url}var e=this.getServer(this.url);var a=e.indexOf("@");if(a<0){return}var d=e.split("@");var c=d[0];this.url=this.url.replace(c+"@","");var b=c.split(":");if(b.length==2){this.setAuthentication(b[0],b[1])}};feedbro.FeedParser.ENTITIES='<!ENTITY nbsp "&#160;"> <!ENTITY iexcl "&#161;"> <!ENTITY cent "&#162;"> <!ENTITY pound "&#163;"> <!ENTITY curren "&#164;"> <!ENTITY yen "&#165;"> <!ENTITY brvbar "&#166;"> <!ENTITY sect "&#167;"> <!ENTITY uml "&#168;"> <!ENTITY copy "&#169;"> <!ENTITY ordf "&#170;"> <!ENTITY laquo "&#171;"> <!ENTITY not "&#172;"> <!ENTITY shy "&#173;"> <!ENTITY reg "&#174;"> <!ENTITY macr "&#175;"> <!ENTITY deg "&#176;"> <!ENTITY plusmn "&#177;"> <!ENTITY sup2 "&#178;"> <!ENTITY sup3 "&#179;"> <!ENTITY acute "&#180;"> <!ENTITY micro "&#181;"> <!ENTITY para "&#182;"> <!ENTITY middot "&#183;"> <!ENTITY cedil "&#184;"> <!ENTITY sup1 "&#185;"> <!ENTITY ordm "&#186;"> <!ENTITY raquo "&#187;"> <!ENTITY frac14 "&#188;"> <!ENTITY frac12 "&#189;"> <!ENTITY frac34 "&#190;"> <!ENTITY iquest "&#191;"> <!ENTITY Agrave "&#192;"> <!ENTITY Aacute "&#193;"> <!ENTITY Acirc "&#194;"> <!ENTITY Atilde "&#195;"> <!ENTITY Auml "&#196;"> <!ENTITY Aring "&#197;"> <!ENTITY AElig "&#198;"> <!ENTITY Ccedil "&#199;"> <!ENTITY Egrave "&#200;"> <!ENTITY Eacute "&#201;"> <!ENTITY Ecirc "&#202;"> <!ENTITY Euml "&#203;"> <!ENTITY Igrave "&#204;"> <!ENTITY Iacute "&#205;"> <!ENTITY Icirc "&#206;"> <!ENTITY Iuml "&#207;"> <!ENTITY ETH "&#208;"> <!ENTITY Ntilde "&#209;"> <!ENTITY Ograve "&#210;"> <!ENTITY Oacute "&#211;"> <!ENTITY Ocirc "&#212;"> <!ENTITY Otilde "&#213;"> <!ENTITY Ouml "&#214;"> <!ENTITY times "&#215;"> <!ENTITY Oslash "&#216;"> <!ENTITY Ugrave "&#217;"> <!ENTITY Uacute "&#218;"> <!ENTITY Ucirc "&#219;"> <!ENTITY Uuml "&#220;"> <!ENTITY Yacute "&#221;"> <!ENTITY THORN "&#222;"> <!ENTITY szlig "&#223;"> <!ENTITY agrave "&#224;"> <!ENTITY aacute "&#225;"> <!ENTITY acirc "&#226;"> <!ENTITY atilde "&#227;"> <!ENTITY auml "&#228;"> <!ENTITY aring "&#229;"> <!ENTITY aelig "&#230;"> <!ENTITY ccedil "&#231;"> <!ENTITY egrave "&#232;"> <!ENTITY eacute "&#233;"> <!ENTITY ecirc "&#234;"> <!ENTITY euml "&#235;"> <!ENTITY igrave "&#236;"> <!ENTITY iacute "&#237;"> <!ENTITY icirc "&#238;"> <!ENTITY iuml "&#239;"> <!ENTITY eth "&#240;"> <!ENTITY ntilde "&#241;"> <!ENTITY ograve "&#242;"> <!ENTITY oacute "&#243;"> <!ENTITY ocirc "&#244;"> <!ENTITY otilde "&#245;"> <!ENTITY ouml "&#246;"> <!ENTITY divide "&#247;"> <!ENTITY oslash "&#248;"> <!ENTITY ugrave "&#249;"> <!ENTITY uacute "&#250;"> <!ENTITY ucirc "&#251;"> <!ENTITY uuml "&#252;"> <!ENTITY yacute "&#253;"> <!ENTITY thorn "&#254;"> <!ENTITY yuml "&#255;"> <!ENTITY quot "&#34;"> <!ENTITY amp "&#38;#38;"> <!ENTITY lt "&#38;#60;"> <!ENTITY gt "&#62;"> <!ENTITY apos "&#39;"> <!ENTITY OElig "&#338;"> <!ENTITY oelig "&#339;"> <!ENTITY Scaron "&#352;"> <!ENTITY scaron "&#353;"> <!ENTITY Yuml "&#376;"> <!ENTITY circ "&#710;"> <!ENTITY tilde "&#732;"> <!ENTITY ensp "&#8194;"> <!ENTITY emsp "&#8195;"> <!ENTITY thinsp "&#8201;"> <!ENTITY zwnj "&#8204;"> <!ENTITY zwj "&#8205;"> <!ENTITY lrm "&#8206;"> <!ENTITY rlm "&#8207;"> <!ENTITY ndash "&#8211;"> <!ENTITY mdash "&#8212;"> <!ENTITY lsquo "&#8216;"> <!ENTITY rsquo "&#8217;"> <!ENTITY sbquo "&#8218;"> <!ENTITY ldquo "&#8220;"> <!ENTITY rdquo "&#8221;"> <!ENTITY bdquo "&#8222;"> <!ENTITY dagger "&#8224;"> <!ENTITY Dagger "&#8225;"> <!ENTITY permil "&#8240;"> <!ENTITY lsaquo "&#8249;"> <!ENTITY rsaquo "&#8250;"> <!ENTITY euro "&#8364;"> <!ENTITY fnof "&#402;"> <!ENTITY Alpha "&#913;"> <!ENTITY Beta "&#914;"> <!ENTITY Gamma "&#915;"> <!ENTITY Delta "&#916;"> <!ENTITY Epsilon "&#917;"> <!ENTITY Zeta "&#918;"> <!ENTITY Eta "&#919;"> <!ENTITY Theta "&#920;"> <!ENTITY Iota "&#921;"> <!ENTITY Kappa "&#922;"> <!ENTITY Lambda "&#923;"> <!ENTITY Mu "&#924;"> <!ENTITY Nu "&#925;"> <!ENTITY Xi "&#926;"> <!ENTITY Omicron "&#927;"> <!ENTITY Pi "&#928;"> <!ENTITY Rho "&#929;"> <!ENTITY Sigma "&#931;"> <!ENTITY Tau "&#932;"> <!ENTITY Upsilon "&#933;"> <!ENTITY Phi "&#934;"> <!ENTITY Chi "&#935;"> <!ENTITY Psi "&#936;"> <!ENTITY Omega "&#937;"> <!ENTITY alpha "&#945;"> <!ENTITY beta "&#946;"> <!ENTITY gamma "&#947;"> <!ENTITY delta "&#948;"> <!ENTITY epsilon "&#949;"> <!ENTITY zeta "&#950;"> <!ENTITY eta "&#951;"> <!ENTITY theta "&#952;"> <!ENTITY iota "&#953;"> <!ENTITY kappa "&#954;"> <!ENTITY lambda "&#955;"> <!ENTITY mu "&#956;"> <!ENTITY nu "&#957;"> <!ENTITY xi "&#958;"> <!ENTITY omicron "&#959;"> <!ENTITY pi "&#960;"> <!ENTITY rho "&#961;"> <!ENTITY sigmaf "&#962;"> <!ENTITY sigma "&#963;"> <!ENTITY tau "&#964;"> <!ENTITY upsilon "&#965;"> <!ENTITY phi "&#966;"> <!ENTITY chi "&#967;"> <!ENTITY psi "&#968;"> <!ENTITY omega "&#969;"> <!ENTITY thetasym "&#977;"> <!ENTITY upsih "&#978;"> <!ENTITY piv "&#982;"> <!ENTITY bull "&#8226;"> <!ENTITY hellip "&#8230;"> <!ENTITY prime "&#8242;"> <!ENTITY Prime "&#8243;"> <!ENTITY oline "&#8254;"> <!ENTITY frasl "&#8260;"> <!ENTITY weierp "&#8472;"> <!ENTITY image "&#8465;"> <!ENTITY real "&#8476;"> <!ENTITY trade "&#8482;"> <!ENTITY alefsym "&#8501;"> <!ENTITY larr "&#8592;"> <!ENTITY uarr "&#8593;"> <!ENTITY rarr "&#8594;"> <!ENTITY darr "&#8595;"> <!ENTITY harr "&#8596;"> <!ENTITY crarr "&#8629;"> <!ENTITY lArr "&#8656;"> <!ENTITY uArr "&#8657;"> <!ENTITY rArr "&#8658;"> <!ENTITY dArr "&#8659;"> <!ENTITY hArr "&#8660;"> <!ENTITY forall "&#8704;"> <!ENTITY part "&#8706;"> <!ENTITY exist "&#8707;"> <!ENTITY empty "&#8709;"> <!ENTITY nabla "&#8711;"> <!ENTITY isin "&#8712;"> <!ENTITY notin "&#8713;"> <!ENTITY ni "&#8715;"> <!ENTITY prod "&#8719;"> <!ENTITY sum "&#8721;"> <!ENTITY minus "&#8722;"> <!ENTITY lowast "&#8727;"> <!ENTITY radic "&#8730;"> <!ENTITY prop "&#8733;"> <!ENTITY infin "&#8734;"> <!ENTITY ang "&#8736;"> <!ENTITY and "&#8743;"> <!ENTITY or "&#8744;"> <!ENTITY cap "&#8745;"> <!ENTITY cup "&#8746;"> <!ENTITY int "&#8747;"> <!ENTITY there4 "&#8756;"> <!ENTITY sim "&#8764;"> <!ENTITY cong "&#8773;"> <!ENTITY asymp "&#8776;"> <!ENTITY ne "&#8800;"> <!ENTITY equiv "&#8801;"> <!ENTITY le "&#8804;"> <!ENTITY ge "&#8805;"> <!ENTITY sub "&#8834;"> <!ENTITY sup "&#8835;"> <!ENTITY nsub "&#8836;"> <!ENTITY sube "&#8838;"> <!ENTITY supe "&#8839;"> <!ENTITY oplus "&#8853;"> <!ENTITY otimes "&#8855;"> <!ENTITY perp "&#8869;"> <!ENTITY sdot "&#8901;"> <!ENTITY lceil "&#8968;"> <!ENTITY rceil "&#8969;"> <!ENTITY lfloor "&#8970;"> <!ENTITY rfloor "&#8971;"> <!ENTITY lang "&#9001;"> <!ENTITY rang "&#9002;"> <!ENTITY loz "&#9674;"> <!ENTITY spades "&#9824;"> <!ENTITY clubs "&#9827;"> <!ENTITY hearts "&#9829;"> <!ENTITY diams "&#9830;">';var feedbro=feedbro||{};feedbro.FeedTreeNode=function(){this.children=[];this.parent=undefined;this.data=undefined};feedbro.FeedTree=function(){var l={};var k=new feedbro.FeedTreeNode();var h=1;function o(s,r,t){if(!s){s=k}if(!t){t=1}var q=s.children;for(var p=0;p<q.length;p++){r(q[p],t);o(q[p],r,t+1)}}function f(r){var q=k.children;for(var p=0;p<q.length;p++){r(q[p])}}function n(q){var r=i(l);for(var p=0;p<r.length;p++){q(l[r[p]])}}function a(t,r){var p=[];p.push(t);while(p.length>0){var s=p.shift();if(s.parent){r(s)}for(var q=0;q<s.children.length;q++){p.push(s.children[q])}}}function b(t,r){var p=[];var u=[];var s,q;p.push(t);while(p.length>0){s=p.shift();if(s.parent){u.push(s)}for(q=0;q<s.children.length;q++){p.push(s.children[q])}}while(u.length>0){s=u.pop();r(s)}}this.toJson=function(p){return JSON.stringify(this.getData(p))};this.fromJson=function(p){this.load(JSON.parse(p))};this.getData=function(t,r){var p;if(r!=undefined){p=r}else{p=[]}if(!t){t=k}var s;if(t.parent){s=d(t);p.push(s)}for(var q=0;q<t.children.length;q++){this.getData(t.children[q],t.parent?s.children:p)}return p};function d(t){var s={};var r=i(t.data);for(var p=0;p<r.length;p++){var q=r[p];s[q]=t.data[q]}s.children=[];return s}this.load=function(s,q){var p;if(!q){q=k}for(p=0;p<q.children.length;p++){this.deleteNode(q.children[p])}for(p=0;p<s.length;p++){var t=s[p];var r=this.addNode(t,q,feedbro.FeedTree.INSIDE_LAST);if(t.children){this.load(t.children,r)}}};this.getRoot=function(){return k};this.getNode=function(p){return l[p]};this.getNodeSibling=function(t,s){var r=l[t];var p;if(!r){return r}if(s==feedbro.FeedTree.AFTER){if(r.children.length>0&&r.data.is_open){return r.children[0]}else{p=j(r.parent.children,r);if(p==(r.parent.children.length-1)){if(r.parent.parent){return e(r.parent)}else{return e(r)}}else{if(r.parent.children.length>1){return r.parent.children[p+1]}else{return null}}}}else{if(s==feedbro.FeedTree.BEFORE){p=j(r.parent.children,r);if(p>0){var q=r.parent.children[p-1];if(q.children.length>0&&q.data.is_open){return q.children[q.children.length-1]}else{return q}}else{if(p==0){if(r.parent.parent){return r.parent}else{return null}}else{return null}}}else{c("getNodeSibling: Unidentified direction: "+s);return null}}};function e(q){var p=q.parent.children;var r=j(p,q);return(r+1<p.length)?p[r+1]:null}this.searchNodes=function(p){var x=i(l);var t=i(p);var r=[];for(var s=0;s<x.length;s++){var w=x[s];var u=l[w].data;var q;for(q=0;q<t.length;q++){var v=t[q];if(p[v]!=u[v]){break}}if(q==t.length){r.push(l[w])}}return r};function i(r){var q=[];for(var p in r){if(r.hasOwnProperty(p)){q.push(p)}}return q}this.addNode=function(r,s,p){if(!p||s===k){p=feedbro.FeedTree.INSIDE_LAST}if(!s){s=k}var q=new feedbro.FeedTreeNode();q.data=r;if(!r.id){q.data.id=h++}else{if(r.id>=h){h=r.id+1}}m(q,s,p);l[q.data.id]=q;return q};this.deleteNode=function(q){if(!q.parent){c("Root cannot be deleted");return false}g(q.parent,q);delete l[q.data.id];for(var p=0;p<q.children.length;p++){this.deleteNode(q.children[p])}return true};this.moveNode=function(q,r,p){if(!q.parent){c("Root cannot be moved");return false}if(!p){p=feedbro.FeedTree.INSIDE_LAST}g(q.parent,q);m(q,r,p);return q};this.sortChildren=function(r){var q=this.getNode(r);if(!q){return false}var p=q.children;if(p){p.sort(function(v,t){var u=(v.data.name||"").toLowerCase();var s=(t.data.name||"").toLowerCase();if(u<s){return -1}if(u>s){return 1}return 0})}return true};function m(q,r,p){var s;if(p==feedbro.FeedTree.INSIDE_FIRST){r.children.unshift(q);q.parent=r}else{if(p==feedbro.FeedTree.INSIDE_LAST){r.children.push(q);q.parent=r}else{if(p==feedbro.FeedTree.BEFORE){s=j(r.parent.children,r);r.parent.children.splice(s,0,q);q.parent=r.parent}else{if(p==feedbro.FeedTree.AFTER){s=j(r.parent.children,r);r.parent.children.splice(s+1,0,q);q.parent=r.parent}else{c("addNodePosition: Unidentified node position: "+p)}}}}}function g(p,q){var r=j(p.children,q);p.children.splice(r,1)}function j(q,r){var p;for(p=0;p<q.length;p++){if(q[p].data.id==r.data.id){return p}}return -1}function c(p){feedbro.log("FeedTree: "+p)}this.processNodes=function(q,p,r){if(!r){r=feedbro.FeedTree.MODE_BOTTOMUP}if(r==feedbro.FeedTree.MODE_BOTTOMUP){b(q,p)}else{if(r==feedbro.FeedTree.MODE_TOPDOWN){a(q,p)}else{if(r==feedbro.FeedTree.MODE_TOPNODES){f(p)}else{if(r==feedbro.FeedTree.MODE_DEPTHFIRST){o(q,p)}else{n(p)}}}}}};feedbro.FeedTree.BEFORE=1;feedbro.FeedTree.AFTER=2;feedbro.FeedTree.INSIDE_FIRST=3;feedbro.FeedTree.INSIDE_LAST=4;feedbro.FeedTree.MODE_BOTTOMUP=1;feedbro.FeedTree.MODE_TOPDOWN=2;feedbro.FeedTree.MODE_RANDOM=3;feedbro.FeedTree.MODE_TOPNODES=4;feedbro.FeedTree.MODE_DEPTHFIRST=5;feedbro.FeedTree.FEED=1;feedbro.FeedTree.FOLDER=2;var feedbro=feedbro||{};feedbro.InPlugin=function(){this._strings=new feedbro.Strings();this.userregexp=/@([a-zA-Z0-9_\.]+)/g;this.hashregexp=/#+([a-zA-Z0-9_]+)/g};feedbro.InPlugin.prototype.canParse=function(a){return a&&a.indexOf("https://www.instagram.com")==0};feedbro.InPlugin.prototype.parse=function(a,g,i,e){var h=this;var f=new feedbro.FetchWrapper(200);var b;try{if(a.url=="https://www.instagram.com"||a.url=="https://www.instagram.com/"){this.getHomeRSS(function(k){if(k==null){h.fetchFailure(i,f)}g(a.url,f,k?k:"",i,e,true)})}else{if(a.url.indexOf("https://www.instagram.com/explore/tags/")==0){b=a.url.match(/tags\/([^/]+)/);var j=decodeURIComponent(b[1]);this.getHashtagRSS(j,function(k){if(k==null){h.fetchFailure(i,f)}g(a.url,f,k?k:"",i,e,true)})}else{b=a.url.match(/instagram\.com\/([\w\._]+)/);var d=b[1];this.getProfileRSS(d,function(k){if(k==null){h.fetchFailure(i,f)}g(a.url,f,k?k:"",i,e,true)})}}}catch(c){f.status=500;i.error={};i.error.message="Internal Error";i.error.code=500;i.status=500;g(a.url,f,"",i,e,true)}};feedbro.InPlugin.prototype.fetchFailure=function(a,b){a.error={};a.error.message="Network error";a.error.code=398;a.status=398;b.status=500};feedbro.InPlugin.prototype.getHashtagRSS=function(a,c){var b=this;this.loadHashtag(a,function(d){if(d!=null){var e=[];try{var f=JSON.parse(d);if(f.data&&f.data.top){b.parseCategory(f.data.top,e,b)}if(f.data&&f.data.recent){b.parseCategory(f.data.recent,e,b)}}catch(g){}c(feedbro.Strings.toRSS("#"+a+" | Instagram","https://www.instagram.com/explore/tags/"+a,e))}else{c(null)}})};feedbro.InPlugin.prototype.loadHashtag=function(a,b){fetchTimeout("https://i.instagram.com/api/v1/tags/web_info/?tag_name="+encodeURIComponent(a),10000,{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8,fi;q=0.7,de;q=0.6","cache-control":"no-cache",pragma:"no-cache","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-site","x-asbd-id":"198387","x-ig-app-id":"936619743392459"},referrer:"https://www.instagram.com/",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"}).then(function(c){return c.text()}).then(b)["catch"](function(c){b(null)})};feedbro.InPlugin.prototype.parseCategory=function(a,g,k){var e,d,b,f,m,h,c=a.sections;var l=new feedbro.Strings();for(e=0;e<c.length;e++){m=c[e];for(d=0;d<m.layout_content.medias.length;d++){b=m.layout_content.medias[d].media;g.push(k.createEntry(k,b))}}};feedbro.InPlugin.prototype.getCsrfToken=function(a){fetchTimeout("https://www.instagram.com",10000).then(function(b){return b.text()}).then(function(d){var f='csrf_token":"';var c,e=d.indexOf(f);c=d.indexOf('"',e+f.length+1);a(d.substring(e+f.length,c))})["catch"](function(b){a(null)})};feedbro.InPlugin.prototype.createRandomDevice=function(){var d="ABCDEF0123456789";var c,e,b="";var a=[8,4,4,4,12];while(a.length>0){e=a.shift();for(c=0;c<e;c++){b+=d.charAt(this.randomIntFromInterval(0,d.length-1))}if(a.length>0){b+="-"}}return b};feedbro.InPlugin.prototype.randomIntFromInterval=function(b,a){return Math.floor(Math.random()*(a-b+1)+b)};feedbro.InPlugin.prototype.loadHome=function(b){var a=this;this.getCsrfToken(function(c){if(feedbro.InPlugin.deviceId==null){feedbro.InPlugin.deviceId=window.localStorage.getItem("instagram.deviceId");if(feedbro.InPlugin.deviceId==null){feedbro.InPlugin.deviceId=a.createRandomDevice();window.localStorage.setItem("instagram.deviceId",feedbro.InPlugin.deviceId)}}var d=feedbro.InPlugin.deviceId;fetchTimeout("https://i.instagram.com/api/v1/feed/timeline/",10000,{headers:{"accept-language":"en-GB,en-US;q=0.9,en;q=0.8,fi;q=0.7,de;q=0.6","cache-control":"no-cache","content-type":"application/x-www-form-urlencoded",pragma:"no-cache","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-site","x-asbd-id":"198387","x-csrftoken":c,"x-ig-app-id":"936619743392459","x-instagram-ajax":"1005626825"},referrer:"https://www.instagram.com/",referrerPolicy:"strict-origin-when-cross-origin",body:"device_id="+d+"&is_async_ads_rti=0&is_async_ads_double_request=0&rti_delivery_backend=0&is_async_ads_in_headload_enabled=0",method:"POST",mode:"cors",credentials:"include"}).then(function(e){return e.text()}).then(b)["catch"](function(e){b(null)})})};feedbro.InPlugin.prototype.getHomeRSS=function(b){var a=this;this.loadHome(function(c){if(c!=null){var e=[];try{var h=JSON.parse(c);var g,k,d=h.feed_items;for(g=0;g<d.length;g++){k=d[g].media_or_ad;if(k==null){continue}try{e.push(a.createEntry(a,k))}catch(f){}}}catch(j){}b(feedbro.Strings.toRSS("Home | Instagram","https://www.instagram.com",e))}else{b(null)}})};feedbro.InPlugin.prototype.getProfileRSS=function(c,b){var a=this;this.loadProfile(c,function(d){if(d!=null){var j,l,g=[];var f={full_name:"",username:""};try{var h=JSON.parse(d);var e=h.data.user.edge_owner_to_timeline_media.edges;f={full_name:h.data.user.full_name,username:h.data.user.username};for(j=0;j<e.length;j++){l=e[j].node;g.push(a.createEntry(a,l,f))}}catch(k){}b(feedbro.Strings.toRSS(f.full_name+" (@"+f.username+") | Instagram","https://www.instagram.com/"+c,g))}else{b(null)}})};feedbro.InPlugin.prototype.loadProfile=function(b,a){fetchTimeout("https://i.instagram.com/api/v1/users/web_profile_info/?username="+encodeURIComponent(b),10000,{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8,fi;q=0.7,de;q=0.6","cache-control":"no-cache",pragma:"no-cache","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-site","x-asbd-id":"198387","x-ig-app-id":"936619743392459"},referrer:"https://www.instagram.com/",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"}).then(function(c){return c.text()}).then(a)["catch"](function(c){a(null)})};feedbro.InPlugin.prototype.createEntry=function(c,e,b){var d={content:""};var a;d.link="https://www.instagram.com/p/"+(e.shortcode||e.code);d.publishedDate=new Date();d.publishedDate.setTime((e.taken_at_timestamp||e.taken_at)*1000);if(e.owner){d.author=b.full_name+" (@"+b.username+")"}else{if(e.user){d.author=e.user.full_name+" (@"+e.user.username+")"}}d.title=e.title;d.content+='<p><a target="_blank" href="'+d.link+'">';d.content+='<img src="'+d.link+'/media?size=l">';d.content+="</a></p>";if(e.caption){if(e.caption.text){a=e.caption.text}}else{if(e.edge_media_to_caption&&e.edge_media_to_caption.edges&&e.edge_media_to_caption.edges.length>0){a=e.edge_media_to_caption.edges[0].node.text}}if(a){if(a.text){a=a.text}d.title=c._strings.escapeHtml(c._strings.truncate(a,60,"..."));a=a.replace(c.userregexp,c.usernameMapper);a=a.replace(c.hashregexp,c.hashtagMapper);d.content+='<p class="instagram-caption">'+a+"</p>"}return d};feedbro.InPlugin.prototype.usernameMapper=function(a,b){return"<a target='_blank' class='instagram-username' rel='noopener noreferrer' href='https://www.instagram.com/"+b+"'>@"+b+"</a>"};feedbro.InPlugin.prototype.hashtagMapper=function(b,a){return"<a target='_blank' class='instagram-hashtag' rel='noopener noreferrer' href='https://www.instagram.com/explore/tags/"+a+"/'>#"+a+"</a>"};var feedbro=feedbro||{};feedbro.InviewObserver=function(e){var d={};var c=[];function a(f,g){var j,k,m,l;for(j=0;j<f.length;j++){if(f[j].intersectionRatio<1){continue}k=f[j].target;l=k.getAttribute("id");m=d[l];try{g.unobserve(k)}catch(h){feedbro.log("Unable to stop observing element")}if(m){d[l]=null;m(k)}}}this.once=function(f,g){c.push({id:f,callback:g})};this.addEvents=function(){setTimeout(this.processQueue,350)};this.processQueue=function(){var g,h,f;for(g=0;g<c.length;g++){h=c[g];f=document.getElementById(h.id);if(f){d[h.id]=h.callback;b.observe(f)}else{feedbro.log("Failed to add element with ID "+h.id+" to observe list")}}c=[]};this.clear=function(){try{b.disconnect();d={};c=[]}catch(f){}};var b=new IntersectionObserver(a,{root:document.querySelector(e),rootMargin:"0px",threshold:1})};var feedbro=feedbro||{};feedbro.LiPlugin=function(a){this._timeout=15000;this._rootUrl="https://www.linkedin.com";this._strings=new feedbro.Strings();this._debug=false};feedbro.LiPlugin.csrfToken="";feedbro.LiPlugin.lastScan=0;feedbro.LiPlugin.prototype.setDebug=function(a){this._debug=a};feedbro.LiPlugin.prototype.canParse=function(a){return a&&(a.indexOf(this._rootUrl+"/groups/")==0||a.indexOf(this._rootUrl+"/jobs/search/")==0||a.indexOf(this._rootUrl+"/feed/hashtag/")==0||a==(this._rootUrl+"/feed/")||(a.indexOf(this._rootUrl)!=-1&&a.indexOf("/detail/recent-activity/posts/")!=-1))};feedbro.LiPlugin.prototype.initTokens=function(b){var a=new XMLHttpRequest();a.onreadystatechange=function(d){var c=d.target;if(c.readyState==4){c.onreadystatechange=undefined;b()}};a.withCredentials=true;a.open("GET","https://www.linkedin.com/feed/",true);a.timeout=15000;a.send()};feedbro.LiPlugin.prototype.parse=function(e,d,a,f){var c=this;var b=new Date().getTime()-feedbro.LiPlugin.lastScan;if(feedbro.LiPlugin.csrfToken==""||b>(15*60*1000)){this.initTokens(function(){feedbro.LiPlugin.lastScan=new Date().getTime();c.doParse(e,d,a,f)})}else{c.doParse(e,d,a,f)}};feedbro.LiPlugin.prototype.doParse=function(b,h,j,f){var i=this;var g=new XMLHttpRequest();g.onerror=function(){j.error={};j.error.message="Network error";j.error.code=398;j.status=398};g.onreadystatechange=function(l){var k=l.target;if(k.readyState==4){k.onreadystatechange=null;if(k.status!=0){k.onerror=null}var n="";if(k.status==200){try{if(b.url.indexOf("https://www.linkedin.com/jobs/search")==0){n=i.parseJobs(k.responseText,b.url)}else{if(b.url.indexOf("/detail/recent-activity/posts/")!=-1){n=i.parseIndividualArticles(k.responseText,b.url)}else{n=i.parseJson(k.responseText,b.url)}}}catch(m){feedbro.log("LiPlugin error: "+m)}}h(b.url,k,n,j,f,true)}};var e=b.url;var a;try{if(b.url=="https://www.linkedin.com/feed/"){e="https://www.linkedin.com/voyager/api/feed/updatesV2?commentsCount=0&count=20&likesCount=0&moduleKey=home-feed%3Adesktop&q=chronFeed&start=0"}else{if(b.url.indexOf("https://www.linkedin.com/groups/")==0){var c=b.url.match(/groups\/(\d+)/);e="https://www.linkedin.com/voyager/api/groups/updatesV2?count=10&groupId="+c[1]+"&q=groupsFeed&start=0"}else{if(b.url.indexOf("https://www.linkedin.com/jobs/search")==0){a=b.url.substring(b.url.indexOf("=")+1);e="https://www.linkedin.com/voyager/api/search/hits?count=25&decorationId=com.linkedin.voyager.deco.jserp.WebJobSearchHit-22&facetEnabled=false&geoUrn=urn%3Ali%3Afs_geo%3A"+a+"&origin=JOB_SEARCH_RESULTS_PAGE&q=jserpAll&query=search&topNRequestedFlavors=List(HIDDEN_GEM,SALARY,PREFERRED_COMMUTE,IN_NETWORK,SCHOOL_RECRUIT,COMPANY_RECRUIT,JOB_SEEKER_QUALIFIED,PRE_SCREENING_QUESTIONS,SKILL_ASSESSMENTS)"}else{if(b.url.indexOf("https://www.linkedin.com/feed/hashtag/")==0){a=b.url.split("/").pop();if(a.indexOf("?keywords=")==0){a=a.substring(a.indexOf("=")+1);e="https://www.linkedin.com/voyager/api/feed/interestUpdatesV2?count=10&keywords="+a+"&q=interestFeedByKeywords&sortOrder=RELEVANCE&start=0"}else{e="https://www.linkedin.com/voyager/api/feed/interestUpdatesV2?count=10&q=interestFeedByUrn&sortOrder=RELEVANCE&start=0&urn=urn%3Ali%3Ahashtag%3A"+a}}else{if(b.url.indexOf("/detail/recent-activity/posts/")!=-1){a=b.url.match(/in\/(.*?)\/detail\//)[1];e="https://www.linkedin.com/voyager/api/identity/profiles/"+a+"/posts?count=10&start=0"}}}}}}catch(d){feedbro.log("LiPlugin error: "+d,b.url+"")}g.withCredentials=true;g.open("GET",e,true);g.timeout=b.timeout?b.timeout:10000;g.setRequestHeader("Cache-Control","no-cache");g.setRequestHeader("accept","application/vnd.linkedin.normalized+json+2.1");g.setRequestHeader("accept-language","en-GB,en-US;q=0.9,en;q=0.8,fi;q=0.7,de;q=0.6");g.setRequestHeader("csrf-token",feedbro.LiPlugin.csrfToken+"");g.setRequestHeader("pragma","no-cache");g.setRequestHeader("x-li-lang","en_US");g.setRequestHeader("x-restli-protocol-version","2.0.0");g.send()};feedbro.LiPlugin.prototype.getKeywords=function(b){if(b.indexOf("https://www.linkedin.com/feed/hashtag/")!=0){return undefined}try{var c=b.split("/").pop();if(c.indexOf("?keywords=")==0){c=c.substring(c.indexOf("=")+1)}return c}catch(a){return undefined}};feedbro.LiPlugin.prototype.hashtagReplace=function(a){return'<a class="linkedin-hashtag" rel="noopener noreferrer" target="_blank" href="https://www.linkedin.com/feed/hashtag/'+a+'/">#'+a+"</a>"};feedbro.LiPlugin.prototype.parseJobs=function(o,a){var r=JSON.parse(o);var g=r.included,h,f,c,j,q=[];for(f=0;f<g.length;f++){j=g[f];var b={};if(j["$type"]=="com.linkedin.voyager.jobs.JobPosting"){b.publishedDate=new Date(j.listedAt);b.title=j.title;b.content="";b.author="";b.guid=j.entityUrn;var m=j.formattedLocation;var d="";if(j.applyMethod&&j.applyMethod.companyApplyUrl){d=j.applyMethod.companyApplyUrl;b.content+="<div class='linkedin-apply'><a href='"+d+"' target='_blank' rel='noopener noreferrer'>Apply</a></div>"}b.content+="<div class='linkedin-job-location'>"+m+"</div>";var k=j.entityUrn.split(":");b.link=this._rootUrl+"/jobs/view/"+k[3];var n=j.companyDetails.company;var p;var l;for(l=0;l<g.length;l++){h=g[l];if(h["$type"]=="com.linkedin.voyager.organization.Company"&&h.entityUrn==n){p=h.name.trim();b.author=p;b.title=b.title+" | "+p;if(h.logo&&h.logo.image&&h.logo.image.artifacts){b.content+="<img src='"+h.logo.image.rootUrl+h.logo.image.artifacts[0].fileIdentifyingUrlPathSegment+"'>"}break}}c=r.data.metadata.keywords+" Jobs | LinkedIn";q.push(b)}}return feedbro.Strings.toRSS(c,a,q)};feedbro.LiPlugin.prototype.parseIndividualArticles=function(g,a){var j=JSON.parse(g);var d,b,e,f,c;var h=[];for(d=0;d<j.included.length;d++){b=j.included[d];if(b["$type"]=="com.linkedin.voyager.identity.profile.Post"){e={};e.content="";e.publishedDate=new Date(b.postedAt);e.title=b.title;e.author=b.authorComponent.name.text;e.link=b.permaLink;e.guid=b.entityUrn;c=e.author;if(b.image&&b.image.artifacts){f=b.image.rootUrl+b.image.artifacts[0].fileIdentifyingUrlPathSegment;e.content+="<div class='linkedin-article-image'><img src='"+f+"'></div>"}h.push(e)}}return feedbro.Strings.toRSS(c+" | LinkedIn",a,h)};feedbro.LiPlugin.prototype.parseJson=function(l,a){var o=JSON.parse(l);var e={};var c,b,g,f;var n=[];var m="Feed";var k={};var j=new feedbro.Strings();var h=this.getKeywords(a);if(h){m="#"+h}for(f=0;f<o.included.length;f++){c=o.included[f];e[c.entityUrn]=c;if(c["$type"]=="com.linkedin.voyager.identity.shared.MiniProfile"){if(c.picture&&c.picture.artifacts){k[c.entityUrn]=c.picture.rootUrl+c.picture.artifacts[0].fileIdentifyingUrlPathSegment}}else{if(c["$type"]=="com.linkedin.voyager.entities.shared.MiniCompany"){if(c.logo&&c.logo.artifacts){k[c.entityUrn]=c.logo.rootUrl+c.logo.artifacts[0].fileIdentifyingUrlPathSegment}}}}for(f=0;f<o.included.length;f++){c=o.included[f];if(c["$type"]=="com.linkedin.voyager.entities.shared.MiniGroup"){m=c.groupName}else{if(c["$type"]=="com.linkedin.voyager.feed.render.UpdateV2"&&c.commentary!=null&&c.entityUrn.indexOf("RESHARED")==-1){if(c.updateMetadata.trackingData&&c.updateMetadata.trackingData.sponsoredTracking){continue}var d={content:c.commentary.text.text,guid:c.updateMetadata.urn,author:c.actor?c.actor.name.text:"",link:this.findLink(c)};d.content=this.convertBody(d.content);d.content+=this.getArticle(c,j);if(c.content&&c.content["$type"]=="com.linkedin.voyager.feed.render.ImageComponent"&&c.content.images&&c.content.images.length>0){d.content+=this.getImageTag(c.content.images[0])}if(d.author==""&&c.contextualHeader&&c.contextualHeader.subtitle){g=c.contextualHeader.subtitle.text.split(" ");d.author=g[g.length-2]+" "+g[g.length-1]}b=e[c["*resharedUpdate"]];if(b){if(b.commentary){d.content+="<div class='linkedin-shared-post'>"+this.createAuthorHeader(b,k,j)+this.convertBody(b.commentary.text.text)+"</div>"}else{d.content+="<div class='linkedin-shared-post'>"+this.createAuthorHeader(b,k,j)+this.getArticle(b,j)+"</div>"}}j.fixTitle(d);d.content=this.createAuthorHeader(c,k,j)+d.content;n.push(d)}}}if(a=="https://www.linkedin.com/feed/"){m="Feed"}return feedbro.Strings.toRSS(m+" | LinkedIn",a,n)};feedbro.LiPlugin.prototype.findLink=function(b){var a=b.updateMetadata.urn;if(a.substring(0,16)=="urn:li:aggregate"){a=a.substring(18,a.indexOf(","))}return"https://www.linkedin.com/feed/update/"+a};feedbro.LiPlugin.prototype.createAuthorHeader=function(d,b,e){var a="";var c="";if(d.actor&&d.actor.image&&d.actor.image.attributes){c=b[d.actor.image.attributes[0]["*miniProfile"]||d.actor.image.attributes[0]["*miniCompany"]]}if(c==undefined){c=""}else{c="<img class='linkedin-actor-image' src='"+e.escapeHref(c)+"'>"}if(d.actor&&d.actor.navigationContext){a+="<header><div class='linkedin-author-header'>";a+="<a class='linkedin-author-link' target='_blank' rel='noopener noreferrer' href='"+e.escapeHref(d.actor.navigationContext.actionTarget)+"'>";a+="<table class='linkedin-author-table'><tr><td class='linkedin-author-table-column-1'><div class='linkedin-actor-image'>"+c+"</div></td>";a+="<td class='linkedin-author-table-column-2'>";a+="<div class='linkedin-actor-namerow'><span class='linkedin-actor-name'>"+e.escapeHtml(d.actor.name.text)+"</span> <span class='linkedin-actor-order'>"+(d.actor.supplementaryActorInfo?d.actor.supplementaryActorInfo.text:"")+"</span></div>";a+="<div class='linkedin-actor-title'>"+e.escapeHtml(d.actor.description.text)+"</div>";a+="</td></tr></table>";a+="</a>";a+="</div></header>"}return a};feedbro.LiPlugin.prototype.convertBody=function(a){a=feedbro.Strings.linkify(a);a=feedbro.Strings.convertHashtags(a,this.hashtagReplace);return a.replace(/\n/g,"<br>")};feedbro.LiPlugin.prototype.getArticle=function(c,e){if(c.content&&c.content["$type"]=="com.linkedin.voyager.feed.render.ArticleComponent"){var a=this.getImageTag(c.content.largeImage||c.content.smallImage);var d=c.content.title.text;var b=c.content.navigationContext.actionTarget;return"<div class='linkedin-article'><a target='_blank' class='linkedin-article-link' rel='noreferrer noopener' href='"+e.escapeHref(b)+"'>"+a+"<div class='linkedin-article-title'>"+e.escapeHtml(d)+"</div><div class='linkedin-article-subtitle'>"+e.escapeHtml(c.content.subtitle?c.content.subtitle.text:"")+"</div></a></div>"}else{return""}};feedbro.LiPlugin.prototype.getImageTag=function(a){if(a==null||a.attributes==null||a.attributes.length==0){return""}var c,b;if(a.attributes[0].sourceType=="VECTOR"){c=a.attributes[0].vectorImage;b=c.rootUrl+c.artifacts[c.artifacts.length-1].fileIdentifyingUrlPathSegment}else{if(a.attributes[0].sourceType=="URL"){b=a.attributes[0].imageUrl}else{return""}}return"<div class='linkedin-article-image'><img src='"+b+"'></div>"};var feedbro=feedbro||{};feedbro.LiveClick=function(){var d;var k=new feedbro.Strings();var h="div#popuplist";var b="images/";var g=new feedbro.FeedIconManager();this.init=function(){d=Object.assign([],f().getTreeData());g.setSettings(f().getSettings());i()};function f(){return chrome.extension.getBackgroundPage().feedbrobg}function e(m){var o=$(this);var n=parseInt(o.attr("data-id"),10);l(n)}function l(o){var n,m;for(n=0;n<d.length;n++){m=d[n];if(m.type==2&&m.id==o){$(h).html(c(m,m.children));$(h+" .iconBackButton").click(function(){i()});$(h+" div.feed").click(j);window.scrollTo(0,0);break}}}function j(n){var o=$(this);var q=parseInt(o.attr("data-id"),10);var p=o.attr("data-parent-id");var m=f();m.handleMessageEvent({action:"loadsingle",start:0,count:20,unread:1,feedid:q},"bg",function(s){var r=m.getFeedEntries();a(p,r)})}function a(p,s){var o="",u,t;if(s.length>0){o+="<div class='viewHeader'><img class='iconBackButton' src='"+b+"liveclick-backbutton.png'><div class='feedTitle'><img class='feedIcon' src='"+g.getIconFromGoogleCache(s[0].feed.link)+"'>"+k.escapeHtml(s[0].feed.title)+"</div></div>"}else{o+="<div class='viewHeader'><img class='iconBackButton' src='"+b+"liveclick-backbutton.png'><div class='feedTitle'>"+Locale.i18n("mainmenu_liveclick_nounread",true)+"</div></div>"}var r=Locale.i18n("mainmenu_liveclick_authorprefix",true);o+="<div class='entryList'>";for(var n=0;n<s.length;n++){u=s[n];var m=k.isTextRTL(u.title||"",true,100);var q=k.isTextRTL(u.author||"",true,100);k.fixTitle(u);t=k.escapeHtml(u.title);o+="<div class='article'>";o+="<a target='_blank' data-id='"+u.id+"' class='popup-link' href='"+u.link+"' title='"+t+"'>";o+="<div class='articleTitle"+(m?" rtl-layout":"")+"'>"+t+"</div>";o+="<div class='footer'>";o+="  <div class='articleDate' title='"+u.publishedDate+"'>"+k.timeAgo(u.publishedDate,true)+"</div>";o+="  <div class='articleAuthor'>"+(u.author!=""?(r+" <span class='name"+(q?" rtl-layout":"")+"'>"+k.stripTags(u.author)+"</span>"):"")+"</div>";o+="</div>";o+="</a>";o+="</div>"}o+="<div>";$(h).html(o);$(".popup-link").click(function(v){var x=parseInt(v.currentTarget.getAttribute("data-id"),10);var w=f();w.markUnread(x,0);w.updateTotalUnread();v.currentTarget.parentElement.classList.add("read")});if(p==undefined){$(h+" .iconBackButton").click(function(){i()})}else{$(h+" .iconBackButton").click(function(){l(parseInt(p,10))})}window.scrollTo(0,0)}function i(){$(h).html(c({},d));$(h+" div.folder").click(e);$(h+" div.feed").click(j)}function c(w,v){var t,r,x,n,q,p;var s="";var o;s+="<div class='popuptree'>";if(w.type==2){o=k.isTextRTL(w.name||"",true,100);s+="<div class='viewHeader'><img class='iconBackButton' src='"+b+"liveclick-backbutton.png'><div class='feedTitle"+(o?" rtl-layout":"")+"'><img class='folderIcon' src='"+b+"folder-icon.svg'>"+k.escapeHtml(w.name)+"</div></div>"}if(w.type==undefined){s+="<div class='viewHeader'></div>"}var u=0;s+="<div class='entryList'>";for(t=0;t<v.length;t++){x=v[t];if(x.type==2){n=x;q=0;for(r=0;r<n.children.length;r++){p=n.children[r];q+=p.unread}n.unread=q;if(q>0){o=k.isTextRTL(n.name||"",true,100);s+="<div class='folder' data-id='"+n.id+"'><table class='popupEntryTable'><tr><td><div class='popupTreeIcon'><img src='"+b+"folder-icon.svg'></div></td><td><div class='truncate folderName"+(o?" rtl-layout":"")+"'>"+k.escapeHtml(n.name)+"</div></td><td><div class='popupUnread'>"+n.unread+"</div></td></tr></table></div>";u++}}else{if(x.type==1){if(x.unread>0){var m=g.getIconFromGoogleCache(x.htmlUrl);o=k.isTextRTL(x.name||"",true,100);s+="<div class='feed' data-id='"+x.id+"'"+(w.id?" data-parent-id='"+w.id+"'":"")+"><table class='popupEntryTable'><tr><td><div class='popupTreeIcon'><img src='"+m+"'></div></td><td><div class='truncate feedName"+(o?" rtl-layout":"")+"'>"+k.escapeHtml(x.name)+"</div></td><td><div class='popupUnread'>"+x.unread+"</div></td></tr></table></div>";u++}}}}if(u==0){s+="<div class='popupMessage'>"+Locale.i18n("mainmenu_liveclick_nounread",true)+"</div>"}s+="</div>";s+="</div>";return s}};var Locale=Locale||{};Locale.locales=Locale.locales||{};Locale.argumentRE=/\{(\d+)\}/g;Locale.needEscapeCache={};Locale.htmlReplacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};Locale.start=function(){Locale.defaultLocale=Locale.locales.en_US;Locale.activeLocale="en_US";Locale.activeMap=Locale.defaultLocale};Locale.i18n=function(g,f){var a=Locale.activeMap;var d=a?a[g]:undefined;if(d==undefined){console.log("i18n: missing locale translation key: "+g);d=Locale.defaultLocale[g]}if(d==undefined){console.log("i18n: completely missing translation key: "+g);return g}if(arguments&&arguments.length>2){var e=arguments;d=d.replace(Locale.argumentRE,function(h,i){var j=parseInt(i,10);if(j<e.length&&j>0){return e[j+1]}else{return"{"+j+"}"}})}if(f==true){var b=Locale.needEscapeCache[g];var c;if(b==undefined){c=Locale.escape(d);b=(c!=d);Locale.needEscapeCache[g+""]=b;d=c}else{if(b==true||arguments.length>2){d=Locale.escape(d)}}}return d};Locale.escape=function(a){return a.replace(/[<>"']/g,Locale.escapeReplace)};Locale.escapeReplace=function(a){return Locale.htmlReplacements[a]};Locale.selectLocale=function(a){Locale.activeLocale=a;if(a=="default"||Locale.locales[Locale.activeLocale]==undefined){Locale.activeMap=Locale.defaultLocale}else{Locale.activeMap=Locale.locales[Locale.activeLocale]}Locale.needEscapeCache={}};Locale.getActiveMap=function(){return Locale.activeMap};Locale.addLocale=function(a,b){Locale.locales[b]=a;Locale.selectLocale(b)};Locale.install=function(b,c,a,d){Locale.download(b,function(e){Locale.locales[e.meta.locale_type]=e;if(c){Locale.selectLocale(e.meta.locale_type)}a(200)},d)};Locale.deleteLocale=function(a){delete Locale.locales[a]};Locale.download=function(b,a,d){var c=new XMLHttpRequest();c.onreadystatechange=function(f){var e=f.target;if(e.readyState==4){e.onreadystatechange=null;if(e.status==200){try{var h=JSON.parse(e.responseText);if(h.meta&&h.meta.manifest_version&&h.meta.locale_type){a(h)}else{d(600)}}catch(g){d(601+" "+g)}}else{d(e.status+0)}}};c.open("GET",b,true);c.timeout=10000;c.setRequestHeader("Cache-Control","no-cache");c.send()};Locale.translate=function(f,c){var e,d,a,g,b=document.querySelectorAll(f?"[data-i18n]":"[data-i18n]:not(.processed)");if(c==undefined){c=Locale.activeMap}if(b!=undefined){for(e=0;e<b.length;e++){a=b[e];d=a.getAttribute("data-i18n");if(d){g=c[d+"_body"];if(g!=undefined){a.innerHTML=Locale.escape(g)}g=c[d+"_value"];if(g!=undefined){a.setAttribute("value",g)}g=c[d+"_placeholder"];if(g!=undefined){a.setAttribute("placeholder",g)}g=c[d+"_title"];if(g!=undefined){a.setAttribute("title",g)}}a.classList.add("processed")}}};var feedbro=feedbro||{};feedbro.log=function(){if(feedbro.debug){if(arguments.length==1){console.log(arguments[0])}if(arguments.length==2){console.log(arguments[0],arguments[1])}if(arguments.length>=3){console.log(arguments[0],arguments[1],arguments[2])}}};var feedbro=feedbro||{};feedbro.Mainmenu=function(){function e(h,g){chrome.tabs.query({title:h},function(l){var m=false;if(l.length>0){for(var k=0;k<l.length;k++){if(l[k].url&&l[k].url.indexOf("http")==0){continue}chrome.windows.update(l[k].windowId,{focused:true});if(g&&g.indexOf("preview")!=-1){chrome.tabs.update(l[k].id,{active:true,url:g})}else{chrome.tabs.update(l[k].id,{active:true});if(a().getSettings().getIconClickReloads()){a().notifyEngine("updateview",-1,-1)}}try{window.close()}catch(j){}m=true;break}}if(!m){chrome.tabs.create({url:chrome.runtime.getURL(g)},function(n){try{window.close()}catch(i){}})}})}function c(){var j=a().getFolders();var m=a().getLastFolderId();var k=false;var l=new feedbro.Strings();var h,g="<select id='folder' title='"+Locale.i18n("mainmenu_selectfolder_title",true)+"'>";if(j.length>0){for(h=0;h<j.length;h++){if(j[h].id==m){k=true}g+="<option"+(j[h].id==m?" selected='selected'":"")+" value='"+j[h].id+"'>"+l.escapeHtml(j[h].name)+"</option>"}}g+="<option value='-1'"+(!k?" selected='selected'":"")+">"+Locale.i18n("mainmenu_rootfolder",true)+"</option>";g+="</select>";return g}function b(){chrome.tabs.query({currentWindow:true,active:true},function(g){if(g.length>0){d(g[0].url)}})}function d(h){$("div.menuitem").css({cursor:"progress"});try{a().findFeeds(h,undefined,undefined,function(j){$("div.menuitem").css({cursor:"pointer"});if(j.length>0){$("body").css({width:"500px"});$("div#articlelist").css({display:"none"});$("div#articlelistdivider").css({display:"none"});var m,l="<div class='divider'></div><div class='results-area'>";var o=Locale.i18n("mainmenu_input_title",true);var n=Locale.i18n("mainmenu_newtab_title",true);var k=Locale.i18n("mainmenu_preview_title",true);var q=Locale.i18n("mainmenu_edit_title",true);var p=new feedbro.Strings();for(m=0;m<j.length;m++){l+="<div class='discovered-feed-entry'><div class='discovered-feed-entry-left'><input title='"+o+"' type='checkbox' name='feed' "+(j.length==1?"checked='checked'":"")+" value='"+m+"'>";l+="<span class='discovered-feed-type'><a class='discovered-feed-url' title='"+n+"' target='_blank' rel='noopener noreferrer' href='"+j[m].href+"'>"+j[m].type+"</a></span>";l+="<a class='discovered-feed-previewlink' target='_blank' rel='noopener noreferrer' title='"+k+"' href='"+j[m].href+"'>";l+="<img src='images/preview-icon.png' class='previewicon'></a></div>";l+="<div class='discovered-feed-name' id='feedname-"+m+"' contenteditable='true' title='"+q+"'>"+p.escapeHtml(j[m].title)+"</div></div>"}l+='<div class="results-toolbar"><div class="results-label">'+Locale.i18n("mainmenu_addtofolder",true)+'</div><div class="results-folder">';l+=c();l+="</div>";l+='<div class="results-buttons">';l+='<input class="uibutton" type="button" id="subscribe" value="'+Locale.i18n("mainmenu_button_subscribe",true)+'">&nbsp;<input class="uibutton" type="button" id="close" value="'+Locale.i18n("mainmenu_button_close",true)+'">';l+="</div>";l+="</div>";$("div#results").html(l);$("div.discovered-feed-name").keydown(function(i){if(i.keyCode==13){i.preventDefault();$(this).blur();return false}});$("a.discovered-feed-previewlink").click(function(r){var i=$(this).attr("href");e("Feedbro","reader.html?preview="+encodeURIComponent(i));r.preventDefault();return false});$("input#close").click(function(){window.close()});$("input#subscribe").click(function(){var i=$("select#folder > option:selected").attr("value");a().setLastFolderId(i);var r=0,s;$("input:checkbox[name=feed]:checked").each(function(){var u=$(this).val();var x=$("div#feedname-"+u).text();var w=a().getNodesWithUrl(j[u].href);if(w.length>0){var v=w[0];var t;if(v.parent&&v.parent.data&&v.parent.data.type==2){t=v.parent.data.name}if(t){alertify.error(Locale.i18n("mainmenu_error_duplicate_folder",false,x,t,v.data.name))}else{alertify.error(Locale.i18n("mainmenu_error_duplicate",false,x,v.data.name))}}else{r++;s=a().addFeed(j[u].href,x,x,i);a().notifyEngine("addfeed",s,i);a().loadFeedItems(s)}});if(r>0){a().saveData();alertify.set({delay:2000});if(r>1){alertify.success(Locale.i18n("mainmenu_success_addedmultiple",false,r))}else{alertify.success(Locale.i18n("mainmenu_success_addedsingle",false))}}else{alertify.set({delay:2000});alertify.error(Locale.i18n("mainmenu_error_nothing_selected",false))}})}else{alertify.set({delay:2000});alertify.error(Locale.i18n("mainmenu_error_nothing_found",false))}})}catch(g){$("div.menuitem").css({cursor:"pointer"})}}function a(){var g=chrome.extension.getBackgroundPage();return g?g.feedbrobg:null}function f(){$("link#theme").attr("href","styles/theme-"+a().getSettings().getTheme()+".css")}this.customInit=function(){var g=a();if(g==null){$("body").html("<div style='padding: 10px; min-width: 230px; text-align: center'>Not available in Private Browsing Mode</div>");return}f();Locale.start();Locale.activeMap=a().getActiveLocaleMap();Locale.translate(true);alertify.set({labels:{cancel:Locale.i18n("dialog_cancel",false),ok:Locale.i18n("dialog_ok",false)}});$("div#reader").click(function(){e("Feedbro","reader.html")});$("div#findfeeds").click(function(){b()});$("div#options").click(function(){e("Feedbro - Options","options.html")});$("div#explorer").click(function(){$("div#articlelist").css({display:"none"});$("div#menuitems").css({display:"none"});$("div#results").css({display:"none"});$("div#articlelistdivider").css({display:"none"});var i=new feedbro.LiveClick();i.init()});if(a().getSettings().getShowLatestInPopup()){var h=new feedbro.MainmenuPopup();h.showPopupItems("div#articlelist");$("body").css({width:"500px"})}else{$("div#articlelist").css({display:"none"});$("div#articlelistdivider").css({display:"none"})}}};var feedbro=feedbro||{};feedbro.MainmenuPopup=function(){this.showPopupItems=function(e){var b=new Date().getTime();var a=new feedbro.Strings();var f=new feedbro.FeedIconManager();var c=chrome.extension.getBackgroundPage().feedbrobg;var d=c.getSettings();var h=d.getArticleLinkMode();var g="../images";f.setSettings(d);c.handleMessageEvent({action:"loadall",start:0,count:9,maxdate:b,unread:1},"bg",function(m){var t=c.getFeedEntries();var o;var p="",s,q;if(t.length==0){$("div#articlelist").css({display:"none"});$("div#articlelistdivider").css({display:"none"})}var l=Locale.i18n("mainmenu_open_originalarticle",true);var u=Locale.i18n("mainmenu_mark_read",true);var k=Locale.i18n("mainmenu_favorite",true);var r=Locale.i18n("mainmenu_delete",true);for(o=0;o<t.length;o++){a.fixTitle(t[o]);var j=a.isTextRTL(t[o].title,true,100);var n=a.isTextRTL(t[o].feed.title,true,100);if(t[o].starred==1){s="<img title='"+k+"' class='starred' data-id='"+t[o].id+"' src='"+g+"/star-yellow.png'>"}else{s="<img title='"+k+"' data-id='"+t[o].id+"' src='"+g+"/star-grey.png'>"}q="<div class='article-popup-linkhtml'><a class='article-link' data-id='"+t[o].id+"'target='_blank' href='"+t[o].link+"'><img title='"+l+"' data-id='"+t[o].id+"' src='"+g+"/link-icon.png' width='16'></a></div>";p+="<div class='article-popup' data-id='"+t[o].id+"'><table><tr>";p+="<td class='article-meta'><div class='article-popup-title"+(j?" rtl-layout":"")+"'>";p+="<span class='open-article' data-id='"+t[o].id+"'>"+a.escapeHref(a.truncate(a.stripTags(t[o].title),100,"..."))+"</span>";p+="</div>";p+="<div class='article-popup-bottom'>";p+="<div class='article-popup-feedtitle"+(n?" rtl-layout":"")+"'><img class='feedTitleIcon' src='"+f.getIconFromGoogleCache(t[o].link)+"'>"+a.escapeHref(t[o].feed.title)+"</div>";p+="<div class='article-popup-delete'><img title='"+r+"' data-id='"+t[o].id+"' src='"+g+"/trash.png'></div>";p+="<div class='article-popup-star'>"+s+"</div>"+q;p+="<div class='article-popup-markread'><img title='"+u+"' data-id='"+t[o].id+"' src='"+g+"/icon-unread.png'></div>";p+="<div class='article-popup-date'>"+a.timeAgo(t[o].publishedDate.getTime())+"</div>";p+="</div></td></tr></table></div>"}var v=$(p);$(e).html(v);if(h==1){v.find("span.open-article").click(function(){feedbro.Chrome.openTab("Feedbro","reader.html?article="+$(this).data("id"))})}else{v.find("span.open-article").click(function(){$(this).parent().parent().find("a.article-link").get(0).click()})}v.find("div.article-popup-star img").click(function(){var i=$(this);c.toggleItemStarred(i.data("id"));if(i.hasClass("starred")){i.removeClass("starred");i.attr("src",g+"/star-grey.png")}if(!i.hasClass("starred")){i.addClass("starred");i.attr("src",g+"/star-yellow.png")}});v.find("div.article-popup-delete img").click(function(){var i=$(this);var w=parseInt(i.attr("data-id"),10);c.markUnread(w,0);c.markDeleted(w,1);c.updateTotalUnread();$("div.article-popup[data-id='"+w+"']").remove()});v.find("div.article-popup-markread img").click(function(){var i=$(this);var w=parseInt(i.attr("data-id"),10);c.markUnread(w,0);c.updateTotalUnread();$("div.article-popup[data-id='"+w+"']").remove()});v.find("a.article-link").click(function(){var i=parseInt($(this).attr("data-id"),10);c.markUnread(i,0);c.updateTotalUnread()})})}};var feedbro=feedbro||{};feedbro.MathJax=function(){var b=this;var a=true;var e=false;var c=false;var d=[];this.init=function(){if(e){return}e=true;if(navigator&&navigator.userAgent&&navigator.userAgent.indexOf("Firefox")!=-1){return}window.MathJax={extensions:["tex2jax.js"],jax:["input/TeX","output/HTML-CSS"],tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:true},"HTML-CSS":{availableFonts:["TeX"]}};var g=document.createElement("script");g.type="text/javascript";g.src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML";g.async="async";document.head.appendChild(g)};this.destroy=function(){window.MathJax=undefined};this.shouldRender=function(g){if(!g||g.length<4||!a){return false}var j,k=g.length,m=0,l,h=false;while(true){j=g.indexOf("$",m);if(j<0){break}if(j+1<k){l=g.charAt(j+1);if(l!="\\"&&(l==" "||l=="1"||l=="2"||l=="3"||l=="4"||l=="5"||l=="6"||l=="7"||l=="8"||l=="9"||l=="0")){h=false}else{h=true;break}}m=j+1}if(h){b.init()}return h};this.render=function(g){b.init();if(window.MathJax!=undefined){MathJax.Hub.Queue(["Typeset",MathJax.Hub,document.getElementById(g)])}else{d.push(g);if(!c){f()}}};function f(){if(window.MathJax!=undefined){if(d.length>0){var g;for(g=0;g<d.length;g++){MathJax.Hub.Queue(["Typeset",MathJax.Hub,document.getElementById(d[g])])}d=[]}}else{c=true;setTimeout(f,1000)}}};var feedbro=feedbro||{};feedbro.Notifications=function(){var d=new feedbro.Strings();var b;var a={};var c=[];this.setSettings=function(f){b=f};this.init=function(){if(chrome.notifications){setInterval(e,1000);chrome.notifications.onClicked.addListener(function(f){chrome.notifications.clear(f,function(j){if(b.getPopupClickMode()==2){var i=a[f];chrome.tabs.create({url:i});try{var h=chrome.extension.getBackgroundPage().feedbrobg;h.markUnread(parseInt(f,10),0);h.updateTotalUnread()}catch(g){feedbro.log("Failed to mark article with id "+f+" as read")}}else{feedbro.Chrome.openTab("Feedbro","reader.html?article="+f)}})})}else{console.log("chrome.notifications API is not available. Notifications disabled!")}};this.createItemNotification=function(i){if(b.getNotificationsEnabled()!=true){return}if(chrome.notifications==undefined){return}var f;if(i.feed.link!=undefined&&i.feed.link.indexOf("https://twitter.com")==0){f={src:"images/twitter128.png"}}else{if(i.feed.link!=undefined&&i.feed.link.indexOf("facebook.com/")!=-1){f={src:"images/facebook128.png"}}else{if(i.feed.link!=undefined&&i.feed.link.indexOf("youtube.com/")!=-1){f={src:"images/youtube128.png"}}else{f={src:"images/reader128.png"}}}}d.fixTitle(i);var g={type:"basic",title:d.unescapeHtml(d.stripTags(i.feed.title))+(i.author!=undefined&&i.author!=""?" | "+d.unescapeHtml(i.author):""),message:d.unescapeHtml(d.stripTags(i.title)),iconUrl:f.src};var j=i.id+"";a[j]=i.link+"";var h={id:j,options:g};c.push(h)};function e(){if(chrome.notifications==undefined){return}if(c.length>0){var f=c.shift();var g=b.getNotificationTimeout();chrome.notifications.create(f.id,f.options,function(h){})}}};var feedbro=feedbro||{};feedbro.Options=function(){var j=this;var e;var a;function f(){return chrome.extension.getBackgroundPage().feedbrobg}this.getLicense=function(){chrome.runtime.sendMessage({action:"getlicense"},function(l){e=JSON.parse(l.license);a=l.status;j.showLicense(e)})};this.showLicense=function(n){var l="";if(n==null){l="None"}else{var m;switch(n.data.type){case"1":m="Personal License";break;case"2":m="Corporate License";break}l+="Licensed to "+n.data.owner+" &lt;"+n.data.email+"&gt; - Valid until: "+n.data.valid+" - Type: "+m}$("div#license").html(l)};this.downloadFile=function(q,n,s){var r=navigator.userAgent.indexOf("Windows")==-1;var p=navigator.userAgent.indexOf("Vivaldi")!=-1;if(r&&p){s="application/octet-stream"}var o=new Blob([q],{type:s});var m=window.URL.createObjectURL(o);var l=document.createElement("a");l.href=m;l.download=n;l.style.display="none";document.body.appendChild(l);l.click()};function h(l,v){var o=$(l);var p=o.attr("title");var s=o.attr("text");var r=o.attr("xmlUrl");var m;var n;var u=o.attr("entryContent");var q=o.attr("maxItems");var t=o.attr("scanDelay");if(!p||p==""){p=s}if(!s&&p){s=p}if(s==undefined||s==""){s="Unnamed feed"}if(p==undefined||p==""){p="Unnamed feed"}if(r!=undefined){m=f().addFeed(r,s,p,v);if((u&&u!="")||(q&&q!="")||(t&&t!="")){n=f().getFeedTree().getNode(m);if(n){u=parseInt(u,10);if(!isNaN(u)){n.data.entrycontent=u}q=parseInt(q,10);if(!isNaN(q)){n.data.maxitems=q}t=parseInt(t,10);if(!isNaN(t)){n.data.scandelay=t}}}}}function b(q){var n,p,m,r=[];var o=new feedbro.Strings();try{m=JSON.parse(q)}catch(l){return null}r.push('<?xml version="1.0" encoding="UTF-8"?>');r.push('<opml version="1.0">');r.push("<head><title>Subscriptions</title></head>");r.push("<body>\n");try{if(m.length>0&&m[0].kind=="youtube#subscription"){r.push('<outline title="YouTube" text="YouTube">');for(n=0;n<m.length;n++){p=m[n];r.push('    <outline text="'+o.escapeHtml(p.snippet.title)+'" title="'+o.escapeHtml(p.snippet.title)+'" type="rss"');r.push('          xmlUrl="https://www.youtube.com/feeds/videos.xml?channel_id='+p.snippet.resourceId.channelId+'" htmlUrl="https://www.youtube.com/channel/'+p.snippet.resourceId.channelId+'"/>')}r.push("</outline>\n")}else{return null}}catch(l){}r.push("</body>\n</opml>\n");return r.join("\n")}this.importFeeds=function(s,m,o){try{var t;var q;if(m&&m.name.indexOf(".json")!=-1){console.log("Converting "+m.name+" OPML format automatically...");s=b(s)}try{t=$.parseXML(s);if(t==undefined){throw"Invalid file"}q=$(t);if(q.find("> opml").length!=1){throw"Invalid file"}}catch(l){alertify.alert(Locale.i18n("options_error_invalidopml",true,m.name));return}var u=f().getFeedTree();var n;var p={addedFeeds:0,addedFolders:0,skippedFeeds:0,skippedFolders:0};$.each(q.find("opml > body > outline"),function(v,x){var y=$(x);var z=y.attr("text");var w=y.attr("type");if(w=="rss"||w=="atom"||(w==undefined&&y.attr("xmlUrl")!=undefined)){if(!d(o,u,1,y.attr("xmlUrl"))){h(x,-1);p.addedFeeds++}else{feedbro.log("Skipped feed "+y.attr("xmlUrl"));p.skippedFeeds++}}else{if(w=="link"||w=="include"){feedbro.log("Skipped item "+v+" of unsupported type: "+w)}else{if(!z){z=y.attr("title")}if(z==undefined||z==""){z="Folder"}var A;if(o){n=u.searchNodes({type:2,name:z});if(n.length>0){A=n[0].data.id;p.skippedFolders++}else{A=f().addFolder(z);p.addedFolders++}}else{A=f().addFolder(z);p.addedFolders++}$.each(y.find("outline"),function(B,D){var C=$(D);if(C.attr("type")=="rss"||(C.attr("type")==undefined&&C.attr("xmlUrl")!=undefined)){if(!d(o,u,1,C.attr("xmlUrl"))){h(D,A);p.addedFeeds++}else{feedbro.log("Skipped feed "+C.attr("xmlUrl"));p.skippedFeeds++}}})}}});f().saveData();f().notifyEngine("reloaddata");f().scanUnread();alertify.alert(Locale.i18n("options_action_opmlimport_success",true,p.addedFeeds,p.addedFolders,p.skippedFeeds,p.skippedFolders))}catch(r){alertify.alert(Locale.i18n("options_action_opmlimport_failed",true,r+""))}};function d(m,l,n,o){if(!m){return false}if(n==1&&l.searchNodes({type:1,url:o}).length==0){return false}else{if(n==2&&l.searchNodes({type:2,name:o}).length==0){return false}}return true}function k(){try{var o=$("input#fileupload");var p=o.prop("files");if(p==undefined||p.length<1){feedbro.log("No file selected!");return}var m=p[0];var n=new FileReader();n.onload=function(s){var r=s.target.result;var q=f().getSettings().getSkipOpmlDupes();j.importFeeds(r,m,q);o.val(null)};n.readAsText(m)}catch(l){feedbro.log(l)}return false}function c(){try{var o=$("input#rulesupload");var p=o.prop("files");if(p==undefined||p.length<1){feedbro.log("No file selected!");return}var m=p[0];var n=new FileReader();n.onload=function(s){var r=s.target.result;try{f().getRuleEngine().importRules(r);alertify.alert(Locale.i18n("options_action_rulesimport_success",true))}catch(q){feedbro.log(q);alertify.alert(Locale.i18n("options_action_rulesimport_failed",true,q+""))}o.val(null)};n.readAsText(m)}catch(l){feedbro.log(l);alertify.alert(Locale.i18n("options_action_rulesimport_failed",true,l+""))}return false}function g(){try{var o=$("input#licenseupload");var p=o.prop("files");if(p==undefined||p.length<1){return}var m=p[0];var n=new FileReader();n.onload=function(s){var r=s.target.result;try{f().updateLicense(r,function(t){if(t==1){alertify.success("License successfully imported!");j.getLicense()}},function(t){if(t==-3){alertify.error("License has expired")}else{alertify.error("Invalid license")}})}catch(q){feedbro.log(q);alertify.alert("Unable to import license: "+q)}o.val(null)};n.readAsText(m)}catch(l){feedbro.log(l);alertify.alert("Unable to import license: "+l)}return false}function i(){$("link#theme").attr("href","styles/theme-"+f().getSettings().getTheme()+".css")}this.initOptions=function(){try{j.refreshLocale()}catch(m){feedbro.log("Locale init error",m)}i();$("a#export").click(function(){var r=new feedbro.Strings();var q=r.getDatestamp();j.downloadFile(f().exportOpml(),"feedbro-subscriptions-"+q+".opml","application/xml");return false});$("a#import").click(function(){$("input#fileupload").click();return false});$("a#clearall").click(function(){alertify.confirm(Locale.i18n("options_action_delete_feedsandfolders",true),function(r){if(r){try{f().clearAll();setTimeout(function(){alertify.alert(Locale.i18n("options_action_delete_feedsandfolders_success",true))},1000)}catch(q){feedbro.log("Error in removing all subscriptions: ",q)}}});return false});$("a#deleteRules").click(function(){alertify.confirm(Locale.i18n("options_action_delete_rules",true),function(s){if(s){try{var r=f().getRuleEngine();r.deleteRules();r.saveRules();setTimeout(function(){alertify.alert(Locale.i18n("options_action_delete_rules_success",true))},1000)}catch(q){feedbro.log("Error in deleting rules: ",q)}}});return false});var o=f().getSettings();$("input#fileupload").change(function(){k();return false});$("input#rulesupload").change(function(){c();return false});$("input#licenseupload").change(function(){g();return false});$("a#importlicense").click(function(){$("input#licenseupload").click();return false});$("a#exportRules").click(function(){var q=f().getRuleEngine().exportRules();j.downloadFile(JSON.stringify(q,null,4),"feedbro-rules.json","application/json");return false});$("a#importRules").click(function(){$("input#rulesupload").click();return false});$("a#importFirefox").click(function(){document.location.href="firefox-bookmarks.html"});$("select#updatethreads").val(o.getUpdateThreads());$("select#updatethreads").change(function(){f().getSettings().setUpdateThreads($(this).val());f().saveSettings()});$("select#timeout").val(o.getFeedTimeout()/1000);$("select#timeout").change(function(){f().getSettings().setFeedTimeout($(this).val()*1000);f().saveSettings()});$("select#articlelink").val(o.getArticleLinkMode());$("select#articlelink").change(function(){var q=parseInt($(this).val(),10);f().getSettings().setArticleLinkMode(q);f().saveSettings()});$("select#polldelay").val(o.getPollDelay());$("select#polldelay").change(function(){var q=$(this).val();f().getSettings().setPollDelay(q);f().saveSettings()});$("select#targetlanguage").val(o.getTargetLanguage());$("select#targetlanguage").change(function(){var q=$(this).val();f().getSettings().setTargetLanguage(q);f().saveSettings()});$("select#maxentries").val(o.getFeedMaxEntries());$("select#maxentries").change(function(){f().getSettings().setFeedMaxEntries($(this).val());f().saveSettings()});$("select#markreadmode").val(o.getMarkReadMode());$("select#markreadmode").change(function(){f().getSettings().setMarkReadMode($(this).val());f().saveSettings()});$("select#iconclick").val(o.getIconClickMode());$("select#iconclick").change(function(){f().getSettings().setIconClickMode($(this).val());f().saveSettings();f().setPopupEnabled($(this).val()=="1")});$("select#popupclick").val(o.getPopupClickMode());$("select#popupclick").change(function(){f().getSettings().setPopupClickMode($(this).val());f().saveSettings()});$("select#faviconprovider").val(o.getFavIconProvider());$("select#faviconprovider").change(function(){f().getSettings().setFavIconProvider($(this).val());f().saveSettings()});$("input#iconclickreloads").prop("checked",o.getIconClickReloads());$("input#iconclickreloads").change(function(){f().getSettings().setIconClickReloads($(this).is(":checked"));f().saveSettings()});$("input#tag-iframe").prop("checked",o.getFilterIframe());$("input#tag-iframe").change(function(){f().getSettings().setFilterIframe($(this).is(":checked"));f().saveSettings()});$("input#tag-embed").prop("checked",o.getFilterEmbed());$("input#tag-embed").change(function(){f().getSettings().setFilterEmbed($(this).is(":checked"));f().saveSettings()});$("input#sound").prop("checked",o.getSoundEnabled());$("input#sound").change(function(){f().getSettings().setSoundEnabled($(this).is(":checked"));f().saveSettings()});$("input#latestinpopup").prop("checked",o.getShowLatestInPopup());$("input#latestinpopup").change(function(){f().getSettings().setShowLatestInPopup($(this).is(":checked"));f().saveSettings()});$("input#mathjax").prop("checked",o.getMathJaxEnabled());$("input#mathjax").change(function(){f().getSettings().setMathJaxEnabled($(this).is(":checked"));f().saveSettings()});$("input#startallitems").prop("checked",o.getStartPageAllItems());$("input#startallitems").change(function(){f().getSettings().setStartPageAllItems($(this).is(":checked"));f().saveSettings()});$("input#notifications").prop("checked",o.getNotificationsEnabled());$("input#notifications").change(function(){f().getSettings().setNotificationsEnabled($(this).is(":checked"));f().saveSettings()});$("input#disableautoscan").prop("checked",o.getDisableAutoScan());$("input#disableautoscan").change(function(){f().getSettings().setDisableAutoScan($(this).is(":checked"));f().saveSettings()});$("input#disableautoselect").prop("checked",o.getDisableAutoSelect());$("input#disableautoselect").change(function(){f().getSettings().setDisableAutoSelect($(this).is(":checked"));f().saveSettings()});$("input#confirmmarkread").prop("checked",o.getConfirmMarkRead());$("input#confirmmarkread").change(function(){f().getSettings().setConfirmMarkRead($(this).is(":checked"));f().saveSettings()});$("input#truncatetitles").prop("checked",o.getTruncateTitles());$("input#truncatetitles").change(function(){f().getSettings().setTruncateTitles($(this).is(":checked"));f().saveSettings()});$("input#justifytext").prop("checked",o.getJustifyText());$("input#justifytext").change(function(){f().getSettings().setJustifyText($(this).is(":checked"));f().saveSettings()});$("input#usefavicons").prop("checked",o.getUseFavIcons());$("input#usefavicons").change(function(){f().getSettings().setUseFavIcons($(this).is(":checked"));f().saveSettings();f().notifyEngine("reloaddata")});$("input#faviconfromline").prop("checked",o.getFaviconOnFromline());$("input#faviconfromline").change(function(){f().getSettings().setFaviconOnFromline($(this).is(":checked"));f().saveSettings();f().notifyEngine("reloaddata")});$("input#usefaviconstitles").prop("checked",o.getUseFavIconsTitles());$("input#usefaviconstitles").change(function(){f().getSettings().setUseFavIconsTitles($(this).is(":checked"));f().saveSettings()});$("input#skipopmldupes").prop("checked",o.getSkipOpmlDupes());$("input#skipopmldupes").change(function(){f().getSettings().setSkipOpmlDupes($(this).is(":checked"));f().saveSettings()});$("input#disableheaderlistener").prop("checked",o.getDisableHeaderListener());$("input#disableheaderlistener").change(function(){f().getSettings().setDisableHeaderListener($(this).is(":checked"));f().saveSettings()});$("input.quicktag").blur(function(){var q=$(this);f().getSettings().setQuickTag(q.attr("id"),q.val());f().saveSettings()});$("input#qtag1").val(o.getQuickTag("qtag1"));$("input#qtag2").val(o.getQuickTag("qtag2"));$("input#qtag3").val(o.getQuickTag("qtag3"));$("input#qtag4").val(o.getQuickTag("qtag4"));$("input#qtag5").val(o.getQuickTag("qtag5"));var l=new Date();$("select#dateformat option").each(function(){$(this).text(l.format($(this).val()))});$("select#theme").val(o.getTheme());$("select#theme").change(function(){f().getSettings().setTheme($(this).val());f().saveSettings();f().updateTheme();i()});$("select#bodyfontsize").val(o.getArticleBodyFontSize());$("select#bodyfontsize").change(function(){f().getSettings().setArticleBodyFontSize($(this).val());f().saveSettings();f().updateCss()});$("select#titlefontsize").val(o.getTitleFontSize());$("select#titlefontsize").change(function(){f().getSettings().setTitleFontSize($(this).val());f().saveSettings();f().updateCss()});var n,p;for(n=1;n<=6;n++){p=$("select#articlewidth"+n);p.val(String(o.getArticleWidth(n)));p.change(function(){f().getSettings().setArticleWidth($(this).attr("data-mode"),$(this).val());f().saveSettings();f().updateCss()})}$("select#cardheight").val(o.getCardHeight());$("select#cardheight").change(function(){f().getSettings().setCardHeight($(this).val());f().saveSettings();f().updateCss()});$("select#articlefontfamily").val(o.getArticleFontFamily());$("select#articlefontfamily").change(function(){f().getSettings().setArticleFontFamily($(this).val());f().saveSettings();f().updateCss()});$("select#lineheight").val(o.getArticleLineHeight());$("select#lineheight").change(function(){f().getSettings().setArticleLineHeight($(this).val());f().saveSettings();f().updateCss()});$("select#dateformat").val(o.getDateFormat());$("select#dateformat").change(function(){f().getSettings().setDateFormat($(this).val());f().saveSettings()});$("select#inactivelimit").val(o.getInactiveFeedLimit());$("select#inactivelimit").change(function(){f().getSettings().setInactiveFeedLimit($(this).val());f().saveSettings()});$("select#confirmmode").val(o.getConfirmMarkReadMode());$("select#confirmmode").change(function(){f().getSettings().setConfirmMarkReadMode($(this).val());f().saveSettings()});$("div#left").click(function(){j.restoreView()});$("div#right").click(function(){j.restoreView()});$("select#locale").change(function(q){var r=$(this).val();f().selectLocale(r);j.refreshLocale()});$("a#importLocale").click(function(q){q.preventDefault();alertify.prompt(Locale.i18n("options_locale_url",true),function(s,r){if(s){j.updateLocale(r)}})});$("a#updateLocale").click(function(q){q.preventDefault();var s=$("select#locale").val();if(s=="custom"){var r=f().getSettings().getLocaleMeta();j.updateLocale(r.locale_source_url)}});$("#templateLocale").click(function(q){q.preventDefault();j.getLocaleTemplate()});if(navigator.userAgent.indexOf("Firefox")==-1){$(".filter-firefox").css("display","none")}};this.updateLocale=function(l){f().installLocale(l,function(m){j.refreshLocale();alertify.alert(Locale.i18n("options_action_locale_update_success",true))},function(m){setTimeout(function(){alertify.alert(Locale.i18n("options_action_locale_update_failed",true,m))},500)})};this.refreshLocale=function(){var m=f().getSettings();var n=m.getLocaleMeta();Locale.start();Locale.activeMap=f().getActiveLocaleMap();Locale.translate(true);alertify.set({labels:{cancel:Locale.i18n("dialog_cancel",true),ok:Locale.i18n("dialog_ok",true)}});if(n){var o=$("#locale option[value='custom']");var l=new feedbro.Strings();if(o==undefined||o.length==0){$("#locale").append("<option value='custom'>"+l.escapeHtml(n.locale_name+" ("+n.locale_type+")")+"</option>")}else{o.html(l.escapeHtml(n.locale_name+" ("+n.locale_type+")"))}}$("#locale").val(m.getLocale())};this.getLocaleTemplate=function(){j.downloadFile(JSON.stringify(f().getDefaultLocaleMap(),undefined,4),"feedbro-locale-en_US.json","application/json")};this.restoreView=function(){chrome.tabs.query({url:chrome.runtime.getURL("reader.html")+"*"},function(l){if(l.length>0){chrome.tabs.update(l[0].id,{active:true})}else{document.location.href="reader.html"}})}};var feedbro=feedbro||{};feedbro.Persistence={};feedbro.Persistence.loadValue=function(a,b){chrome.storage.local.get(a,function(c){if(chrome.runtime.lastError){console.log("chrome.storage.local.get failed! Reload the extension or restart the browser. Error: ",chrome.runtime.lastError)}else{b(c[a])}})};feedbro.Persistence.saveValue=function(a,b,d){var c={};c[a]=b;chrome.storage.local.set(c,function(){if(chrome.runtime.lastError){console.log("Failed to save: Persistence.saveValue with parameter: "+a,chrome.runtime.lastError)}if(d){d()}})};var feedbro=feedbro||{};feedbro.RuleEngine=function(){var k=this;var l;var f=0;var e=0;var d=0;var j=0;var g=false;var a;var c=[];var h=new feedbro.Strings();var b=false;var i=false;this.setDebug=function(m){b=m};this.isEnabled=function(){return g};this.setEnabled=function(m){g=m};this.setActionHandler=function(m){a=m};this.process=function(n,o,q,m){if(!g){return}if(a==undefined){feedbro.log("RuleEngine: undefined ActionHandler");return}var p=[];k.evaluateRulesForEntry(n,o,p);if(p.length>0){a.processActions(o,p,q,m)}};this.evaluateRulesForAllEntries=function(o,m){if(!g){return[]}d=0;var p=[];feedbro.log("evaluateRulesForAllEntries: start");for(var n=0;n<m.length;n++){k.evaluateRulesForEntry(o,m[n],p)}feedbro.log("evaluateRulesForAllEntries: matched rules: "+d+" actions: "+p.length);return p};this.evaluateRulesForEntry=function(o,w,q,n){if(!g){return}var s;for(s=0;s<c.length;s++){var u=k.evaluate(o,w,c[s]);if(u!=false){for(var r=0;r<u.length;r++){q.push(u[r])}if(n){try{n(c[s])}catch(v){feedbro.log("RuleListener error",v)}}if(c[s].fallthrough!=undefined&&c[s].fallthrough==false){break}}}if(q&&q.length>0){var p;var t=false;var m=false;for(s=0;s<q.length;s++){p=q[s];if(p.type==feedbro.RuleEngine.ACTION_HIDEARTICLE){t=p}else{if(p.type==feedbro.RuleEngine.ACTION_DELETEARTICLE){m=p}}}if(t||m){q.length=0;if(t){q.push(t)}if(m){q.push(m)}}}};this.evaluate=function(n,x,v){if(!g){return false}if(!v.enabled){return false}if(v.trigger!=n){return false}if(v.contexttype==2&&(x.folderid!=v.contextvalue&&!h.inArray(String(x.folderid),v.contextvalue))){return false}if(v.contexttype==3&&(x.feedid!=v.contextvalue&&!h.inArray(String(x.feedid),v.contextvalue))){return false}var s=[];var y,u;for(var q=0;q<v.conditions.length;q++){u=v.conditions[q];y="";if(u.target==1){y=x.content}else{if(u.target==2){y=x.author}else{if(u.target==3){y=x.title}else{if(u.target==4){y=x.link}}}}var o=(u.casemode==2);if(u.mode==1){if(u.value==""||u.value==undefined){s.push(v)}else{if((u.regexp instanceof RegExp)==false){u.regexp=h.getRegexp(u.value,o?"gi":"g")}u.regexp.lastIndex=0;if(u.regexp.test(y)){s.push(v)}}}else{if(u.mode==2&&h.indexOf(y,u.value,0,o)!=-1){s.push(v)}else{if(u.mode==3&&h.indexOf(y,u.value,0,o)==-1){s.push(v)}else{if(u.mode==4&&h.equals(y,u.value,o)){s.push(v)}else{if(u.mode==5&&h.equals(y,u.value,o)==false){s.push(v)}else{if(u.mode==6&&h.startsWith(y,u.value,o)){s.push(v)}else{if(u.mode==7&&h.endsWith(y,u.value,o)){s.push(v)}else{if(u.mode==8){if(u.words==undefined){u.words=h.splitTrim(u.value,",").join(",")}if(h.containsWords(y,u.words,o)){s.push(v)}}else{if(u.mode==9){if(u.words==undefined){u.words=h.splitTrim(u.value,",").join(",")}if(h.doesNotContainWords(y,u.words,o)){s.push(v)}}else{if(u.mode==10){if(u.words==undefined){u.words=h.splitTrim(u.value,",").join(",")}if(h.containsAnyWord(y,u.words,o)){s.push(v)}}else{if(u.mode==11){if((u.regexp instanceof RegExp)==false){var r="(?:\\s|\\.|\\,|\\!|\\?|\\(|\\)|\\'|\\\"|\\t|>|:|;|^)";var m="(?:\\s|\\.|\\,|\\!|\\?|\\(|\\)|\\'|\\\"|\\t|<|:|;|$)";var w=u.value?u.value:"";w=w.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");var p=r+"("+h.splitTrim(w,",").join("|")+")\\S*"+m;u.regexp=h.getRegexp(p,o?"gi":"g")}u.regexp.lastIndex=0;if(u.regexp.test(y)){s.push(v)}}}}}}}}}}}}if(v.match==2&&s.length>0){break}if(v.match==3&&s.length>0){break}}var t=false;if(v.match==1&&s.length==v.conditions.length){t=true}else{if(v.match==2&&(s.length>0||v.conditions.length==0)){t=true}else{if(v.match==3&&s.length==0){t=true}}}if(!t){return false}d++;return v.actions};this.sortRules=function(){c.sort(function(n,m){if(n.order==undefined||m.order==undefined){return 0}return n.order-m.order})};this.deleteRules=function(){c=[]};this.saveRules=function(){feedbro.Persistence.saveValue("rules",JSON.stringify(c))};this.loadRules=function(){feedbro.Persistence.loadValue("rules",function(m){if(chrome.runtime.lastError==undefined){i=true;feedbro.log("Rules loaded successfully.")}else{feedbro.log("Failed to load Rules! ",chrome.runtime.lastError)}if(m!=undefined){c=JSON.parse(m)}})};this.isLoaded=function(){return i};this.getRules=function(){return c};this.getRule=function(n){for(var m=0;m<c.length;m++){if(c[m].id==n){return c[m]}}return{}};this.importRules=function(n){var m=JSON.parse(n);var s,p,o,r,t,q;var u=chrome.extension.getBackgroundPage().feedbrobg.getFeedTree();for(p=0;p<m.length;p++){s=m[p];if(!s.schema||!s.name){feedbro.log("Skipped invalid Rule: ",s);continue}if(s.contextvaluetext){if(s.contexttype=="2"){r=[];for(o=0;o<s.contextvaluetext.length;o++){q=u.searchNodes({name:s.contextvaluetext[o],type:2});if(q&&q.length>0){t=q[0];r.push(t.data.id+"")}}s.contextvalue=r}else{if(s.contexttype=="3"){r=[];for(o=0;o<s.contextvaluetext.length;o++){q=u.searchNodes({url:s.contextvaluetext[o],type:1});if(q&&q.length>0){t=q[0];r.push(t.data.id+"")}}s.contextvalue=r}}delete s.contextvaluetext}k.addRule(s);feedbro.log("Imported rule: ",s)}k.saveRules()};this.exportRules=function(){var u=chrome.extension.getBackgroundPage().feedbrobg.getFeedTree();var s,n,m,t,p,q;var v=[];for(var o=0;o<c.length;o++){s=c[o];if(s.contextvalue!=null){var r=[];for(n=0;n<s.contextvalue.length;n++){m=parseInt(s.contextvalue[n],10);q=parseInt(s.contexttype,10);if(q==3){q=1}p=u.searchNodes({id:m,type:q});if(p&&p.length>0){t=p[0];if(t.data.type==2){r.push(t.data.name)}else{if(t.data.type==1){r.push(t.data.url)}else{feedbro.log("Did not identify entry data type: "+t.data.type)}}}}s=JSON.parse(JSON.stringify(s));s.contextvaluetext=r}v.push(s)}return v};this.addRule=function(n){if(n.id==undefined){n.id=new Date().getTime()+j++}n=jQuery.extend(true,{},n);for(var m=0;m<c.length;m++){if(c[m].id==n.id){c[m]=n;return}}c.push(n)};this.deleteRule=function(n){for(var m=0;m<c.length;m++){if(c[m].id==n){c.splice(m,1);feedbro.log("RuleEngine: Removed rule with id "+n);return}}}};feedbro.RuleEngine.EVENT_ITEM_ARRIVED=1;feedbro.RuleEngine.EVENT_ITEM_VIEWED=2;feedbro.RuleEngine.ACTION_NOTIFICATION=1;feedbro.RuleEngine.ACTION_HIDEARTICLE=2;feedbro.RuleEngine.ACTION_DELETEARTICLE=3;feedbro.RuleEngine.ACTION_STAR=4;feedbro.RuleEngine.ACTION_MARKREAD=5;feedbro.RuleEngine.ACTION_PLAYSOUND=6;feedbro.RuleEngine.ACTION_HIGHLIGHTBORDER=7;feedbro.RuleEngine.ACTION_HIGHLIGHTREGEXP=8;feedbro.RuleEngine.ACTION_ADDTAG=9;feedbro.RuleEngine.ACTION_IFTTT_MAKERPOST=11;feedbro.RuleEngine.ACTION_ADD_POINTS=12;feedbro.RuleEngine.ACTION_PLAYSOUNDURL=13;feedbro.RuleEngine.ACTION_DISABLEAUTOPLAY=14;feedbro.RuleEngine.ACTION_DISCORD=15;feedbro.RuleEngine.ACTION_SLACK=16;feedbro.RuleEngine.IGNORE_ACTIONS_ARRIVE={2:true,7:true,8:true};feedbro.RuleEngine.IGNORE_ACTIONS_ARRIVE_FIRSTLOAD={1:true,2:true,6:true,7:true,8:true,13:true,15:true,16:true};feedbro.RuleEngine.IGNORE_ACTIONS_VIEW={1:true,9:true,11:true,12:true,13:true,14:true,15:true,16:true};feedbro.RuleEngine.IGNORE_ACTIONS_UPDATED={1:true,2:true,6:true,7:true,8:true,11:true,13:true};var feedbro=feedbro||{};feedbro.RuleEngineUI=function(){var b=this;var c=0;var f=0;var e=new feedbro.Strings();var d="div#feed";function a(){return chrome.extension.getBackgroundPage().feedbrobg}this.setContainerName=function(g){d=g};this.init=function(){$("div#ruleform #contexttype").change(function(){var g=$(this).val();b.setContextType(g)});$("div#ruleform a#delete").click(function(){var g=$("input#ruleid").val();if(g!=""){alertify.confirm(Locale.i18n("ruleview_delete_confirm",false),function(h){if(h){a().getRuleEngine().deleteRule(g);b.showForm(false);a().getRuleEngine().saveRules();b.printRuleList()}})}return false});$("div#ruleform a#save").click(function(){try{var h=b.formToRule();var i=a().getRuleEngine();i.addRule(h);i.saveRules();b.showForm(false);b.printRuleList()}catch(g){alertify.alert(g.message)}return false});$("div#ruleform a#addcondition").click(function(){b.addCondition();b.centerForm();return false});$("div#ruleform a#addaction").click(function(){b.addAction();b.centerForm();return false});$("div#ruleform a#reset").click(function(){b.resetForm();return false});$("div#ruleform a#cancel").click(function(){b.showForm(false);return false});$("div#rulesimulationform > nav > a#simulateClose").click(function(){b.showSimulateForm(false);return false});$("div#rulesimulationform > nav > a#simulateRun").click(function(){var i=parseInt($("select#simulationtrigger").val(),10);var k=($("select#simulationcontextvalue").val()||"-1:-1").split(":");var h=parseInt(k[0],10);var g=parseInt(k[1],10);var l={title:$("input#simulationTitle").val(),link:$("input#simulationURL").val(),content:$("textarea#simulationContent").val(),author:$("input#simulationAuthor").val(),feedid:h,folderid:g};var m=[];var j="";a().getRuleEngine().evaluateRulesForEntry(i,l,m,function(n){j+=e.escapeHtml(n.name)+"\n"});$("textarea#simulationResult").val(j!=""?j:Locale.i18n("ruleview_no_matches",true))})};this.setContextType=function(j){var h=$("select#contextvalue");var g;if(j==1){h.css({display:"none"})}if(j==2){g=a().getFeedTree();h.empty();h.append('<option value="-1">'+Locale.i18n("common_root",true)+"</option>");g.processNodes(g.getRoot(),function(k){if(k.data.type==feedbro.FeedTree.FOLDER){h.append('<option value="'+k.data.id+'">'+e.escapeHtml(k.data.name)+"</option>")}},feedbro.FeedTree.MODE_TOPNODES);h.css({display:"block"})}if(j==3){var i="";g=a().getFeedTree();g.processNodes(g.getRoot(),function(m){if(m.data.type==feedbro.FeedTree.FOLDER){i+='<optgroup label="'+e.escapeHtml(m.data.name)+'">';var l=m.children;for(var k=0;k<l.length;k++){i+='<option value="'+l[k].data.id+'">'+e.escapeHtml(l[k].data.name)+"</option>"}i+="</optgroup>"}else{i+='<option value="'+m.data.id+'">'+e.escapeHtml(m.data.name)+"</option>"}},feedbro.FeedTree.MODE_TOPNODES);h.html(i);h.css({display:"block"})}};this.addAction=function(){var g=$("tr#actiontemplate").clone();f++;g.attr("id","action-"+f);g.css({display:"table-row"});g.find("select.action-type").attr("id","action-type-"+f);g.find("select.action-type").data("value",f);g.find("input.action-value").attr("id","action-value-"+f);g.find("select.action-sound").attr("id","action-sound-"+f);g.find("input.action-color").attr("id","action-color-"+f);g.find("select.action-type").change(function(){var h=$(this);var i=h.val();if(i=="6"){g.find("input.action-value").css({display:"none"});g.find("input.action-color").css({display:"none"});g.find("select.action-sound").css({display:"inline-block"});g.find("select.action-sound").change(function(){var j=$(this).val();a().getSoundPlayer().play("sound/"+j)})}else{if(i=="7"){g.find("input.action-color").css({display:"inline-block"});g.find("input.action-value").css({display:"none"});g.find("select.action-sound").css({display:"none"})}else{if(i=="8"||i=="9"||i=="10"||i=="11"||i=="12"||i=="13"||i=="15"||i=="16"){g.find("input.action-value").css({display:"inline-block"});g.find("input.action-color").css({display:"none"});g.find("select.action-sound").css({display:"none"})}else{g.find("input.action-value").css({display:"none"});g.find("input.action-color").css({display:"none"});g.find("select.action-sound").css({display:"none"})}}}});g.find("a.action-remove").click(function(h){return function(i){$("tr#action-"+h).remove();i.stopPropagation();return false}}(f));g.insertBefore($("tr#actiontemplate"));return f};this.addCondition=function(){var g=$("tr#condtemplate").clone();c++;g.attr("id","condition-"+c);g.css({display:"table-row"});g.find("select.cond-target").attr("id","cond-target-"+c);g.find("select.cond-target").data("value",c);g.find("select.cond-mode").attr("id","cond-mode-"+c);g.find("input.cond-value").attr("id","cond-value-"+c);g.find("select.cond-casemode").attr("id","cond-casemode-"+c);g.find("a.cond-remove").click(function(h){return function(i){$("tr#condition-"+h).remove();i.stopPropagation();return false}}(c));g.insertBefore($("tr#condtemplate"));return c};this.formToRule=function(){var g={};g.id=$("input#ruleid").val();if(g.id==""){g.id=new Date().getTime()+""}g.schema=1;g.enabled=$("input#enabled").prop("checked");g.fallthrough=$("input#fallthrough").prop("checked");g.name=$("input#name").val().trim();g.trigger=$("select#trigger").val();g.contexttype=$("select#contexttype").val();g.contextvalue=$("#contextvalue").val();g.match=$("select#match").val();g.conditions=[];g.actions=[];if(g.name==""||g.name.length<1){throw new Error(Locale.i18n("ruleview_error_name_missing",true))}if(g.name.length>80){throw new Error(Locale.i18n("ruleview_error_name_toolong",true))}if(g.contexttype==2&&g.contextvalue==undefined){throw new Error(Locale.i18n("ruleview_error_folder_missing",true))}if(g.contexttype==3&&g.contextvalue==undefined){throw new Error(Locale.i18n("ruleview_error_feed_missing",true))}$("select.cond-target").each(function(k,l){var i=$(l);var h=i.data("value");if(!h){return}var j={};j.target=i.val();j.mode=$("select#cond-mode-"+h).val();j.value=$("input#cond-value-"+h).val();j.casemode=$("select#cond-casemode-"+h).val();if(j.mode==1){e.getRegexp(j.value)}g.conditions.push(j)});$("select.action-type").each(function(k,l){var i=$(l);var h=i.data("value");if(!h){return}var m=parseInt(i.val(),10);if(g.trigger=="1"){if(m==feedbro.RuleEngine.ACTION_HIDEARTICLE){throw new Error(Locale.i18n("ruleview_error_hidearticle",true))}if(m==feedbro.RuleEngine.ACTION_HIGHLIGHTBORDER){throw new Error(Locale.i18n("ruleview_error_highlightborder",true))}if(m==feedbro.RuleEngine.ACTION_HIGHLIGHTREGEXP){throw new Error(Locale.i18n("ruleview_error_highlightregexp",true))}}else{if(g.trigger=="2"){if(m==feedbro.RuleEngine.ACTION_NOTIFICATION){throw new Error(Locale.i18n("ruleview_error_notification",true))}if(m==feedbro.RuleEngine.ACTION_ADDTAG){throw new Error(Locale.i18n("ruleview_error_addtag",true))}if(m==feedbro.RuleEngine.ACTION_IFTTT_MAKERPOST){throw new Error(Locale.i18n("ruleview_error_ifttt",true))}if(m==feedbro.RuleEngine.ACTION_HIDEARTICLE&&g.conditions.length==0){throw new Error(Locale.i18n("ruleview_error_hidearticle_condition",true))}if(m==feedbro.RuleEngine.ACTION_DELETEARTICLE&&g.conditions.length==0){throw new Error(Locale.i18n("ruleview_error_delete_condition",true))}if(m==feedbro.RuleEngine.ACTION_ADD_POINTS){throw new Error(Locale.i18n("ruleview_error_addpoints",true))}if(m==feedbro.RuleEngine.ACTION_DISABLEAUTOPLAY){throw new Error(Locale.i18n("ruleview_error_disableautoplay",true))}}}var j={};j.type=i.val();if(j.type=="6"){j.value=$("select#action-sound-"+h).val()}else{if(j.type=="7"){j.value=$("input#action-color-"+h).val()}else{j.value=$("input#action-value-"+h).val()}}if(j.type=="8"){if(j.value==undefined||j.value.trim().length<1){throw new Error(Locale.i18n("ruleview_error_emptyregexp",true))}e.getRegexp(j.value)}if(j.type=="9"){if(j.value==undefined||j.value.trim().length<1){throw new Error(Locale.i18n("ruleview_error_emptytag",true))}}if(j.type=="12"){if(!e.isInt(j.value)){throw new Error(Locale.i18n("ruleview_error_invalidpoints",true))}}if(j.type=="11"){if(j.value==undefined||j.value.trim().length<1){throw new Error(Locale.i18n("ruleview_error_ifttt_emptyurl",true))}if((j.value+"").indexOf("https://maker.ifttt.com")!=0){throw new Error(Locale.i18n("ruleview_error_ifttt_invalidurl",true))}}if(j.type=="13"){if(j.value==undefined||j.value.trim().length<1){throw new Error(Locale.i18n("ruleview_error_emptyplayurl",true))}}g.actions.push(j)});if(g.actions.length<1){throw new Error(Locale.i18n("ruleview_error_noaction"))}return g};this.ruleToForm=function(l){var h,g,j,k;b.resetForm();$("a#delete").css({display:"inline-block"});$("input#ruleid").val(l.id);$("input#enabled").prop("checked",l.enabled);$("input#fallthrough").prop("checked",l.fallthrough==undefined||l.fallthrough==true);$("input#name").val(l.name);$("select#trigger").val(l.trigger);$("select#contexttype").val(l.contexttype);b.setContextType(l.contexttype);$("#contextvalue").val(l.contextvalue);$("select#match").val(l.match);if(jQuery.isArray(l.conditions)){for(h=0;h<l.conditions.length;h++){j=l.conditions[h];g=b.addCondition();$("select#cond-target-"+g).val(j.target);$("select#cond-mode-"+g).val(j.mode);$("input#cond-value-"+g).val(j.value);$("select#cond-casemode-"+g).val(j.casemode)}}if(jQuery.isArray(l.actions)){for(h=0;h<l.actions.length;h++){k=l.actions[h];g=b.addAction();$("select#action-type-"+g).val(k.type);if(k.type=="6"){$("select#action-sound-"+g).val(k.value);$("select#action-sound-"+g).css({display:"inline-block"});$("select#action-sound-"+g).change(function(){var i=$(this).val();a().getSoundPlayer().play("sound/"+i)})}else{if(k.type=="7"){$("input#action-color-"+g).val(k.value);$("input#action-color-"+g).css({display:"inline-block"})}else{if(k.type=="8"||k.type=="9"||k.type=="10"||k.type=="11"||k.type=="12"||k.type=="13"||k.type=="15"||k.type=="16"){$("input#action-value-"+g).val(k.value);$("input#action-value-"+g).css({display:"inline-block"})}}}}}};this.showForm=function(g){var h=$("div#ruleform");h.css({display:g?"block":"none",position:"absolute"});b.centerForm();h.find("input#name").focus()};this.centerForm=function(){var g=$("div#ruleform");g.css({top:Math.max(0,(($(window).height()-g.outerHeight())/2)+$(window).scrollTop())+"px",left:Math.max(0,(($(window).width()-g.outerWidth())/2)+$(window).scrollLeft())+"px"})};this.printRuleList=function(){var n="";if(a().getRuleEngine().isLoaded()==false){n+="<div class='info'><div class='info-message'>"+Locale.i18n("ruleview_error_loading",true)+"</div></div>";$(d).html(n);return}var q=a().getRuleEngine().getRules();var o="<center>";o+="<button id='addrule' class='alertify-button alertify-button-ok'>"+Locale.i18n("ruleview_action_addrule_body",true)+"</button>";o+="<button id='testrules' class='alertify-button alertify-button-ok'>"+Locale.i18n("ruleview_action_testrules_body",true)+"</button>";o+="</center>";if(q.length==0){n+="<div class='info'><div class='info-message'>"+Locale.i18n("ruleview_no_rules_yet_body",true)+"</div></div>";n+=o;$(d).html(n)}else{n+="<table id='rulelist' class='feedtable'>";n+="<thead><tr><th></th>";n+="<th>"+Locale.i18n("ruleview_name_body",true)+"</th>";n+="<th class='center'>"+Locale.i18n("ruleview_type_body",true)+"</th>";n+="<th class='center'>"+Locale.i18n("ruleview_enabled_body",true)+"</th>";n+="<th class='center'>"+Locale.i18n("ruleview_fallthrough_body",true)+"</th>";n+="</tr></thead><tbody id='rulelistbody'>";var h=Locale.i18n("ruleview_table_row_title",true);var j=Locale.i18n("ruleview_table_clickedit_title",true);var p=Locale.i18n("ruleview_table_arrive_title",true);var l=Locale.i18n("ruleview_table_view_title",true);var k=Locale.i18n("ruleview_table_inactive_title",true);var g=Locale.i18n("ruleview_table_fallthrough_title",true);for(var m=0;m<q.length;m++){n+="<tr class='feedtablerow' draggable='true' id='rule-"+q[m].id+"' style='cursor: move' title='"+h+"'>";n+="<td class='rownumber'>"+(m+1)+".</td>";n+="<td><a href='#' title='"+j+"' class='rulelink' style='cursor: hand'>"+e.escapeHtml(q[m].name)+"</a></td>";n+="<td class='center'><img width='16' class='ruletype-icon' src='images/"+(q[m].trigger=="1"?"email.png' title='"+p+"'":"eye.png' title='"+l+"'")+"></td>";n+="<td class='center' title='"+k+"'>"+(q[m].enabled?"&#x2714;":"")+"</td>";n+="<td class='center' title='"+g+"'>"+(q[m].fallthrough==false?"":"&#x2714;")+"</td>";n+="</tr>"}n+="</tbody></table>";n+=o;$(d).html(n);$("a.rulelink").click(function(){var r=$(this).parent().parent().attr("id").substring(5);var i=a().getRuleEngine().getRule(r);b.ruleToForm(i);b.showForm(true);return false});feedbro.dndTable.create("rulelist",b.updateTable)}$("button#addrule").click(function(){b.resetForm();b.showSimulateForm(false);b.showForm(true);return false});$("button#testrules").click(function(){b.showForm(false);b.showSimulateForm(true);return false})};this.showSimulateForm=function(i){var k=$("div#rulesimulationform");var l=$(window);k.css({display:i?"block":"none",position:"absolute",top:Math.max(0,((l.height()-k.outerHeight())/2)+l.scrollTop())+"px",left:Math.max(0,((l.width()-k.outerWidth())/2)+l.scrollLeft())+"px"});if(i){$("textarea#simulationResult").val("");var h=$("select#simulationcontextvalue");var j="";var g=a().getFeedTree();g.processNodes(g.getRoot(),function(o){if(o.data.type==feedbro.FeedTree.FOLDER){j+='<optgroup label="'+e.escapeHtml(o.data.name)+'">';var n=o.children;for(var m=0;m<n.length;m++){j+='<option value="'+n[m].data.id+":"+o.data.id+'">'+e.escapeHtml(n[m].data.name)+"</option>"}j+="</optgroup>"}else{j+='<option value="'+o.data.id+':-1">'+e.escapeHtml(o.data.name)+"</option>"}},feedbro.FeedTree.MODE_TOPNODES);h.html(j)}};this.updateTable=function(g){$("tbody#rulelistbody tr").each(function(h,j){var l=$(j);var i=l.attr("id").substring(5);l.find("td.rownumber").html((h+1)+".");l.attr("data-order",(h+1));var k=a().getRuleEngine().getRule(i);k.order=h+1});a().getRuleEngine().sortRules();a().getRuleEngine().saveRules()};this.resetForm=function(){$("a#delete").css({display:"none"});$("input#ruleid").val("");$("input#enabled").prop("checked",true);$("input#fallthrough").prop("checked",true);$("input#name").val("");$("select#trigger").val("1");$("select#contexttype").val(1);b.setContextType(1);$("select#match").val(1);$("tr.condition").each(function(g,i){var h=$(i);if(h.attr("id")!="condtemplate"){h.remove()}});$("tr.action").each(function(g,i){var h=$(i);if(h.attr("id")!="actiontemplate"){h.remove()}})}};var feedbro=feedbro||{};feedbro.RumblePlugin=function(){};feedbro.RumblePlugin.prototype.setDebug=function(a){this._debug=a};feedbro.RumblePlugin.prototype.canParse=function(a){return a&&a.indexOf("https://rumble.com/c/")==0};feedbro.RumblePlugin.prototype.parse=function(e,c,a,f){var b=this;var d=new XMLHttpRequest();d.onerror=function(){a.error={};a.error.message="Network error";a.error.code=398;a.status=398};d.onreadystatechange=function(h){var g=h.target;if(g.readyState==4){g.onreadystatechange=null;if(g.status!=0){g.onerror=null}var j="";if(g.status==200){try{j=b.toRSS(g.responseText,e.url)}catch(i){}}c(e.url,g,j,a,f,true)}};d.open("GET",e.url,true);d.timeout=e.timeout?(e.timeout+0):10000;d.send()};feedbro.RumblePlugin.prototype.toRSS=function(q,g){var p=new feedbro.Strings();var C,B,u;var w,n;w={stag:["<title>"],etag:"</title>"};p.findNext(q,w);u=w.match;w={stag:["<main"],etag:"</main>"};p.findNext(q,w);n=w.match;var d=new DOMParser();var D=d.parseFromString(n,"text/html");var y,l,A,r,c,f,o,t,x,z,h,m=[],k=D.querySelectorAll("div.thumbnail__grid--item");for(y=0;y<k.length;y++){l=k[y];f=l.querySelector("img.thumbnail__image").getAttribute("src");c=f;o="";var j=f.match(/https:\/\/[\w\.]+\/([^.]+)/);if(j){c=("https://hugh.cdn.rumble.cloud/video/"+j[1]+".caa.mp4?u=3&b=0").replace("/s8/1/","/s8/2/")}z=l.querySelector("div.videostream__description");h=l.querySelector("time");if(h==null){continue}x='<div><div class="youtubevideo" data-link="'+p.escapeHref(c)+'"><img src="'+p.escapeHref(f)+'" class="thumb"><div class="play"></div></div></div>';A={title:l.querySelector("h3").innerText.trim(),author:u,publishedDate:new Date(h.getAttribute("datetime")),link:"https://rumble.com"+l.querySelector("a.title__link").getAttribute("href"),content:x};m.push(A)}d=null;D=null;return feedbro.Strings.toRSS(u+" | Rumble",g,m)};var feedbro=feedbro||{};feedbro.Settings=function(){var a={timeout:25000,maxentries:20,polldelay:30,onlyunread:false,itemmaxage:-1,dateformat:"ddd mmm dd yyyy HH:MM:ss",itemsortorder:1,inactivefeedlimit:180,filteriframe:false,filterembed:false,showcontent:true,hidenounread:false,sound:true,notifications:true,notificationtimeout:8000,viewmode:0,winleftpane:270,wintitles:500,confirmmarkread:false,confirmmarkreadmode:2,startpageallitems:false,theme:"light",markreadmode:1,iconclick:1,articlebodyfontsize:110,articlefontfamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Helvetica Neue", sans-serif',favicons:true,hideempty:false,popupclick:1,latestinpopup:true,mathjax:false,iconclickreloads:false,justifytext:false,faviconstitles:true,faviconfromline:false,qtag1:"",qtag2:"",qtag3:"",qtag4:"",qtag5:"",targetlanguage:"en",articlelink:1,lineheight:"1.45",updatethreads:4,disableautoscan:false,cookiemanagement:false,skipopmldupes:true,faviconprovider:"duckduckgo",truncatetitles:true,viewautoreload:0,articlewidth1:950,articlewidth2:900,articlewidth3:-1,articlewidth4:900,articlewidth5:900,articlewidth6:-1,titlefontsize:100,cardheight:450,disableautoselect:false,locale:"en_US",disableheaderlistener:false};this.getLocale=function(){return a.locale};this.setLocale=function(b){a.locale=b};this.getLocaleMeta=function(){return a.localemeta};this.setLocaleMeta=function(b){a.localemeta=b};this.getDisableAutoSelect=function(){return a.disableautoselect};this.setDisableAutoSelect=function(b){a.disableautoselect=b};this.setCardHeight=function(b){a.cardheight=parseInt(b,10)};this.getCardHeight=function(){return a.cardheight};this.setTitleFontSize=function(b){a.titlefontsize=parseInt(b,10)};this.getTitleFontSize=function(){return a.titlefontsize};this.getArticleWidth=function(b){return a["articlewidth"+b]};this.setArticleWidth=function(c,b){a["articlewidth"+c]=b};this.getDisableHeaderListener=function(){return a.disableheaderlistener};this.setDisableHeaderListener=function(b){a.disableheaderlistener=b};this.getIconClickReloads=function(){return a.iconclickreloads};this.setIconClickReloads=function(b){a.iconclickreloads=b};this.getTruncateTitles=function(){return a.truncatetitles};this.setTruncateTitles=function(b){a.truncatetitles=b};this.setQuickTag=function(b,c){if(b.indexOf("qtag")!=0){throw new Error("Invalid key: "+b)}a[b]=c};this.getQuickTag=function(b){return a[b]};this.setViewAutoReload=function(b){a.viewautoreload=parseInt(b,10)};this.getViewAutoReload=function(){return a.viewautoreload};this.setUpdateThreads=function(b){a.updatethreads=parseInt(b,10)};this.getUpdateThreads=function(){return a.updatethreads};this.setSkipOpmlDupes=function(b){a.skipopmldupes=b};this.getSkipOpmlDupes=function(){return a.skipopmldupes};this.setCookieManagement=function(b){a.cookiemanagement=b};this.getCookieManagement=function(){return a.cookiemanagement};this.setDisableAutoScan=function(b){a.disableautoscan=b};this.getDisableAutoScan=function(){return a.disableautoscan};this.setFaviconOnFromline=function(b){a.faviconfromline=b};this.getFaviconOnFromline=function(){return a.faviconfromline};this.setArticleLinkMode=function(b){a.articlelink=b};this.getArticleLinkMode=function(){return a.articlelink};this.setArticleLineHeight=function(b){a.lineheight=b};this.getArticleLineHeight=function(){return a.lineheight};this.setFavIconProvider=function(b){a.faviconprovider=b};this.getFavIconProvider=function(){return a.faviconprovider};this.setTargetLanguage=function(b){a.targetlanguage=b};this.getTargetLanguage=function(){return a.targetlanguage};this.setTheme=function(b){a.theme=b};this.getTheme=function(){return a.theme};this.setJustifyText=function(b){a.justifytext=b};this.getJustifyText=function(){return a.justifytext};this.setHideEmpty=function(b){a.hideempty=b};this.getHideEmpty=function(){return a.hideempty};this.setMathJaxEnabled=function(b){a.mathjax=b};this.getMathJaxEnabled=function(){return a.mathjax};this.setConfirmMarkReadMode=function(b){a.confirmmarkreadmode=parseInt(b,10)};this.getConfirmMarkReadMode=function(){return a.confirmmarkreadmode};this.setConfirmMarkRead=function(b){a.confirmmarkread=b};this.getConfirmMarkRead=function(){return a.confirmmarkread};this.setStartPageAllItems=function(b){a.startpageallitems=b};this.getStartPageAllItems=function(){return a.startpageallitems};this.setShowLatestInPopup=function(b){a.latestinpopup=b};this.getShowLatestInPopup=function(){return a.latestinpopup};this.setUseFavIcons=function(b){a.favicons=b};this.getUseFavIcons=function(){return a.favicons};this.setUseFavIconsTitles=function(b){a.faviconstitles=b};this.getUseFavIconsTitles=function(){return a.faviconstitles};this.setPopupClickMode=function(b){a.popupclick=parseInt(b,10)};this.getPopupClickMode=function(){return a.popupclick};this.setIconClickMode=function(b){a.iconclick=parseInt(b,10)};this.getIconClickMode=function(){return a.iconclick};this.setMarkReadMode=function(b){a.markreadmode=parseInt(b,10)};this.getMarkReadMode=function(){return a.markreadmode};this.setFeedTimeout=function(b){a.timeout=parseInt(b,10)};this.getFeedTimeout=function(){return a.timeout};this.setFeedMaxEntries=function(b){a.maxentries=parseInt(b,10)};this.getFeedMaxEntries=function(){return a.maxentries};this.setNavigatorWidth=function(b){a.winleftpane=parseInt(b,10)};this.getNavigatorWidth=function(){return a.winleftpane};this.setTitlesWidth=function(b){a.wintitles=parseInt(b,10)};this.getTitlesWidth=function(){return a.wintitles};this.setViewMode=function(b){a.viewmode=parseInt(b,10)};this.getViewMode=function(){return a.viewmode};this.setArticleFontFamily=function(b){a.articlefontfamily=b};this.getArticleFontFamily=function(){return a.articlefontfamily};this.setArticleBodyFontSize=function(b){a.articlebodyfontsize=parseInt(b,10)};this.getArticleBodyFontSize=function(){return a.articlebodyfontsize};this.setPollDelay=function(b){a.polldelay=parseInt(b,10)};this.getPollDelay=function(){return a.polldelay};this.setHideNoUnread=function(b){a.hidenounread=b};this.getHideNoUnread=function(){return a.hidenounread};this.setSoundEnabled=function(b){a.sound=b};this.getSoundEnabled=function(){return a.sound};this.setNotificationsEnabled=function(b){a.notifications=b};this.getNotificationsEnabled=function(){return a.notifications};this.setOnlyUnread=function(b){a.onlyunread=b};this.getOnlyUnread=function(){return a.onlyunread};this.setShowContent=function(b){a.showcontent=b};this.getShowContent=function(){return a.showcontent};this.setMaxItemAge=function(b){a.itemmaxage=parseInt(b,10)};this.getMaxItemAge=function(){return a.itemmaxage};this.setNotificationTimeout=function(b){a.notificationtimeout=parseInt(b,10)};this.getNotificationTimeout=function(){return a.notificationtimeout};this.setDateFormat=function(b){a.dateformat=b};this.getDateFormat=function(){return a.dateformat};this.setItemSortOrder=function(b){a.itemsortorder=b};this.getItemSortOrder=function(){return a.itemsortorder};this.setInactiveFeedLimit=function(b){a.inactivefeedlimit=b};this.getInactiveFeedLimit=function(){return a.inactivefeedlimit};this.setFilterIframe=function(b){a.filteriframe=b};this.getFilterIframe=function(){return a.filteriframe};this.setFilterEmbed=function(b){a.filterembed=b};this.getFilterEmbed=function(){return a.filterembed};this.toJson=function(){return JSON.stringify(a)};this.fromJson=function(b){$.extend(a,JSON.parse(b))}};var feedbro=feedbro||{};feedbro.SlidesharePlugin=function(){this._timeout=15000;this._strings=new feedbro.Strings();this._debug=false};feedbro.SlidesharePlugin.prototype.setDebug=function(a){this._debug=a};feedbro.SlidesharePlugin.prototype.canParse=function(a){return a&&a.indexOf("https://www.slideshare.net/search/slideshow?")!=-1};feedbro.SlidesharePlugin.prototype.parse=function(c,i,k,g){var j=this;var a={};try{a=this._strings.getQueryParams(new URL(c.url).search)}catch(e){}var h=new XMLHttpRequest();h.onerror=function(){k.error={};k.error.message="Network error";k.error.code=398;k.status=398};h.onreadystatechange=function(m){var l=m.target;if(l.readyState==4){l.onreadystatechange=null;if(l.status!=0){l.onerror=null}var o="";if(l.status==200){try{o=j.toRSS(l.responseText,c.url,a.q)}catch(n){}}i(c.url,l,o,k,g,true)}};var b=this.generateUUID();var f="**";var d="https://www.slideshare.net/search/slideshow_ajax?q="+encodeURIComponent(a.q)+"&qf=&qid="+b+"&escape=1&ud=week&ft=all&lang="+f;h.open("GET",d,true);h.timeout=c.timeout?(c.timeout+0):10000;h.setRequestHeader("Accept","application/json");h.send()};feedbro.SlidesharePlugin.prototype.generateUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){var b=Math.random()*16|0,a=d=="x"?b:(b&3|8);return a.toString(16)})};feedbro.SlidesharePlugin.prototype.toRSS=function(e,b,a){var j=[];var c=a+" | SlideShare Search";var f,g;if(e&&e!=""){var h=JSON.parse(e);var d=h.search_results;for(f=0;f<d.length;f++){g={title:d[f].title,link:"https://www.slideshare.net/"+d[f].url,publishedDate:new Date(d[f].created_at*1000),author:d[f].user_login,content:""};g.content='<table class="slideshare-result"><tr><td class="slideshare-thumb"><img class="slideshare-thumb-img" src="https:'+this._strings.escapeHref(d[f].thumb_url)+'"></td><td class="slideshare-description">'+feedbro.Strings.linkify(d[f].description)+"</td></tr></table>";j.push(g)}}return feedbro.Strings.toRSS(c,b,j)};var feedbro=feedbro||{};feedbro.SoundPlayer=function(){var b=this;var d=new feedbro.Strings();var a={};var e=[];var c;this.setSettings=function(f){c=f};this.queue=function(f){e.push(f)};this.playQueueUniques=function(){var f,g=d.removeDuplicates(e);for(f=0;f<g.length;f++){b.play(g[f])}e.length=0};this.playQueue=function(){for(var f=0;f<e.length;f++){b.play(e[f])}e.length=0};this.play=function(g){if(c.getSoundEnabled()!=true){return}var h=a[g];try{if(h==undefined){h=new Audio(g);a[g]=h;h.addEventListener("canplaythrough",function(){h.play()},false)}else{h.pause();h.currentTime=0;h.play()}}catch(f){}}};var feedbro=feedbro||{};feedbro.Strings=function(){};feedbro.Strings.regexpCache={};feedbro.Strings.wordCache={};feedbro.Strings.prototype.createProxyURL=function(b,c){var a="";if(b==undefined||c==undefined||c==0){return b}if(c==1){a="feedly"}if(b.indexOf("?")!=-1){return b+"&feedsrc="+a}else{return b+"?feedsrc="+a}};feedbro.Strings.toRSS=function(b,c,a){var d,f,g=[];g.push('<?xml version="1.0" encoding="UTF-8"?>\n<rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">\n<channel>\n');g.push("  <title><![CDATA[");g.push(b);g.push("]]></title>\n");g.push("  <link>");g.push((c||"").replace(/&/g,"&amp;"));g.push("</link>\n");g.push("  <description><![CDATA[");g.push(b);g.push("]]></description>\n");a.sort(function(h,e){if(h.publishedDate&&e.publishedDate){return e.publishedDate.getTime()-h.publishedDate.getTime()}else{return 0}});for(d=0;d<a.length;d++){f=a[d];g.push("  <item>\n");g.push("    <title><![CDATA[");g.push(f.title?f.title:"");g.push("]]></title>\n");g.push("    <link><![CDATA[");g.push(f.link);g.push("]]></link>\n");g.push("    <author><![CDATA[");g.push(f.author);g.push("]]></author>\n");if(f.guid){g.push("    <guid>");g.push(f.guid);g.push("</guid>\n")}g.push("    <content:encoded><![CDATA[");g.push(f.content);g.push("]]></content:encoded>\n");if(f.publishedDate&&!isNaN(f.publishedDate)){g.push("    <pubDate>");g.push(f.publishedDate+"");g.push("</pubDate>\n")}g.push("  </item>\n")}g.push("</channel>\n</rss>");return g.join("")};feedbro.Strings.convertHashtags=function(n,b){if(n==undefined||n==""){return n}var e,j,g=n.length;var o="";var k=0;var l=0;var a=false;var f;var d;var m;var h=false;for(e=0;e<g;e++){d=false;j=n.charAt(e);if(j=="<"){l++}else{if(j==">"){l--}else{if(j=="#"&&l==0){if(e>0&&n.charAt(e-1)=="&"){continue}else{a=true;h=true;f=e;continue}}}}if(a&&(j==" "||j=="<"||j=="!"||j==","||j=="."||j=='"'||j=="/"||j=="&"||j==">"||j=="?"||j==")"||j=="("||j=="]"||j=="["||j=="\n"||j=="\r")){d=true;a=false;if((e-f+1)>1){m=n.substring(f+1,e);o+=n.substring(k,f)+b(m);k=e}}}if(!h){return n}if(a){m=n.substring(f+1,e);o+=n.substring(k,f)+b(m)}else{o+=n.substring(k)}return o};feedbro.Strings.prototype.disableAutoplay=function(c){var b,a;return(c||"").replace(/<(video|iframe|audio)[^>]+?>/g,function(d,e){if(e=="video"||e=="audio"){if(!b){b=/(autoplay|preload|autostart)(="[^"]*")*/g}return d.replace(b,function(f,h,g){if(h=="autoplay"||h=="autostart"){return""}if(h=="preload"&&(g=='="auto"'||g=='=""'||g=="")){return'preload="meta"'}return f})}if(e=="iframe"){if(!a){a=/auto(play|start)/g}return d.replace(a,"enabled")}})};feedbro.Strings.linkify=function(e,c,b){if(e==undefined||e==""){return e}var d=/\b(https?|ftp):\/\/([a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|])/gim;var f=/\b(www\.[\S]+(\b|$))/gim;var a=/[\w.]+@[a-zA-Z_-]+?(?:\.[a-zA-Z]{2,6})+/gim;if(b==undefined){b=""}var g='<a rel="noopener noreferrer" class="'+b+'" target="_blank" href="$1://$2">$1://$2</a>';if(c){g='<a rel="noopener noreferrer" class="'+b+'" target="_blank" href="$1://$2">$2</a>'}return e.replace(d,g).replace(f,'$1<a rel="noopener noreferrer" class="'+b+'" target="_blank" href="http://$2">$2</a>').replace(a,'<a class="'+b+'" href="mailto:$&">$&</a>')};feedbro.Strings.prototype.getAttributeMap=function(p,k){var g,h,l,d={},b=false,e=false,f=false;var m,o,n,j;if(p==undefined){return d}h=p.length;for(g=0;g<h;g++){l=p.charAt(g);if(l==" "&&!b){b=true;continue}if(b&&!e&&!f){e=true;m=g;continue}if(b&&l=="="&&e){e=false;f=true;o=p.substring(m,g).trim();m=g+2;if(g+1<h){j=p.charAt(g+1);if(j!='"'&&j!="'"){j=" ";m=g+1}else{g++}}continue}if(b&&f&&(l==j||l==">")){n=p.substring(m,g);f=false;e=false;d[k?o.toLowerCase():o]=this.unescapeHtml(n);if(j!=" "){g++}}}return d};feedbro.Strings.prototype.getDatestamp=function(b){if(b==undefined){b=new Date()}var i=b.getFullYear();var f=b.getMonth()+1;var g=b.getDate();var e=b.getHours();var a=b.getMinutes();var c=b.getSeconds();return i+""+(f<10?"0"+f:f)+(g<10?"0"+g:g)+"-"+(e<10?"0"+e:e)+(a<10?"0"+a:a)+(c<10?"0"+c:c)};feedbro.Strings.prototype.timeAgo=function(e,a){var d=(new Date()-new Date(e))/1000;if(d<5){return Locale.i18n("timeago_now",true)}var b=0,c=feedbro.Strings.timeunits[b++];while(c){if(d<c.limit||!c.limit){d=Math.floor(d/c.in_seconds);if(a==true){return d+" "+Locale.i18n("timeago_"+c.name+"_shortName",true)}else{return d+" "+(d>1?Locale.i18n("timeago_"+c.name+"_plural",true):Locale.i18n("timeago_"+c.name,true))}}c=feedbro.Strings.timeunits[b++]}};feedbro.Strings.prototype.getDateTag=function(b){var c=new Date();var a=c.getTime();var e=new Date(b);var k=a-b;var l,g,h,j,i="dd.mm.";var d=24*60*60*1000;c.setMilliseconds(0);if(k<0){l=Locale.i18n("datetag_future_tag",true);i="dd.mm"}else{if(k<d&&e.getDate()==c.getDate()){l=Locale.i18n("datetag_today_tag",true);i="HH:MM"}else{if(k<(2*d)){c.setDate(c.getDate()-1);if(e.getDate()==c.getDate()){l=Locale.i18n("datetag_yesterday_tag",true);i="HH:MM"}}}}if(!l){c.setTime(a);var f=c.getDay();if(f===0){f=7}f--;c.setDate(c.getDate()-f);c.setHours(0);c.setMinutes(0);c.setSeconds(0);j=e.getTime()-c.getTime();if(j>0&&j<(7*d)){l=Locale.i18n("datetag_thisweek_tag",true);i="dd.mm."}else{c.setDate(c.getDate()-7);j=e.getTime()-c.getTime();if(j>0&&j<(7*d)){l=Locale.i18n("datetag_lastweek_tag",true)}}}if(!l){c.setTime(a);if(k<(31*d)&&c.getMonth()==e.getMonth()&&c.getFullYear()==e.getFullYear()){l=Locale.i18n("datetag_thismonth_tag",true)}else{c.setMonth(c.getMonth()-1);j=e.getTime()-c.getTime();if(c.getFullYear()==e.getFullYear()&&c.getMonth()==e.getMonth()){l=Locale.i18n("datetag_lastmonth_tag",true)}}}if(!l){c.setTime(a);g=e.getMonth();h=["January","February","March","April","May","June","July","August","September","October","November","December"];l=h[g];l=Locale.i18n("datetag_month_"+l+"_tag",true);if(e.getFullYear()!=c.getFullYear()){l+=" "+e.getFullYear()}}return{tag:l,format:i}};feedbro.Strings.prototype.isTextRTL=function(m,j,l){if(m==undefined){return false}var e,h,g=m.length;var a=0;var b=0;var k=false;var d=0;var f=0.4;if(l==undefined){l=30}if(j==undefined){j=false}for(e=0;e<g;e++){h=m.charAt(e);if(j&&k&&h==">"){k=false}else{if(j&&!k&&h=="<"){k=true}else{if(k){d++}else{if((h>="\u0591"&&h<="\u07FF")||(h>="\uFB1D"&&h<="\uFDFD")||(h>="\uFE70"&&h<="\uFEFC")||h=="\u200F"||h=="\u202B"||h=="\u202E"){a++;b++}else{b++}}}}if(b>0&&(b%l==0)&&a/b>f){return true}}return(b>0&&a/b>f)};feedbro.Strings.prototype.escapeHtmlChar=function(a){return feedbro.Strings.htmlEscapes[a]};feedbro.Strings.prototype.escapeHtml=function(b){var a=this;if(typeof b!="string"){b=String(b)}return b.replace(/[&<>"']/g,a.escapeHtmlChar)};feedbro.Strings.escapeHtml=function(a){if(typeof a!="string"){a=String(a)}return a.replace(/[&<>"']/g,function(b){return feedbro.Strings.htmlEscapes[b]})};feedbro.Strings.prototype.escapeHref=function(b){var a=this;if(typeof b!="string"){b=String(b)}return b.replace(/[<>"']/g,a.escapeHtmlChar)};feedbro.Strings.escapeHref=function(a){if(typeof a!="string"){a=String(a)}return a.replace(/[<>"']/g,function(b){return feedbro.Strings.htmlEscapes[b]})};feedbro.Strings.prototype.unescapeHtml=function(l,h){if(l==undefined||l.length<1){return l}if(h==undefined){h=0}if(h<0||h>l.length-1){throw new Error("unescapeHtml: firstAmp parameter out of range: "+h)}var g="";var f=l.length;var m=0;for(var e=h;e<f;e++){var k=l.charAt(e);if(k=="&"){var o=e+1;var a=l.indexOf(";",o);if(a==-1){continue}var d=l.indexOf("&",e+1);if(d!=-1&&d<a){continue}var b=l.substring(o,a);var n=-1;var p=b.length;if(p>0){if(b.charAt(0)=="#"){if(p>1){var q=b.charAt(1);try{if(q=="X"||q=="x"){n=parseInt(b.substring(2),16)}else{n=parseInt(b.substring(1),10)}if(n>65535){n=-1}}catch(j){n=-1}if(isNaN(n)){n=-1}}}else{n=feedbro.Strings.HTML[b];if(n==undefined){n=-1}}}if(n!=-1){g+=l.substring(m,e);g+=String.fromCharCode(n);m=a+1}e=a}}if(m<f){g+=l.substring(m,f)}return g};feedbro.Strings.prototype.isInt=function(a){return(/^[-+]?\d+$/).test(String(a))};feedbro.Strings.prototype.toDate=function(a){var b=new Date();b.setTime(a);return b};feedbro.Strings.prototype.sortIgnoreCase=function(a){a.sort(function(d,c){if(d==undefined||c==undefined){return 0}d=String(d).toLowerCase();c=String(c).toLowerCase();if(d==c){return 0}return d>c?1:-1})};feedbro.Strings.prototype.truncate=function(d,c,e){var a=d.length;if(a<=c){return d}var b=c-1;for(;b<a;b++){if(d.charAt(b)==" "){break}}return d.substring(0,b+1)+(e?e:"")};feedbro.Strings.prototype.fixTitle=function(k){if(k.content==undefined){return}try{if(k.title==undefined||(k.title.length<1||k.title.trim().length<1)){var d=k.content;var h=0;var e="";var a=false;var g;for(var b=0;b<d.length;b++){g=d.charAt(b);if(g=="<"){e+=d.substring(h,b)+" ";if(a&&e.trim().length>5){break}}if(g==">"){h=b+1}if(g=="?"||g=="!"||g=="."){a=true}}var l,j=0;if(e==""){l=k.content}else{l=e}for(;j<l.length;j++){g=l.charAt(j);if(j>5&&(g=="."||g=="!"||g=="?")){if(g=="!"||g=="?"){j++}break}}l=l.substring(0,j).trim();if(l==""||l.indexOf("http")==0){l="No title"}k.title=this.truncate(l,100,"...")}}catch(f){}};feedbro.Strings.htmlTextIgnore={script:true,svg:true,audio:true,video:true,head:true,iframe:true,figure:true,param:true,style:true,embed:true,object:true,canvas:true,applet:true,form:true,header:true,frameset:true,noscript:true,noframes:true,select:true,aside:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true,ul:true,ol:true,dl:true};feedbro.Strings.htmlTextNewline={p:true,div:true,blockquote:true};feedbro.Strings.prototype.htmlText=function(p,d,r){var m=0,o,q,b=-1,g=false,s,n,l,k,f,e=false;if(p==undefined){return undefined}var h=[];var a=0;if(d==undefined){d=10000}o=p.length;for(m=0;m<o;m++){q=p.charAt(m);if(q=="<"&&!g){if(b!=m&&b>=0){f=p.substring(b,m);h.push(f);e=false;a+=f.length;if(a>=d){break}}g=true;n=m;continue}if((q==" "||q==">")&&g){s=p.substring(n+1,m).toLowerCase();g=false;if(feedbro.Strings.htmlTextIgnore[s]){l=this.getHtmlBlockEndPosition(p,n);if(l!=-1&&l>m){m=l-1}}else{if(feedbro.Strings.htmlTextNewline[s]&&!e){h.push(" ");e=true}if(q==" "){k=p.indexOf(">",m);if(k!=-1){m=k}else{g=true;break}}}b=m+1;continue}if(m==0){b=0}}if(h.length==0&&b==0){if(p.length<d){return p}if(r){return p.substring(0,d)+r}else{return p.substring(0,d)}}if(!g&&b<o&&a<d){h.push(p.substring(b,o))}f=h.join("");if(f.length>d){f=f.substring(0,d)}if(r){f=f+r}return f};feedbro.Strings.prototype.removeDuplicates=function(e){if(e==undefined){return e}var a={};var d=[];for(var c=0;c<e.length;c++){var b=e[c];if(a[b]){continue}a[b]=1;d.push(b)}return d};feedbro.Strings.prototype.getQueryParams=function(a){a=a.split("+").join(" ");var d={},c,b=/[?&]?([^=]+)=([^&]*)/g;c=b.exec(a);while(c){d[decodeURIComponent(c[1])]=decodeURIComponent(c[2]);c=b.exec(a)}return d};feedbro.Strings.prototype.findImages=function(o,g,b,m){var n=/ (width|height|src)=["']([^"']+)["']/gi;var e={spos:0,stag:["<img"],etag:">"};var p,f,h,k,l,a,j=[],d;if(b==undefined){b=300}if(m==undefined){m=1920}while(true){this.findNext(o,e);if(e.match==undefined){break}n.lastIndex=0;p=e.match.match(n);if(p){l={s:undefined,w:undefined,h:undefined,size:0};for(f=0;f<p.length;f++){h=p[f];k=h.charAt(1);l[k]=h.substring(h.indexOf("=")+2,h.length-1)}l.size=(l.w||1)*(l.h||1);if(g==3){return[l]}if((l.w>=b&&l.w<=m)){if(d==undefined||l.w>d.w){d=l}}j.push(l);if(j.length>30){break}}}if(g==6&&d){return[d]}if(g==1||g==4){j.sort(function(i,c){return c.size-i.size})}if(g==2||g==5){j.sort(function(i,c){return i.size-c.size})}if(g==4||g==5){return[j[0]]}return j};feedbro.Strings.prototype.stripQuotesAll=function(a){if(a==undefined){return a}while(true){a=this.stripQuotes(a);if(a.length==0||(a.charAt(0)!='"'&&a.charAt(0)!="'"&&a.charAt(a.length-1)!='"'&&a.charAt(a.length-1)!="'")){break}}return a};feedbro.Strings.prototype.stripQuotes=function(e){if(e==undefined||e.length<1){return e}var d=0,c=e.length;if((e.charAt(d)=='"'||e.charAt(d)=="'")){d=d+1}if(e.charAt(c-1)=='"'||e.charAt(c-1)=="'"){c=c-1}if(d==0&&c==e.length-1){return e}else{return e.substring(d,c)}};feedbro.Strings.prototype.findNext=function(d,a){var e=a.spos;if(e==undefined){e=0}if(d==undefined||a.stag==undefined||a.etag==undefined){throw new Error("Invalid probe parameters")}for(var b=0;b<a.stag.length;b++){e=d.indexOf(a.stag[b],e);if(e<0){a.match=undefined;a.epos=-1;return a}e+=a.stag[b].length}var c=d.indexOf(a.etag,e);if(c<0){a.match=undefined;a.epos=-1;return a}a.epos=c;a.spos=e;a.match="";if(a.prefix!=undefined){a.match=a.prefix}a.match+=d.substring(e,c);if(a.postfix!=undefined){a.match+=a.postfix}return a};feedbro.Strings.prototype.extractContent=function(f,a,e,c){var g=a.spos;if(g==undefined){g=0}if(e){a.stag=e}if(c){a.etag=c}if(a.stag&&!Array.isArray(a.stag)){a.stag=[a.stag]}if(f==undefined||a.stag==undefined||a.etag==undefined){throw new Error("Invalid probe parameters")}for(var b=0;b<a.stag.length;b++){g=f.indexOf(a.stag[b],g);if(g<0){a.match=undefined;a.epos=-1;return null}g+=a.stag[b].length}var d=f.indexOf(a.etag,g);if(d<0){a.match=undefined;a.epos=-1;return null}a.epos=d;a.spos=g;a.match="";if(a.prefix!=undefined){a.match=a.prefix}a.match+=f.substring(g,d);if(a.postfix!=undefined){a.match+=a.postfix}return a.match};feedbro.Strings.prototype.replaceTokens=function(j,a,c,b){if(j==undefined||j==""){return j}var h;if(b!=undefined){h=feedbro.Strings.wordCache["_RT."+b]}if(h==undefined){var g=Object.keys(a);h="";for(var d=0;d<g.length;d++){var f=g[d];h+=f.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");if(d+1<g.length){h+="|"}}if(b!=undefined){feedbro.Strings.wordCache["_RT."+b]=h}}var e=this.getRegexp(h,c?"gi":"g");return j.replace(e,function(k){var i=k;var l=a[c?i.toLowerCase():i];if(l){return l}else{return i}})};feedbro.Strings.prototype.stripTags=function(a){return a!=undefined?a.replace(/<[^>]+>/ig,""):""};feedbro.Strings.stripStyleAttributes=function(a){return a!=undefined?a.replace(/(<[^\/]*?)( style="[^"]+"| style='[^']+')([^>]*>)/gi,"$1$3"):""};feedbro.Strings.prototype.inArray=function(d,a,c){if(a==undefined||d==undefined){return false}for(var b=0;b<a.length;b++){if(this.equals(a[b],d,c)){return true}}return false};feedbro.Strings.prototype.highlightItemContent=function(e,g,d){var c=this.getCachedRegExp(g,false,"mgi");if(e.content){var a,h=0,b=0,f=[];while((a=c.exec(e.content,h))){h=a.index+(a[0].length||1);if(!this.isInsideTagFast(e.content,a.index)){f.push(e.content.substring(b,a.index));f.push('<span class="'+d+'">'+a[0]+"</span>");b=h}}if(b!=0&&b!=e.content.length){f.push(e.content.substring(b,e.content.length))}if(b!=0){e.content=f.join("")}}};feedbro.Strings.prototype.isInsideTagFast=function(d,a){var b=a;for(;b>=0;b--){var e=d.charAt(b);if(e=="<"){return true}else{if(e==">"){return false}}}return false};feedbro.Strings.prototype.endsWith=function(c,b,a){if(c==undefined||b==undefined){return false}if(b.length>c.length){return false}if(b==""){return true}if(a==true){return c.substring(c.length-b.length).toLowerCase()==b.toLowerCase()}else{return c.indexOf(b,c.length-b.length)!==-1}};feedbro.Strings.prototype.startsWith=function(e,d,c){if(e==undefined||d==undefined){return false}if(d.length>e.length){return false}if(d==""){return true}if(c==true){return e.substring(0,d.length).toLowerCase()==d.toLowerCase()}else{var a=e.length;for(var b=0;b<d.length&&b<a;b++){if(e.charAt(b)!=d.charAt(b)){return false}}return true}};feedbro.Strings.prototype.getExtensionBaseUrl=function(){var a=new URL(document.location.href);return a.protocol+"//"+a.host};feedbro.Strings.prototype.beginsWith=function(e,d){if(e==undefined||d==undefined){return false}var b,c=d.length,a=e.length;if(c>a){return false}for(b=c-1;b>=0;b--){if(e.charAt(b)!=d.charAt(b)){return false}}return true};feedbro.Strings.prototype.switchTags=function(b,e,a){if(b==undefined||e==undefined){return undefined}if(a!=undefined&&a.indexOf("-")==-1){throw new Error("Invalid prefix: "+a+". It must contain a hyphen")}var d=Object.keys(e);var c=d.join("|");return b.replace(new RegExp("(<|</)("+c+")","gi"),function(f,h,g){if(a){return h+a+g}else{return h+e[g]}})};feedbro.Strings.prototype.reverseMap=function(f){var d=Object.keys(f);var e={};var b,c=d.length,g,a;for(b=0;b<c;b++){a=d[b];g=f[a];e[g]=a}return e};feedbro.Strings.prototype.containsWords=function(h,g,e){if(h==undefined||g==undefined){return false}if(g==""||g.length==0){return false}var f=this.getWordsRegexp(g,e);var d=f.regexp;var b;var a={};var c=0;while(true){b=d.exec(h);if(b==undefined||b.index<0){break}a[e?b[1].toLowerCase():b[1]]=1;d.lastIndex--;c++;if(c>1000){break}if(this.hashSize(a)==f.count){return true}}return this.hashSize(a)==f.count};feedbro.Strings.prototype.hashSize=function(b){var c,d=0;for(c in b){if(b.hasOwnProperty(c)){d++}}return d};feedbro.Strings.prototype.containsAnyWord=function(e,d,b){if(e==undefined||d==undefined){return false}if(d==""||d.length==0){return false}var c=this.getWordsRegexp(d,b);var a=c.regexp.exec(e);return(a!=undefined&&a.index>=0)};feedbro.Strings.prototype.doesNotContainWords=function(e,d,b){if(e==undefined||d==undefined){return true}if(d==""||d.length==0){return false}var c=this.getWordsRegexp(d,b);var a=c.regexp.exec(e);return(a==undefined||a.index<0)};feedbro.Strings.prototype.decodeHtmlEntities=function(a){if(a==undefined||a.length==0){return a}return a.replace(feedbro.Strings.REGEXDECODE,function(c,b,i,h,g,f,e){var d;if(b){d=b}else{if(h){d=parseInt(h,16)}else{if(f){d=feedbro.Strings.HTML[f];if(d!=undefined){d=parseInt(d,10)}}}}if(d!=undefined&&!isNaN(d)&&d>20){return String.fromCharCode(d)}else{return c}})};feedbro.Strings.prototype.getWordsRegexp=function(h,d){var k=h+"-"+d;var l=feedbro.Strings.wordCache[k];if(l==undefined){var c="(?:^|\\s|\\.|,)";var g="(?:\\s|\\.|\\,|\\!|\\?|\\(|\\)|\\'|\\\"|\\t|>|:|;|^)";var b="(?:\\s|\\.|\\,|\\!|\\?|\\(|\\)|\\'|\\\"|\\t|<|:|;|$)";var i=h.split(",");var f="";var a={};f+=g+"(";for(var e=0;e<i.length;e++){a[i[e]]=1;f+=i[e].replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");if(e+1<i.length){f+="|"}}f+=")"+b;l={regexp:new RegExp(f,d?"gi":"g"),count:this.hashSize(a)};feedbro.Strings.wordCache[k]=l}l.regexp.lastIndex=0;return l};feedbro.Strings.prototype.equals=function(c,b,a){if(c==undefined||b==undefined){return false}if(a==true){return(c.length==b.length&&c.toLowerCase()==b.toLowerCase())}else{return(c.length==b.length&&c==b)}};feedbro.Strings.prototype.splitTrim=function(d,c){if(d==undefined||c==undefined){return[d]}var a=d.split(c);for(var b=0;b<a.length;b++){a[b]=a[b].trim()}return a};feedbro.Strings.prototype.indexOf=function(c,d,b,a){if(c==undefined||d==undefined){return -1}if(d==""){return 0}if(d.length>c.length){return -1}if(a==true){return this.indexOfIgnoreCase(c,d,b,true)}else{return c.indexOf(d,b)}};feedbro.Strings.prototype.indexOfIgnoreCase=function(d,e,c){if(d==undefined||e==undefined){return -1}if(e==""){return 0}if(e.length>d.length){return -1}var b=this.getCachedRegExp(e,true);if(c!=undefined){b.lastIndex=c}var a=b.exec(d);return a?a.index:-1};feedbro.Strings.prototype.getProtocol=function(a){if(!a){return"http"}var b=a.indexOf(":");return b>0?a.substring(0,b):"http"};feedbro.Strings.prototype.parseDate=function(b){if(typeof b=="string"&&b.charAt(14)==" "&&b.charAt(11)==" "){b=b.substring(0,12)+"20"+b.substring(12)}var e=new Date(b);if(!isNaN(e)){return e}var c=b.split(" ");if(c[c.length-1].charAt(0)=="("){c.pop()}var a=c[c.length-1];if(feedbro.Strings.TIMEZONES[a]){c[c.length-1]=feedbro.Strings.TIMEZONES[a]}b=c.join(" ");return new Date(b)};feedbro.Strings.prototype.validateRegexp=function(b){try{this.getRegexp(b);return true}catch(a){return a.message}};feedbro.Strings.prototype.getRegexp=function(b,a){return this.getCachedRegExp(b,false,a?a:"g")};feedbro.Strings.prototype.getCachedRegExp=function(d,c,a){var b=feedbro.Strings.regexpCache[d+"-"+c+"-"+a];if(b==undefined){b=new RegExp(c?d.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"):d,a?a:"gi");feedbro.Strings.regexpCache[d]=b}else{b.lastIndex=0}return b};feedbro.Strings.prototype.stripHtmlBlock=function(e,f,g){var d=e.indexOf(f,g?g:0);if(d!=-1){var c=this.getHtmlBlockEndPosition(e,d);return e.substring(0,d)+e.substring(c)}else{return e}};feedbro.Strings.prototype.getHtmlBlockString=function(e,f,g){var d=e.indexOf(f,g?g:0);if(d!=-1){var c=this.getHtmlBlockEndPosition(e,d);return c!=-1?e.substring(d,c):""}else{return""}};feedbro.Strings.prototype.getHtmlBlockEndPosition=function(l,j){var d=j,f=l.length,g,b=false,e,m,h={},a,k;while(d<f){g=l.charAt(d);if(!b&&g=="<"){b=true;d++;e=d;continue}else{if(b&&(g==" "||g==">")){b=false;m=l.substring(e,d);if(k==undefined){k=m}if(m.charAt(0)=="/"){a=true;m=m.substring(1)}else{a=false}if(h[m]==undefined){h[m]=0}if(a){h[m]--}else{h[m]++}if(m==k&&h[m]==0){return d+1}}else{d++}}}return -1};feedbro.Strings.htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};feedbro.Strings.timeunits=[{name:"second",shortName:"s",limit:60,in_seconds:1},{name:"minute",shortName:"min",limit:3600,in_seconds:60},{name:"hour",shortName:"h",limit:86400,in_seconds:3600},{name:"day",shortName:"d",limit:604800,in_seconds:86400},{name:"week",shortName:"w",limit:2629743,in_seconds:604800},{name:"month",shortName:"mo",limit:31556926,in_seconds:2629743},{name:"year",shortName:"y",limit:null,in_seconds:31556926}];feedbro.Strings.TIMEZONES={A:"GMT+0100",ACDT:"GMT+1030",ACST:"GMT+0930",ACT:"GMT+1030",ACWST:"GMT+0845",ADT:"GMT-0300",AEDT:"GMT+1100",AEST:"GMT+1000",AET:"GMT+1100",AFT:"GMT+0430",AKDT:"GMT-0800",AKST:"GMT-0900",ALMT:"GMT+0600",AMST:"GMT+0500",AMT:"GMT+0400",ANAST:"GMT+1200",ANAT:"GMT+1200",AQTT:"GMT+0500",ART:"GMT-0300",AST:"GMT-0400",AT:"GMT-0400",AWDT:"GMT+0900",AWST:"GMT+0800",AZOST:"GMT+0000",AZOT:"GMT-0100",AZST:"GMT+0500",AZT:"GMT+0400",AoE:"GMT-1200",B:"GMT+0200",BNT:"GMT+0800",BOT:"GMT-0400",BRST:"GMT-0200",BRT:"GMT-0300",BST:"GMT+0100",BTT:"GMT+0600",C:"GMT+0300",CAST:"GMT+0800",CAT:"GMT+0200",CCT:"GMT+0630",CDT:"GMT-0400",CEST:"GMT+0200",CET:"GMT+0100",CHADT:"GMT+1345",CHAST:"GMT+1245",CHOT:"GMT+0800",CHUT:"GMT+1000",CKT:"GMT-1000",CLST:"GMT-0300",CLT:"GMT-0300",COT:"GMT-0500",CST:"GMT-0500",CT:"GMT-0600",CVT:"GMT-0100",CXT:"GMT+0700",ChST:"GMT+1000",D:"GMT+0400",DAVT:"GMT+0700",DDUT:"GMT+1000",E:"GMT+0500",EASST:"GMT-0500",EAST:"GMT-0500",EAT:"GMT+0300",ECT:"GMT-0500",EDT:"GMT-0400",EEST:"GMT+0300",EET:"GMT+0200",EGST:"GMT+0000",EGT:"GMT-0100",EST:"GMT-0500",ET:"GMT-0500",F:"GMT+0600",FET:"GMT+0300",FJST:"GMT+1300",FJT:"GMT+1200",FKST:"GMT-0300",FKT:"GMT-0400",FNT:"GMT-0200",G:"GMT+0700",GALT:"GMT-0600",GAMT:"GMT-0900",GET:"GMT+0400",GFT:"GMT-0300",GILT:"GMT+1200",GMT:"GMT+0000",GST:"GMT-0200",GYT:"GMT-0400",H:"GMT+0800",HADT:"GMT-0900",HAST:"GMT-1000",HKT:"GMT+0800",HOVT:"GMT+0700",I:"GMT+0900",ICT:"GMT+0700",IDT:"GMT+0300",IOT:"GMT+0600",IRDT:"GMT+0430",IRKST:"GMT+0900",IRKT:"GMT+0800",IRST:"GMT+0330",IST:"GMT+0200",JST:"GMT+0900",K:"GMT+1000",KGT:"GMT+0600",KOST:"GMT+1100",KRAST:"GMT+0800",KRAT:"GMT+0700",KST:"GMT+0900",KUYT:"GMT+0400",L:"GMT+1100",LHDT:"GMT+1100",LHST:"GMT+1030",LINT:"GMT+1400",M:"GMT+1200",MAGST:"GMT+1200",MAGT:"GMT+1000",MART:"GMT-0930",MAWT:"GMT+0500",MDT:"GMT-0600",MHT:"GMT+1200",MMT:"GMT+0630",MSD:"GMT+0400",MSK:"GMT+0300",MST:"GMT-0700",MT:"GMT-0700",MUT:"GMT+0400",MVT:"GMT+0500",MYT:"GMT+0800",N:"GMT-0100",NCT:"GMT+1100",NDT:"GMT-0230",NFT:"GMT+1130",NOVST:"GMT+0700",NOVT:"GMT+0600",NPT:"GMT+0545",NRT:"GMT+1200",NST:"GMT-0330",NUT:"GMT-1100",NZDT:"GMT+1300",NZST:"GMT+1200",O:"GMT-0200",OMSST:"GMT+0700",OMST:"GMT+0600",ORAT:"GMT+0500",P:"GMT-0300",PDT:"GMT-0700",PET:"GMT-0500",PETST:"GMT+1200",PETT:"GMT+1200",PGT:"GMT+1000",PHOT:"GMT+1300",PHT:"GMT+0800",PKT:"GMT+0500",PMDT:"GMT-0200",PMST:"GMT-0300",PONT:"GMT+1100",PST:"GMT-0800",PT:"GMT-0800",PWT:"GMT+0900",PYST:"GMT-0300",PYT:"GMT-0400",Q:"GMT-0400",QYZT:"GMT+0600",R:"GMT-0500",RET:"GMT+0400",ROTT:"GMT-0300",S:"GMT-0600",SAKT:"GMT+1000",SAMT:"GMT+0400",SAST:"GMT+0200",SBT:"GMT+1100",SCT:"GMT+0400",SGT:"GMT+0800",SRET:"GMT+1100",SRT:"GMT-0300",SST:"GMT-1100",SYOT:"GMT+0300",T:"GMT-0700",TAHT:"GMT-1000",TFT:"GMT+0500",TJT:"GMT+0500",TKT:"GMT+1300",TLT:"GMT+0900",TMT:"GMT+0500",TOT:"GMT+1300",TVT:"GMT+1200",U:"GMT-0800",ULAT:"GMT+0800",UTC:"GMT+0000",UYST:"GMT-0200",UYT:"GMT-0300",UZT:"GMT+0500",V:"GMT-0900",VET:"GMT-0430",VLAST:"GMT+1100",VLAT:"GMT+1000",VOST:"GMT+0600",VUT:"GMT+1100",W:"GMT-1000",WAKT:"GMT+1200",WARST:"GMT-0300",WAST:"GMT+0200",WAT:"GMT+0100",WEST:"GMT+0100",WET:"GMT+0000",WFT:"GMT+1200",WGST:"GMT-0200",WGT:"GMT-0300",WIB:"GMT+0700",WIT:"GMT+0900",WITA:"GMT+0800",WST:"GMT+0100",WT:"GMT+0000",X:"GMT-1100",Y:"GMT-1200",YAKST:"GMT+1000",YAKT:"GMT+0900",YAPT:"GMT+1000",YEKST:"GMT+0600",YEKT:"GMT+0500",Z:"GMT+0000"};feedbro.Strings.REGEXDECODE=/&#([0-9]+)(;?)|&#[xX]([a-fA-F0-9]+)(;?)|&(Aacute|iacute|Uacute|otilde|Otilde|Agrave|agrave|yacute|Yacute|oslash|Oslash|Atilde|atilde|Ccedil|ccedil|ograve|curren|divide|Eacute|eacute|Ograve|oacute|Egrave|egrave|ugrave|Ugrave|Oacute|Iacute|ntilde|Ntilde|uacute|middot|Igrave|igrave|iquest|aacute|THORN|micro|iexcl|icirc|Icirc|Acirc|ucirc|ecirc|Ocirc|ocirc|Ecirc|Ucirc|aring|Aring|aelig|AElig|acute|pound|acirc|thorn|szlig|cedil|Auml|ordf|ordm|uuml|macr|Uuml|auml|Ouml|ouml|para|nbsp|Euml|euml|yuml|cent|sect|Iuml|iuml|shy|eth|not|yen|ETH)(;?)/g;feedbro.Strings.HTML={quot:"34",amp:"38",lt:"60",gt:"62",apos:"39",nbsp:"160",iexcl:"161",cent:"162",pound:"163",curren:"164",yen:"165",brvbar:"166",sect:"167",uml:"168",copy:"169",ordf:"170",laquo:"171",not:"172",shy:"173",reg:"174",macr:"175",deg:"176",plusmn:"177",sup2:"178",sup3:"179",acute:"180",micro:"181",para:"182",middot:"183",cedil:"184",sup1:"185",ordm:"186",raquo:"187",frac14:"188",frac12:"189",frac34:"190",iquest:"191",Agrave:"192",Aacute:"193",Acirc:"194",Atilde:"195",Auml:"196",Aring:"197",AElig:"198",Ccedil:"199",Egrave:"200",Eacute:"201",Ecirc:"202",Euml:"203",Igrave:"204",Iacute:"205",Icirc:"206",Iuml:"207",ETH:"208",Ntilde:"209",Ograve:"210",Oacute:"211",Ocirc:"212",Otilde:"213",Ouml:"214",times:"215",Oslash:"216",Ugrave:"217",Uacute:"218",Ucirc:"219",Uuml:"220",Yacute:"221",THORN:"222",szlig:"223",agrave:"224",aacute:"225",acirc:"226",atilde:"227",auml:"228",aring:"229",aelig:"230",ccedil:"231",egrave:"232",eacute:"233",ecirc:"234",euml:"235",igrave:"236",iacute:"237",icirc:"238",iuml:"239",eth:"240",ntilde:"241",ograve:"242",oacute:"243",ocirc:"244",otilde:"245",ouml:"246",divide:"247",oslash:"248",ugrave:"249",uacute:"250",ucirc:"251",uuml:"252",yacute:"253",thorn:"254",yuml:"255",fnof:"402",Alpha:"913",Beta:"914",Gamma:"915",Delta:"916",Epsilon:"917",Zeta:"918",Eta:"919",Theta:"920",Iota:"921",Kappa:"922",Lambda:"923",Mu:"924",Nu:"925",Xi:"926",Omicron:"927",Pi:"928",Rho:"929",Sigma:"931",Tau:"932",Upsilon:"933",Phi:"934",Chi:"935",Psi:"936",Omega:"937",alpha:"945",beta:"946",gamma:"947",delta:"948",epsilon:"949",zeta:"950",eta:"951",theta:"952",iota:"953",kappa:"954",lambda:"955",mu:"956",nu:"957",xi:"958",omicron:"959",pi:"960",rho:"961",sigmaf:"962",sigma:"963",tau:"964",upsilon:"965",phi:"966",chi:"967",psi:"968",omega:"969",thetasym:"977",upsih:"978",piv:"982",bull:"8226",hellip:"8230",prime:"8242",Prime:"8243",oline:"8254",frasl:"8260",weierp:"8472",image:"8465",real:"8476",trade:"8482",alefsym:"8501",larr:"8592",uarr:"8593",rarr:"8594",darr:"8595",harr:"8596",crarr:"8629",lArr:"8656",uArr:"8657",rArr:"8658",dArr:"8659",hArr:"8660",forall:"8704",part:"8706",exist:"8707",empty:"8709",nabla:"8711",isin:"8712",notin:"8713",ni:"8715",prod:"8719",sum:"8721",minus:"8722",lowast:"8727",radic:"8730",prop:"8733",infin:"8734",ang:"8736",and:"8743",or:"8744",cap:"8745",cup:"8746","int":"8747",there4:"8756",sim:"8764",cong:"8773",asymp:"8776",ne:"8800",equiv:"8801",le:"8804",ge:"8805",sub:"8834",sup:"8835",sube:"8838",supe:"8839",oplus:"8853",otimes:"8855",perp:"8869",sdot:"8901",lceil:"8968",rceil:"8969",lfloor:"8970",rfloor:"8971",lang:"9001",rang:"9002",loz:"9674",spades:"9824",clubs:"9827",hearts:"9829",diams:"9830",OElig:"338",oelig:"339",Scaron:"352",scaron:"353",Yuml:"376",circ:"710",tilde:"732",ensp:"8194",emsp:"8195",thinsp:"8201",zwnj:"8204",zwj:"8205",lrm:"8206",rlm:"8207",ndash:"8211",mdash:"8212",lsquo:"8216",rsquo:"8217",sbquo:"8218",ldquo:"8220",rdquo:"8221",bdquo:"8222",dagger:"8224",Dagger:"8225",permil:"8240",lsaquo:"8249",rsaquo:"8250",euro:"8364"};var feedbro=feedbro||{};feedbro.TagFilter=function(){var a={"<object":'<span style="display: none" ',"object>":"span>","<script":'<span style="display: none" ',"script>":"span>","<applet":'<span style="display: none" ',"applet>":"span>","<style":'<span style="display: none" ',"style>":"span>","<link":'<span style="display: none" ',"link>":"span>","<meta":'<br style="display: none" ',"</meta>":'<br style="display: none">'};this.addTagFilter=function(b){a["<"+b]='<span style="display: none" ';a[b+">"]="span>"};this.filter=function(b){return b.replace(/(<object|object>|<script|script>|<applet|applet>|<iframe|iframe>|<embed|embed>|<link|link>|<style|style>|<meta|<\/meta>)/gi,function(c){var d=a[c.toLowerCase()];if(d){return d}else{return c}})}};var feedbro=feedbro||{};feedbro.TagSelect=function(){var k;var j=new feedbro.Strings();this.configure=function(o){k=o};this.createSelector=function(p,o){g(p,o)};this.destroy=function(){k=undefined};function g(p,o){p.attr("data-mode","view");p.append("<img src='../images/tagicon.png' class='tagicon'><div class='taglist'></div><div class='taginput hidden'><input type='text' class='taginputfield' spellcheck='false'><div class='tagadd'>+</div></div><div class='autocomplete hidden'></div>");p.click(e);m(p,o)}function e(o){switch(o.target.className){case"tagicon":a(o);break;case"removetag":i(o);break;case"tagadd":b(o);break;case"tagname":f(o);break;case"autocomplete-option":n(o);break;default:break}o.stopPropagation()}function d(p){if(p.keyCode==13){p.target.parentElement.querySelector(".tagadd").click()}if(p.keyCode==27){c({currentTarget:p.currentTarget.parentElement.parentElement})}else{if(p.keyCode==38||p.keyCode==40){var s=p.target.parentElement.parentElement.querySelector(".autocomplete");var t=s.querySelector(".autocomplete-option.active");var r;if(t==undefined){if(p.keyCode==38){r=s.lastChild}else{if(p.keyCode==40){r=s.firstChild}}}else{t.classList.remove("active");if(p.keyCode==38){r=t.previousSibling;if(r==undefined){r=s.lastChild}}else{if(p.keyCode==40){r=t.nextSibling;if(r==undefined){r=s.firstChild}}}}r.classList.add("active");r.scrollIntoView();p.target.parentElement.parentElement.querySelector("input").value=r.innerText;p.preventDefault()}else{var u=p.target.value;var o=$(p.target.parentElement.parentElement);if(u.length>=3){var q=k.autocomplete(u);if(q){l(q,o)}}else{l(undefined,o)}}}}function l(q,o){var t=o.find(".autocomplete");t.empty();if(q&&q.length>0){q.sort();var p=o.find("input");var u=p.position();var s,r="";for(s=0;s<q.length;s++){r+="<div class='autocomplete-option'>"+j.escapeHtml(q[s])+"</div>"}t.html(r);t.css({top:u.top+22,left:u.left});t.removeClass("hidden")}else{t.addClass("hidden")}}function n(p){var r=p.target.innerText;var o=p.target.parentElement.parentElement;var q=p.target.parentElement;q.classList.add("hidden");o.querySelector("input").value=r;o.querySelector(".tagadd").click()}function b(p){var q=(p.target.parentElement).querySelector("input");var u=q.value;if(u.trim()==""){return}var o=$(p.target.parentElement.parentElement);var t=o.find(".taglist");var r,s=t.find(".tagname");for(r=0;r<s.length;r++){if(s[r].innerText==u){q.value="";return}}t.append("<div class='tag'><span class='tagname'>"+j.escapeHtml(u)+"</span><span class='removetag'>x</span></div>");c(p);q.value="";k.add(o.attr("data-id"),u)}function i(p){var q=p.target.parentElement;var r=q.querySelector(".tagname").innerText;var o=$(q.parentElement.parentElement);q.remove();h(o,o.find(".taglist"));k.remove(o.attr("data-id"),r)}function m(r,o){var q,s,p="";if(o&&o.length>0){s=r.find(".taglist");s.empty();for(q=0;q<o.length;q++){p+="<div class='tag'><span class='tagname'>"+j.escapeHtml(o[q])+"</span><span class='removetag'>x</span></div>"}}if(p!=""){s.html(p)}}function f(o){k.search(o.target.innerText)}function c(p){var o=$(p.currentTarget);o.find(".taglist").removeClass("vertical");o.find(".taginput").addClass("hidden");o.find(".autocomplete").addClass("hidden");o.attr("data-mode","view")}function a(p){var r=$(p.target);var o=r.parent();if(o.attr("data-mode")=="view"){var s=o.find(".taglist");var q=o.find(".taginput input");h(o,s);o.find(".taginput").removeClass("hidden");q.focus();o.attr("data-mode","edit");if(q.attr("data-handler")!="true"){q.keyup(d);q.attr("data-handler","true");o.on("mouseleave",c)}}else{c(p)}}function h(o,p){var q=o.position();p.addClass("vertical");p.css({top:q.top-p.outerHeight(),left:q.left})}};var feedbro=feedbro||{};feedbro.TePlugin=function(){};feedbro.TePlugin.prototype.canParse=function(a){return a&&a.indexOf("https://t.me/")==0};feedbro.TePlugin.prototype.parse=function(f,d,a,g){var b=this;var e=new XMLHttpRequest();e.onerror=function(){a.error={};a.error.message="Network error";a.error.code=398;a.status=398};e.onreadystatechange=function(i){var h=i.target;if(h.readyState==4){h.onreadystatechange=null;if(h.status!=0){h.onerror=null}if(h.status==200){var j="";try{j=b.toRSS(h.responseText,f.url)}catch(k){feedbro.log("Failed to parse: "+f.url)}if(d){d(f.url,h,j,a,g,true)}}else{d(f.url,h,"",a,g,true)}}};var c=f.url;if(c.indexOf("https://t.me/s/")!=0){c=c.replace("t.me/","t.me/s/")}e.open("GET",c,true);e.timeout=20000;e.setRequestHeader("Cache-Control","no-cache");e.send()};feedbro.TePlugin.prototype.toRSS=function(k,h){var c=new DOMParser();var j=new feedbro.Strings();var u={audio:"x-audio",video:"x-video",source:"x-source",svg:"x-svg",style:"x-style",canvas:"x-canvas",script:"x-script"};k=j.switchTags(k,u);var w=c.parseFromString(k,"text/html");var q,r,t=w.querySelectorAll(".tgme_widget_message_wrap");var s,l=[];var g,p,m,f,o,b,v,d,a;var n=w.querySelector("title").innerText;for(q=0;q<t.length;q++){r=t[q];d=undefined;a=undefined;g=r.querySelector(".tgme_widget_message_owner_name > span");p=r.querySelector(".tgme_widget_message_text");v=r.querySelector(".tgme_widget_message_photo_wrap");m=r.querySelector(".tgme_widget_message_date > time");f=r.querySelector(".tgme_widget_message_date");o=r.querySelector(".tgme_widget_message_video_wrap");b=r.querySelector(".tgme_widget_message_video_thumb");if(v){d=this.getUrl(v)}if(b){a=this.getUrl(b)}if(p){p="<div class='telegram-post'>"+p.innerHTML+"</div>"}if(d){p="<div class='telegram-image'><img src='"+d+"'></div>"+(p||"")}if(o){o=o.querySelector("x-video");if(o&&a){p="<div class='telegram-video'><div class='youtubevideo' data-link='"+o.getAttribute("src")+"'><img src='"+a+"' class='thumb'><div class='play'></div></div></div>"+(p||"")}}p="<div class='telegram'>"+p+"</div>";if(m&&f){s={author:g?g.innerText:"",content:p,publishedDate:new Date(m.getAttribute("datetime")),link:f.getAttribute("href")};l.push(s)}}w=null;c=null;return feedbro.Strings.toRSS(n,h,l)};feedbro.TePlugin.prototype.getUrl=function(h){var g,d,f,c;g=h.getAttribute("style");d="background-image:url('";f=g.indexOf(d);c=g.indexOf("'",f+d.length+1);return g.substring(f+d.length,c)};var feedbro=feedbro||{};feedbro.Tw2Plugin=function(){this._strings=new feedbro.Strings();this._months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]};feedbro.Tw2Plugin.prototype.canParse=function(b){if(b==undefined||b==""){return false}b=this.mapUrl(b);var c=b.substring(0,20);var a=b.substring(20);return c=="https://twitter.com/"&&a!="explore"&&a!="search"&&a!="notifications"&&a!="home"&&a.indexOf("messages")!=0&&a.indexOf("i/bookmarks")!=0};feedbro.Tw2Plugin.prototype.mapUrl=function(a){if(a&&a.indexOf("https://x.com")==0){a=a.replace("//x.com/","//twitter.com/")}if(a&&a.substring(0,26)=="https://mobile.twitter.com"){a="https://twitter.com/"+a.substring(27)}return a};feedbro.Tw2Plugin.prototype.parse=function(c,h,j,f){var i=this;var g=new feedbro.FetchWrapper(200);var a=this.mapUrl(c.url);var e="";var b=a.match(/twitter\.com\/([\w_]+)/);if(b){e=b[1]}try{i.loadTwitterUser(e,c.maxEntries||20,c.datelimit,function(q){var o="";var p=null;if(q==null){i.fetchFailure(j,g)}else{var k,l,r=[];var m=/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim;try{for(k=0;k<q.length;k++){l=q[k];if(p==null&&l.user&&l.user.screen_name.toLowerCase()==e.toLowerCase()){p=l.user.name;e=l.user.screen_name}var s=i.getAuthorHeader(l.user,null,l);s+="<p class='tweet-text'>"+i.createTweetTextHtml(l)+"</p>";s+=i.getMedia(l);if(l.card){s+=i.createCardWithAttributes(l.card.binding_values,l.card.url)}if(l.quoted_tweet){s+=i.getQuoteHtml(l.quoted_tweet.user,i.createTweetTextHtml(l.quoted_tweet)+i.getMedia(l.quoted_tweet),l.quoted_tweet.created_at,l.quoted_tweet.id_str)}r.push({publishedDate:new Date(l.created_at),author:l.user.name,title:i._strings.truncate((l.text).replace(m,""),128,"&#x2026;"),content:s,link:"https://twitter.com/"+e+"/status/"+l.id_str})}}catch(n){i.fetchFailure(j,g)}o=feedbro.Strings.toRSS(p?p+" (@"+e+")":e+" | Twitter","https://twitter.com/"+e,r)}h(c.url,g,o?o:"",j,f,true)})}catch(d){g.status=500;j.error={};j.error.message="Internal Error";j.error.code=500;j.status=500;h(c.url,g,"",j,f,true)}};feedbro.Tw2Plugin.prototype.getSizeAttribute=function(a){if(a&&a.original_info){return"width='"+a.original_info.width+"' height='"+a.original_info.height+"' "}else{return""}};feedbro.Tw2Plugin.prototype.createTweetTextHtml=function(d){var c=d.text;c=c.replace(/#(\D\S+)/g,this.hashtagMapper);c=c.replace(/@(\w+)/g,this.usernameMapper);if(d.entities&&d.entities.urls&&d.entities.urls.length>0){var a,b=d.entities.urls;for(a=0;a<b.length;a++){c=c.replace(b[a].url,"<a class='twitter-tweet-link' target='_blank' rel='noopener noreferrer' href='"+b[a].expanded_url+"'>"+b[a].display_url+"</a>")}}return c};feedbro.Tw2Plugin.prototype.getMedia=function(g){if(g.mediaDetails&&g.mediaDetails.length>0){var f=g.mediaDetails[0];var e,b,d="";if(f.type=="photo"){b=this.getSizeAttribute(f);d="<div class='twitter-media-photo'><img alt='' class='twitter-media-photo' "+b+"src='"+f.media_url_https+"'></div>"}else{if((f.type=="video"||f.type=="animated_gif")&&f.video_info&&f.video_info.variants&&f.video_info.variants.length>0){var c=f.video_info.variants;var a=c[0];if(a.bitrate==undefined){a.bitrate=0}for(e=1;e<c.length;e++){if(c[e].bitrate>a.bitrate){a=c[e]}}b=this.getSizeAttribute(f);d='<div class="twitter-video">';d+='<div class="youtubevideo" data-link="'+a.url+'"><img alt="" src="'+f.media_url_https+'" '+b+' class="thumb"><div class="play"></div></div>';d+="</div>"}}return d}else{return""}};feedbro.Tw2Plugin.prototype.getDateTag=function(f,d,h){var b=new Date(f);if(isNaN(b)||d==null){return""}var c=this._months[b.getMonth()]+" "+b.getDate();var a=b.getHours(),e=b.getMinutes();var g=(a<10?"0"+a:a)+":"+(e<10?"0"+e:e)+" "+c+", "+b.getFullYear();return"<a class='twitter-timestamp' title='"+g+"' href='https://twitter.com/"+d.screen_name+"/status/"+h+"' target='_blank' rel='noopener noreferrer'>"+c+"</a>"};feedbro.Tw2Plugin.prototype.getQuoteHtml=function(a,c,d,e){var b="";b+="<div class='twitter-quoted-tweet'>";b+="  <div class='twitter-quoted-author'>";b+="    <img class='twitter-authorimage-quoted' alt='' src='"+a.profile_image_url_https+"'>";b+="    <span class='twitter-author-name-quoted'>"+a.name+"</span>";b+="    <span class='twitter-author-username-quoted'><a target='_blank' class='twitter-username' href='https://twitter.com/"+a.screen_name+"' rel='noopener noreferrer'>@"+a.screen_name+"</a></span>";b+="    <span class='twitter-timestamp-quoted'> &#183; "+this.getDateTag(d,a,e)+"</span>";b+="  </div>";b+="  <div class='twitter-quoted-content'>"+c+"</div>";b+="</div>";return b};feedbro.Tw2Plugin.prototype.createCardWithAttributes=function(b,f){var i,d,c,h,g;i="<div class='twitter-card'>";i+="<a target='_blank' rel='noopener noreferrer' class='twitter-card-url' href='"+f+"'>";if(b.photo_image_full_size){g=b.photo_image_full_size.image_value;d=g.url}else{if(b.photo_image_full_size_large){g=b.photo_image_full_size_large.image_value;d=g.url}else{if(b.photo_image_full_size_small){g=b.photo_image_full_size_small.image_value;d=g.url}}}if(b.thumbnail_image_large){h=b.thumbnail_image_large.image_value}else{if(b.thumbnail_image){h=b.thumbnail_image.image_value}}if(d){c="width='"+g.width+"' height='"+g.height+"'";i+="<div class='twitter-card-image'><img alt='' src='"+d+"' "+c+"></div>"}else{if(h){i+="<div class='twitter-thumb'><img alt='' class='twitter-thumb-image' src='"+h.url+"'></div>"}}if(b.title&&b.title.string_value){i+="<div class='twitter-card-title'>"+this._strings.escapeHtml(b.title.string_value)+"</div>"}if(b.description&&b.description.string_value){i+="<div class='twitter-card-description'>"+this._strings.escapeHtml(b.description.string_value)+"</div>"}if(b.domain){i+="<div class='twitter-card-url'>"+b.domain.string_value+"</div>"}i+="</a></div>";return i};feedbro.Tw2Plugin.prototype.getAuthorHeader=function(b,d,a){var c="<header>";if(d!=null){c+="  <div class='twitter-retweet-header'>"+d.name+" Retweeted</div>"}c+="  <a target='_blank' href='https://twitter.com/"+b.screen_name+"' rel='noopener noreferrer'>";c+="    <img class='twitter-authorimage' alt='' src='"+b.profile_image_url_https+"'>";c+="  </a><span class='twitter-fullname'>"+b.name+"</span>";c+="  <span><a target='_blank' class='twitter-username' href='https://twitter.com/"+b.screen_name+"' rel='noopener noreferrer'>@"+b.screen_name+"</a></span>";c+="</header>";return c};feedbro.Tw2Plugin.prototype.fetchFailure=function(a,b){a.error={};a.error.message="Network error";a.error.code=398;a.status=398;b.status=500};feedbro.Tw2Plugin.prototype.loadTwitterUser=function(f,d,c,e){var a=this;var b="";if(c!=0&&c!=null){b="when:7d+"}fetch("https://news.google.com/rss/search?q="+b+"site:twitter.com/"+f+"+%22%20on%20X:%22").then(function(g){return g.text()}).then(function(u){var h=new DOMParser();var r=h.parseFromString(u,"text/xml");var n=0,k=0;var l,s,q=r.querySelectorAll("item");var m=[];if(d==null){d=10}if(d>20){d=20}if(q.length>0){var o=[];for(l=0;l<q.length;l++){s=q[l];var j=new Date(s.querySelector("pubDate").textContent);if(c==null||j.getTime()>c){o.push(s)}}if(o.length>0&&d>0){o.sort(function(t,p){var i=new Date(t.querySelector("pubDate").textContent);var v=new Date(p.querySelector("pubDate").textContent);return v.getTime()-i.getTime()});n=Math.min(o.length,d);for(l=0;l<n;l++){s=o[l];var g=s.querySelector("link").textContent;a.loadGoogleNewsLink(g,function(t){k++;if(t!=null){try{var p=JSON.parse(t);if(p.__typename=="Tweet"&&p.tombstone==null&&p.in_reply_to_screen_name==null){m.push(p)}}catch(i){}}if(k>=n){m.sort(function(w,v){return v.created_at.localeCompare(w.created_at)});e(m)}})}}else{e([])}}else{e([])}})["catch"](function(g){e([])})};feedbro.Tw2Plugin.prototype.loadGoogleNewsLink=function(b,c){var a=this;fetch(b).then(function(d){return d.text()}).then(function(e){var d=e.match(/https:\/\/twitter.com\/\w+\/status\/(\d+)/);if(d){a.loadTweet(d[1],c)}else{c(null)}})["catch"](function(d){c(null)})};feedbro.Tw2Plugin.prototype.loadTweet=function(c,b){var a={headers:{accept:"*/*","accept-language":"en-US,en;q=0.9,fi-FI;q=0.8,fi;q=0.7","sec-ch-ua":'"Not A(Brand";v="99", "Google Chrome";v="121", "Chromium";v="121"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"cross-site"},referrer:"https://platform.twitter.com/",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"omit"};fetch("https://cdn.syndication.twimg.com/tweet-result?features=tfw_timeline_list%3A%3Btfw_follower_count_sunset%3Atrue%3Btfw_tweet_edit_backend%3Aon%3Btfw_refsrc_session%3Aon%3Btfw_fosnr_soft_interventions_enabled%3Aon%3Btfw_mixed_media_15897%3Atreatment%3Btfw_experiments_cookie_expiration%3A1209600%3Btfw_show_birdwatch_pivots_enabled%3Aon%3Btfw_duplicate_scribes_to_settings%3Aon%3Btfw_use_profile_image_shape_enabled%3Aon%3Btfw_video_hls_dynamic_manifests_15082%3Atrue_bitrate%3Btfw_legacy_timeline_sunset%3Atrue%3Btfw_tweet_edit_frontend%3Aon&id="+c+"&lang=en&token=495hrxy8l7r&8v66ky=5pty8wycz798&9v6xce=3x8ddolw1vft&wulxka=1m78fx7y2a5z&qxkhzc=6m2mm8d71w4r&jmfyqi=58x8jqbx624i",a).then(function(d){return d.text()}).then(b)["catch"](function(d){b(null)})};feedbro.Tw2Plugin.prototype.linkMapper=function(b,a){return"<a target='_blank' class='twitter-tweet-link' rel='noopener noreferrer' href='"+b+"'>"+a+"</a>"};feedbro.Tw2Plugin.prototype.hashtagMapper=function(a,b){return"<a target='_blank' class='twitter-hashtag' rel='noopener noreferrer' href='https://twitter.com/hashtag/"+b+"?src=hashtag_click'>#"+b+"</a>"};feedbro.Tw2Plugin.prototype.usernameMapper=function(b,a){return"<a target='_blank' class='twitter-username' rel='noopener noreferrer' href='https://twitter.com/"+a+"'>"+b+"</a>"};var feedbro=feedbro||{};feedbro.TwPlugin=function(){this._strings=new feedbro.Strings();this._months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]};feedbro.TwPlugin.authToken="AAAAAAAAAAAAAAAAAAAAANRILgAAAAAAnNwIzUejRCOuH5E6I8xnZz4puTs%3D1Zv7ttfk8LF81IUq16cHjhLTvJu4FA33AGWWjCpTnA";feedbro.TwPlugin.cachedToken=null;feedbro.TwPlugin.prototype.canParse=function(b){if(b==undefined||b==""){return false}b=this.mapUrl(b);var c=b.substring(0,20);var a=b.substring(20);return c=="https://twitter.com/"&&a!="notifications"&&a!="home"&&a.indexOf("messages")!=0&&a.indexOf("i/bookmarks")!=0};feedbro.TwPlugin.prototype.mapUrl=function(a){if(a&&a.substring(0,26)=="https://mobile.twitter.com"){a="https://twitter.com/"+a.substring(27)}return a};feedbro.TwPlugin.prototype.parse=function(d,c,a,e){var b=this;d.url=this.mapUrl(d.url);this.getCachedGuestToken(function(f){b.doParse(d,c,a,e)})};feedbro.TwPlugin.prototype.getCachedGuestToken=function(a){if(feedbro.TwPlugin.cachedToken==null||this.isTokenExpired(feedbro.TwPlugin.cachedToken)){this.getGuestToken(function(b){if(b&&b.token){feedbro.TwPlugin.cachedToken=b}else{feedbro.TwPlugin.cachedToken={remaining:0,init:0}}a(b)})}else{feedbro.TwPlugin.cachedToken.lastUse=new Date().getTime();a(feedbro.TwPlugin.cachedToken)}};feedbro.TwPlugin.prototype.getGuestToken=function(a){fetchTimeout("https://api.twitter.com/1.1/guest/activate.json",20000,{method:"POST",credentials:"omit",headers:{authorization:"Bearer "+feedbro.TwPlugin.authToken,"accept-language":"en-US,en;q=0.5",accept:"text/html,application/json,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"}}).then(function(b){return b.json()}).then(function(c){var b=new Date().getTime();if(c==null){c={}}a({token:c.guest_token,remaining:187,init:b,reset:b+(15*60*1000),lastUse:b})})["catch"](a)};feedbro.TwPlugin.prototype.isTokenExpired=function(b){var d=2*60*60*1000;var c=1*60*60*1000;var a=new Date().getTime();return b==null||b.init<(a-d)||b.remaining<10||a>b.reset||b.lastUse<(a-c)};feedbro.TwPlugin.prototype.doParse=function(f,d,a,g){var b=this;try{this.getUrl(f.url,a,function(l,j,h,k){try{if(j&&j.globalObjects){d(f.url,l,b.parseTweets(j,h,k),a,g,true)}else{d(f.url,l,b.parseTimeline(j,h,k),a,g,true)}}catch(i){d(f.url,l,"",a,g,true)}})}catch(c){var e=new feedbro.FetchWrapper(500);a.error={};a.error.message="Internal Server Error";a.error.code=500;a.status=500;d(f.url,e,"",a,g,true)}};feedbro.TwPlugin.prototype.getUserProfile=function(c,a,e){var d=c.match(/^https:\/\/twitter\.com\/([\w_]+)/)[1];var b="https://twitter.com/i/api/graphql/7mjxD3-C6BxitPMVQ6w0-Q/UserByScreenName?variables=%7B%22screen_name%22%3A%22"+d+"%22%2C%22withSafetyModeUserFields%22%3Atrue%2C%22withSuperFollowsUserFields%22%3Atrue%7D";this.loadJson(b,a,function(g,f){e(f,c)})};feedbro.TwPlugin.prototype.getThread=function(c,a,d){var b=this;this.getUserProfile(c,a,function(f,e){b.loadThread(e,f,a,d)})};feedbro.TwPlugin.prototype.loadThread=function(a,c,i,h){var f=0;var d=a.match(/status\/(\d+)/);if(d){f=d[1]}var e=0;if(c&&c.data&&c.data.user){if(c.data.user.result){e=c.data.user.result.rest_id}else{e=c.data.user.rest_id}}var b={focalTweetId:f,with_rux_injections:false,includePromotedContent:false,withCommunity:true,withQuickPromoteEligibilityTweetFields:true,withBirdwatchNotes:false,withSuperFollowsUserFields:true,withDownvotePerspective:false,withReactionsMetadata:false,withReactionsPerspective:false,withSuperFollowsTweetFields:true,withVoice:true,withV2Timeline:false,__fs_dont_mention_me_view_api_enabled:false,__fs_interactive_text_enabled:true,__fs_responsive_web_uc_gql_enabled:false};var g="https://twitter.com/i/api/graphql/LJ_TjoWGgNTXCl7gfx4Njw/TweetDetail?variables="+encodeURIComponent(JSON.stringify(b));this.loadJson(g,i,function(l,j){var k;if(c&&c.data&&c.data.user){if(c.data.user.result){k=c.data.user.result.legacy}else{if(c.data.user.legacy){k=c.data.user.legacy}}}if(k){h(l,j,a,e!=0?(k.name+" (@"+k.screen_name+") Thread "+f+" | Twitter"):"")}else{h(l,j,a,"Suspended")}})};feedbro.TwPlugin.prototype.loadUserTweets=function(c,e,a,g){var d=0;if(e&&e.data&&e.data.user){if(e.data.user.result){d=e.data.user.result.rest_id}else{d=e.data.user.rest_id}}var f={userId:d,count:40,includePromotedContent:false,withQuickPromoteEligibilityTweetFields:true,withSuperFollowsUserFields:true,withBirdwatchPivots:false,withDownvotePerspective:false,withReactionsMetadata:false,withReactionsPerspective:false,withSuperFollowsTweetFields:true,withVoice:true,withV2Timeline:false,__fs_interactive_text:false,__fs_dont_mention_me_view_api_enabled:false};var b="https://twitter.com/i/api/graphql/DhQ8lYnLh5T5K8aVUgHVnQ/UserTweets?variables="+encodeURIComponent(JSON.stringify(f));this.loadJson(b,a,function(j,h){var i;if(e&&e.data&&e.data.user){if(e.data.user.result){i=e.data.user.result.legacy}else{if(e.data.user.legacy){i=e.data.user.legacy}}}if(i){g(j,h,c,d!=0?(i.name+" (@"+i.screen_name+") | Twitter"):"")}else{g(j,h,c,"Suspended")}})};feedbro.TwPlugin.prototype.getUserTweets=function(c,a,d){var b=this;this.getUserProfile(c,a,function(f,e){b.loadUserTweets(e,f,a,d)})};feedbro.TwPlugin.prototype.getListTweets=function(d,a,f){var b=d.match(/^https:\/\/twitter\.com\/i\/lists\/(\d+)/)[1];var e={listId:b,count:20,withSuperFollowsUserFields:true,withBirdwatchPivots:false,withDownvotePerspective:false,withReactionsMetadata:false,withReactionsPerspective:false,withSuperFollowsTweetFields:true,__fs_interactive_text:false,__fs_dont_mention_me_view_api_enabled:false};var c="https://twitter.com/i/api/graphql/mwIBwcZV981Bnjb2lPNYfw/ListLatestTweetsTimeline?variables="+encodeURIComponent(JSON.stringify(e));this.loadJson(c,a,function(h,g){f(h,g,d,"List "+b)})};feedbro.TwPlugin.prototype.getHashtagTweets=function(g,d,i){var e=g.indexOf("hashtag/")+8;var c=g.indexOf("?",e);var h=g.substring(e,c>0?c:g.length);var f="https://api.twitter.com/2/search/adaptive.json?include_profile_interstitial_type=1&include_blocking=1&include_blocked_by=1&include_followed_by=1&include_want_retweets=1&include_mute_edge=1&include_can_dm=1&include_can_media_tag=1&skip_status=1&cards_platform=Web-12&include_cards=1&include_ext_alt_text=true&include_reply_count=1&tweet_mode=extended&include_entities=true&include_user_entities=true&include_ext_media_color=true&include_ext_media_availability=true&send_error_codes=true&simple_quoted_tweet=true&q=%23"+h+"&count=20&query_source=hashtag_click&pc=1&spelling_corrections=1&ext=mediaStats%2ChighlightedLabel%2CcameraMoment&include_quote_count=true";if(g.indexOf("&f=live")!=-1){f=f+"&tweet_search_mode=live"}this.loadJson(f,d,function(b,a){i(b,a,g,"#"+decodeURIComponent(h)+" - Search")})};feedbro.TwPlugin.prototype.getSearchTweets=function(g,d,i){var e=g.indexOf("q=")+2;var c=g.indexOf("&",e);var h=g.substring(e,c>0?c:g.length);var f="https://api.twitter.com/2/search/adaptive.json?include_profile_interstitial_type=1&include_blocking=1&include_blocked_by=1&include_followed_by=1&include_want_retweets=1&include_mute_edge=1&include_can_dm=1&include_can_media_tag=1&skip_status=1&cards_platform=Web-12&include_cards=1&include_ext_alt_text=true&include_reply_count=1&tweet_mode=extended&include_entities=true&include_user_entities=true&include_ext_media_color=true&include_ext_media_availability=true&send_error_codes=true&simple_quoted_tweet=true&q="+h+"&count=20&query_source=typed_query&pc=1&spelling_corrections=1&ext=mediaStats%2ChighlightedLabel%2CcameraMoment&include_quote_count=true";if(g.indexOf("&f=live")!=-1){f=f+"&tweet_search_mode=live"}this.loadJson(f,d,function(b,a){i(b,a,g,decodeURIComponent(h)+" - Search")})};feedbro.TwPlugin.prototype.getExploreTweets=function(c,a,d){var b="https://api.twitter.com/2/guide.json?include_profile_interstitial_type=1&include_blocking=1&include_blocked_by=1&include_followed_by=1&include_want_retweets=1&include_mute_edge=1&include_can_dm=1&include_can_media_tag=1&skip_status=1&cards_platform=Web-12&include_cards=1&include_ext_alt_text=true&include_reply_count=1&tweet_mode=extended&include_entities=true&include_user_entities=true&include_ext_media_color=true&include_ext_media_availability=true&send_error_codes=true&simple_quoted_tweet=true&include_page_configuration=true&count=20&ext=mediaStats%2ChighlightedLabel%2CcameraMoment&include_quote_count=true";this.loadJson(b,a,function(f,e){d(f,e,c,"Explore")})};feedbro.TwPlugin.prototype.loadJson=function(c,b,d){var a=new feedbro.FetchWrapper(500);fetchTimeout(c,20000,{method:"GET",credentials:"omit",headers:{authorization:"Bearer "+feedbro.TwPlugin.authToken,"accept-language":"en-US,en;q=0.5",accept:"*/*","x-guest-token":feedbro.TwPlugin.cachedToken?feedbro.TwPlugin.cachedToken.token:"","x-twitter-client-language":"en","x-twitter-active-user":"yes","cache-control":"no-cache"}}).then(function(e){a.status=e.status+0;if(e.status==200){if(feedbro.TwPlugin.cachedToken){feedbro.TwPlugin.cachedToken.remaining=parseInt(e.headers.get("x-rate-limit-remaining")||"0",10);feedbro.TwPlugin.cachedToken.reset=parseInt(e.headers.get("x-rate-limit-reset"),10)*1000}return e.json()}else{throw new Error(e.status+0)}}).then(function(e){d(a,e)})["catch"](function(e){if(e.name=="AbortError"){b.error={};b.error.message="Network error";b.error.code=398;b.status=398;a.status=0}d(a,null)})};feedbro.TwPlugin.prototype.getUrl=function(c,a,d){var b=c.substring(20);if(b.indexOf("i/lists/")==0){this.getListTweets(c,a,d)}else{if(b.indexOf("hashtag/")==0){this.getHashtagTweets(c,a,d)}else{if(b.indexOf("search?")==0){this.getSearchTweets(c,a,d)}else{if(b.indexOf("explore")==0){this.getExploreTweets(c,a,d)}else{if(b!="notifications"&&b.indexOf("messages")!=0&&b.indexOf("i/bookmarks")!=0){this.getUserTweets(c,a,d)}else{d(undefined)}}}}}};feedbro.TwPlugin.prototype.parseTweets=function(B,c,C){var t='<?xml version="1.0" encoding="UTF-8"?>\n<rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">\n<channel>\n';if(B!=undefined){var j=/#([A-Za-z][\w_]+)/g;var g=/@(\w+)/g;var r=/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim;var k=[];var b;var q=B.globalObjects.tweets;var n=B.globalObjects.users;var u,a,D,m=Object.keys(q);var y;var w;var p;var e;var s;var o;var f;var x;var A;var l;var h;var v;var z;m.sort(function(E,i){return new Date(q[i].created_at).getTime()-new Date(q[E].created_at).getTime()});try{for(u=0;u<m.length;u++){a=q[m[u]];x=a;if(a.source==0){continue}if(a.full_text.endsWith("↗️ Promoted")){continue}if(a.source&&String(a.source).indexOf("advertiser-interface")!=-1){continue}D=n[a.user_id_str];o=D;f=a.id_str;s=a.created_at;if(a.retweeted_status_id_str!=undefined){z=a.retweeted_status_id_str;a=q[z];D=n[a.user_id_str];q[z].source=0}A=undefined;e=undefined;if(a.is_quote_status){A=a.full_text;if(q[a.quoted_status_id_str]!=undefined){e=q[a.quoted_status_id_str];q[a.quoted_status_id_str].source=0}}y=undefined;w=undefined;v=this.getContent(a);y=v.card;w=v.media;p=this.getAuthorHeader(D,x.retweeted_status_id_str!=undefined?o:null,a);b={author:o.name+" (@"+o.screen_name+")",publishedDate:new Date(s),guid:o.screen_name+"-"+f,link:"https://twitter.com/"+o.screen_name+"/status/"+f,content:a.full_text,title:this._strings.truncate((A||a.full_text).replace(r,""),100,"&#x2026;")};if(b.title&&b.title.trim()==""){b.title="No Title"}b.content=this.createTweetTextHtml(a);b.content="<p class='tweet-text'>"+b.content+"</p>";if(w&&!y){b.content+=w}if(y){b.content+=y}if(e){h="";D=n[e.user_id_str];v=this.getContent(e);l=e.full_text;l=feedbro.Strings.linkify(l,true,"twitter-tweet-link");l=l.replace(j,this.hashtagMapper);l=l.replace(g,this.usernameMapper);h+="<div class='twitter-quoted-tweet'>";h+="  <div class='twitter-quoted-author'>";h+="    <img class='twitter-authorimage-quoted' src='"+D.profile_image_url_https+"'>";h+="    <span class='twitter-author-name-quoted'>"+D.name+"</span>";h+="    <span class='twitter-author-username-quoted'><a target='_blank' class='twitter-username' href='https://twitter.com/"+D.screen_name+"' rel='noopener noreferrer'>@"+D.screen_name+"</a></span>";h+="    <span class='twitter-timestamp-quoted'> &#183; "+this.getDateTag(e.created_at,D,e.id_str)+"</span>";h+="  </div>";h+="  <div class='twitter-quoted-content'>"+l+"</div>";if(v.media&&!v.card){h+=v.media}else{if(v.card){h+=v.card}}h+="</div>";b.content+=h}b.content=p+b.content;if(A){b.content+="</div>"}k.push(b)}}catch(d){}return feedbro.Strings.toRSS(C+" | Twitter",c,k)}else{t+="	<title>No Content Found</title>\n";t+="	<link>"+c.replace(/&/g,"&amp;")+"</link>\n"}t+="</channel>\n</rss>";return t};feedbro.TwPlugin.prototype.getSizeAttribute=function(a){if(a&&a.original_info){return"width='"+a.original_info.width+"' height='"+a.original_info.height+"' "}else{return""}};feedbro.TwPlugin.prototype.getContent=function(l){var f,d,a,h,g,b,m,c,k,i;if(l.extended_entities&&l.extended_entities.media){d=this.getMedia(l)}if(l.card&&l.card.binding_values&&l.card.name!="promo_website"){f=this.createCardWithAttributes(l.card.binding_values,l.card.url)}return{card:f,media:d}};feedbro.TwPlugin.prototype.linkMapper=function(b,a){return"<a target='_blank' class='twitter-tweet-link' rel='noopener noreferrer' href='"+b+"'>"+a+"</a>"};feedbro.TwPlugin.prototype.hashtagMapper=function(a,b){return"<a target='_blank' class='twitter-hashtag' rel='noopener noreferrer' href='https://twitter.com/hashtag/"+b+"?src=hashtag_click'>#"+b+"</a>"};feedbro.TwPlugin.prototype.usernameMapper=function(b,a){return"<a target='_blank' class='twitter-username' rel='noopener noreferrer' href='https://twitter.com/"+a+"'>"+b+"</a>"};feedbro.TwPlugin.prototype.parseTimeline=function(b,a,d){var c=this.parseTwitterTimeline(b,d);if(c.title==null&&a!=null){c.title=a.substring(a.lastIndexOf("/")+1)+" | Twitter"}return feedbro.Strings.toRSS(c.title||"User | Twitter",a||"",c.items)};feedbro.TwPlugin.prototype.parseTwitterTimeline=function(s,c){var l=[];var f,k;var e,g,q,d,b,m,a=c,p;if(s.data.user){if(s.data.user.result.timeline_v2){f=s.data.user.result.timeline_v2.timeline.instructions}else{f=s.data.user.result.timeline.timeline.instructions}}else{if(s.data.list){f=s.data.list.tweets_timeline.timeline.instructions}else{if(s.data.threaded_conversation_with_injections){f=s.data.threaded_conversation_with_injections.instructions}}}for(e=0;e<f.length;e++){k=f[e];if(k.entries){for(g=0;g<k.entries.length;g++){l.push(k.entries[g])}}else{if(k.entry&&k.type=="TimelinePinEntry"){l.push(k.entry)}}}var o=[];var n=/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim;for(e=0;e<l.length;e++){q=l[e];if(q.content.entryType=="TimelineTimelineItem"){if(q.content.itemContent.tweet_results==null){continue}b=q.content.itemContent.tweet_results.result;if(b==null||b.tombstone){continue}var h;if(b.core==null&&b.tweet&&b.tweet.legacy){d=b.tweet.core.user_results.result.legacy;h=b.tweet.legacy}else{if(b.core){d=b.core.user_results.result.legacy;h=b.legacy}else{continue}}if(h.retweeted_status_result){m=this.getRetweet(h.retweeted_status_result.result,d);if(h.retweeted_status_result.result.legacy==null){p=h.retweeted_status_result.result.tweet.legacy.full_text}else{p=h.retweeted_status_result.result.legacy.full_text}}else{m=this.getAuthorHeader(d,null,h);m+=this.getTweetBody(h)+this.getMedia(h)+this.getCard(b)+this.getQuote(b);p=h.full_text}if(p.endsWith("↗️ Promoted")){continue}p=this._strings.truncate(p.replace(n,""),100,"&#x2026;");if(p&&p.trim()==""){p="No Title"}var r={publishedDate:new Date(h.created_at),author:d.name+" (@"+d.screen_name+")",content:m,title:p,link:"https://twitter.com/"+d.screen_name+"/status/"+h.id_str};o.push(r);if(a==null){a=d.name+" (@"+d.screen_name+") | Twitter"}}}return{title:a,items:o}};feedbro.TwPlugin.prototype.createTweetTextHtml=function(d){var c=d.full_text;c=c.replace(/#(\D\S+)/g,this.hashtagMapper);c=c.replace(/@(\w+)/g,this.usernameMapper);if(d.entities&&d.entities.urls&&d.entities.urls.length>0){var a,b=d.entities.urls;for(a=0;a<b.length;a++){c=c.replace(b[a].url,"<a class='twitter-tweet-link' target='_blank' rel='noopener noreferrer' href='"+b[a].expanded_url+"'>"+b[a].display_url+"</a>")}}return c};feedbro.TwPlugin.prototype.getAuthorHeader=function(b,d,a){var c="<header>";if(d!=null){c+="  <div class='twitter-retweet-header'>"+d.name+" Retweeted</div>"}c+="  <a target='_blank' href='https://twitter.com/"+b.screen_name+"' rel='noopener noreferrer'>";c+="    <img class='twitter-authorimage' alt='' src='"+b.profile_image_url_https+"'>";c+="  </a><span class='twitter-fullname'>"+b.name+"</span>";c+="  <span><a target='_blank' class='twitter-username' href='https://twitter.com/"+b.screen_name+"' rel='noopener noreferrer'>@"+b.screen_name+"</a></span>";c+="</header>";return c};feedbro.TwPlugin.prototype.getDateTag=function(f,d,h){var b=new Date(f);if(isNaN(b)||d==null){return""}var c=this._months[b.getMonth()]+" "+b.getDate();var a=b.getHours(),e=b.getMinutes();var g=(a<10?"0"+a:a)+":"+(e<10?"0"+e:e)+" "+c+", "+b.getFullYear();return"<a class='twitter-timestamp' title='"+g+"' href='https://twitter.com/"+d.screen_name+"/status/"+h+"' target='_blank' rel='noopener noreferrer'>"+c+"</a>"};feedbro.TwPlugin.prototype.getRetweet=function(a,d){if(a==null||a.core==null||a.core.user_results==null||a.core.user_results.result==null||a.core.user_results.result.legacy==null||a.legacy==null||a.tombstone||a.legacy.tombstone){return"<div class='twitter-deleted-tweet'>This tweet is not available.</div>"}var c=a.core.user_results.result.legacy;var b=a.legacy;return this.getAuthorHeader(c,d,b)+this.getTweetBody(b)+this.getMedia(b)+this.getCard(a)+this.getQuote(a)};feedbro.TwPlugin.prototype.getQuote=function(e){if(e.quoted_status_result){var a=e.quoted_status_result;if(a.result.tombstone){return"<div class='twitter-quoted-tweet'>This tweet was deleted by the Tweet author.</div>"}else{var c,b;if(a.result.core==null){c=a.result.tweet.core.user_results.result.legacy;b=a.result.tweet.legacy}else{c=a.result.core.user_results.result.legacy;b=a.result.legacy}var d=this.createTweetTextHtml(b)+this.getMedia(b);return this.getQuoteHtml(c,d,b.created_at,b.id_str)}}else{return""}};feedbro.TwPlugin.prototype.getQuoteHtml=function(a,c,d,e){var b="";b+="<div class='twitter-quoted-tweet'>";b+="  <div class='twitter-quoted-author'>";b+="    <img class='twitter-authorimage-quoted' alt='' src='"+a.profile_image_url_https+"'>";b+="    <span class='twitter-author-name-quoted'>"+a.name+"</span>";b+="    <span class='twitter-author-username-quoted'><a target='_blank' class='twitter-username' href='https://twitter.com/"+a.screen_name+"' rel='noopener noreferrer'>@"+a.screen_name+"</a></span>";b+="    <span class='twitter-timestamp-quoted'> &#183; "+this.getDateTag(d,a,e)+"</span>";b+="  </div>";b+="  <div class='twitter-quoted-content'>"+c+"</div>";b+="</div>";return b};feedbro.TwPlugin.prototype.getCard=function(b){if(b.card&&!b.quoted_status_result&&b.card.name!="promo_website"){var e=b.card;var f,d,c=b.card.legacy.binding_values,a={};for(f=0;f<c.length;f++){d=c[f];a[d.key]=d.value}return this.createCardWithAttributes(a,e.legacy.url)}else{return""}};feedbro.TwPlugin.prototype.createCardWithAttributes=function(b,f){var i,d,c,h,g;i="<div class='twitter-card'>";i+="<a target='_blank' rel='noopener noreferrer' class='twitter-card-url' href='"+f+"'>";if(b.photo_image_full_size){g=b.photo_image_full_size.image_value;d=g.url}else{if(b.photo_image_full_size_large){g=b.photo_image_full_size_large.image_value;d=g.url}else{if(b.photo_image_full_size_small){g=b.photo_image_full_size_small.image_value;d=g.url}}}if(b.thumbnail_image_large){h=b.thumbnail_image_large.image_value}else{if(b.thumbnail_image){h=b.thumbnail_image.image_value}}if(d){c="width='"+g.width+"' height='"+g.height+"'";i+="<div class='twitter-card-image'><img alt='' src='"+d+"' "+c+"></div>"}else{if(h){i+="<div class='twitter-thumb'><img alt='' class='twitter-thumb-image' src='"+h.url+"'></div>"}}if(b.title&&b.title.string_value){i+="<div class='twitter-card-title'>"+this._strings.escapeHtml(b.title.string_value)+"</div>"}if(b.description&&b.description.string_value){i+="<div class='twitter-card-description'>"+this._strings.escapeHtml(b.description.string_value)+"</div>"}if(b.domain){i+="<div class='twitter-card-url'>"+b.domain.string_value+"</div>"}i+="</a></div>";return i};feedbro.TwPlugin.prototype.getTweetBody=function(a){return"<p class='tweet-text'>"+this.createTweetTextHtml(a)+"</p>"};feedbro.TwPlugin.prototype.getMedia=function(g){if(g.extended_entities&&g.extended_entities.media){var f=g.extended_entities.media[0];var e,b,d="";if(f.type=="photo"){b=this.getSizeAttribute(f);d="<div class='twitter-media-photo'><img alt='' class='twitter-media-photo' "+b+"src='"+f.media_url_https+"'></div>"}else{if((f.type=="video"||f.type=="animated_gif")&&f.video_info&&f.video_info.variants&&f.video_info.variants.length>0){var c=f.video_info.variants;var a=c[0];if(a.bitrate==undefined){a.bitrate=0}for(e=1;e<c.length;e++){if(c[e].bitrate>a.bitrate){a=c[e]}}b=this.getSizeAttribute(f);d="<div>";d+='<div class="youtubevideo" data-link="'+a.url+'"><img alt="" src="'+f.media_url_https+'" '+b+' class="thumb"><div class="play"></div></div>';d+="</div>"}}return d}else{return""}};feedbro.TwPlugin.prototype.testParse=function(b,c){var a=this;fetch(b).then(function(d){return d.json()}).then(function(d){c(a.parseTimeline(d),a.parseTimelineHtml(d))})};feedbro.TwPlugin.prototype.parseTimelineHtml=function(d,a){var e=this.parseTwitterTimeline(d);var c,b=[];for(c=0;c<e.items.length;c++){b.push(e.items[c].content)}return b.join("")};var feedbro=feedbro||{};feedbro.VkPlugin=function(){};feedbro.VkPlugin.prototype.setDebug=function(a){this._debug=a};feedbro.VkPlugin.prototype.canParse=function(a){return a&&a.indexOf("https://vk.com")==0};feedbro.VkPlugin.prototype.parse=function(e,c,a,f){var b=this;var d=new XMLHttpRequest();d.onerror=function(){a.error={};a.error.message="Network error";a.error.code=398;a.status=398};d.onreadystatechange=function(h){var g=h.target;if(g.readyState==4){g.onreadystatechange=null;if(g.status!=0){g.onerror=null}var j="";if(g.status==200){try{j=b.toRSS(g.responseText,e.url)}catch(i){}}c(e.url,g,j,a,f,true)}};d.open("GET",e.url,true);d.timeout=e.timeout?(e.timeout+0):10000;d.setRequestHeader("Cache-Control","no-cache");d.send()};feedbro.VkPlugin.prototype.toRSS=function(p,g){var v={stag:['<div class="_post_content">'],etag:'<div class="like_cont',postfix:'"></div></div></div>'};var o=new feedbro.Strings();var d=new DOMParser();var E,e,h,G,y,j,q,H,u,D,x;var a="https://vk.com";var A=/(\w+) (hour|minute)s* ago/;var c=/(yesterday|today) at (\d{1,2}):(\d{2}) (\w{2})/;var l=/(\d{1,2}) (\w{3}) at (\d{1,2}):(\d{2}) (\w{2})/;var f=/(\d{1,2}) (\w{3}) (\d{4})/;var k=/(onclick|onmouseover)="[^"]+"/g;var C=/(href|src)="\//g;var F=/<a /g;var i={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11};var z={one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10};var n=[];var t="VK";var B=new XMLSerializer();var m;while(true){o.findNext(p,v);if(v.match==undefined){break}m=v.match;m=m.replace(new RegExp(" (src|srcset|rel|onload|preload|autoplay)=","gi")," data-$1=");m=o.switchTags(m,feedbro.ClearBody.tagFlipMap);E=d.parseFromString(m,"text/html");var r=E.querySelector("button.PostTextMore");if(r){r.remove()}r=E.querySelector("div.media_voting");if(r){r.remove()}y=E.querySelector("div.wall_text");e=E.querySelector("span.PostHeaderTitle__authorName");H=E.querySelector("a.AvatarRich > img");h=E.querySelector("a.PostHeaderSubtitle__link");D=E.querySelector("time.PostHeaderSubtitle__item");x=D.getAttribute("time");G=D.innerText.replace(/\u00a0/g," ");if(u){u=a+u.getAttribute("href")}if(H){H=H.getAttribute("src")}t=e.innerText+" | VK";var b={author:e.innerText,link:a+h.getAttribute("href")};try{b.content=B.serializeToString(y)}catch(w){b.content=y.innerHTML+""}b.content=b.content.replace(new RegExp(" data-(src|srcset|rel|onload|preload|autoplay)=","gi")," $1=");b.content=o.switchTags(b.content,o.reverseMap(feedbro.ClearBody.tagFlipMap));b.content=b.content.replace(k,"");b.content=b.content.replace(F,"<a target='_blank' rel='noopener noreferrer' ");b.content=b.content.replace(C,'$1="'+a+"/");b.content="<div class='vk-content'>"+b.content+"</div>";q=new Date();j=A.exec(G);if(j){if(z[j[1]]!=null){q.setTime(q.getTime()-z[j[1]]*(60*60000))}else{q.setTime(q.getTime()-parseInt(j[1])*60000)}b.publishedDate=q}else{j=c.exec(G);if(x!=undefined&&x!=""){q.setTime(parseInt(x,10)*1000);q.setSeconds(0);q.setMilliseconds(0);b.publishedDate=q}else{if(j){if(j[1]=="yesterday"){q.setDate(q.getDate()-1)}q.setHours(parseInt(j[2],10));q.setMinutes(parseInt(j[3],10));q.setSeconds(0);q.setMilliseconds(0);if(j.length>=5&&j[4]=="pm"){q.setHours(q.getHours()+12)}b.publishedDate=q}else{j=l.exec(G);if(j){q.setDate(parseInt(j[1],10));q.setMonth(i[j[2]]);q.setHours(parseInt(j[3],10));q.setMinutes(parseInt(j[4],10));q.setSeconds(0);q.setMilliseconds(0);if(j[5]=="pm"){q.setHours(q.getHours()+12)}b.publishedDate=q}else{j=f.exec(G);if(j){q.setDate(parseInt(j[1],10));q.setMonth(i[j[2]]);q.setFullYear(parseInt(j[3],10));q.setHours(0);q.setMinutes(0);q.setSeconds(0);q.setMilliseconds(0);b.publishedDate=q}}}}}n.push(b)}d=null;B=null;return feedbro.Strings.toRSS(t,g,n)};var feedbro=feedbro||{};feedbro.XmlDocumentWrapper=function(){};feedbro.XmlDocumentWrapper.prototype.trash=function(){this.xmldoc=null;this.domParser=null;this.nsResolver=null;this.nsReverseResolver=null};feedbro.XmlDocumentWrapper.prototype.createNSResolvers=function(){var b=this.getRootNode();var a=b.attributes;var d,e=a.length,f,c;this.nsResolver={};this.nsReverseResolver={};for(d=0;d<e;d++){if(a[d].name.indexOf("xmlns")==0){c=a[d].nodeValue+"";f=a[d].name.substring(6);this.nsResolver[f]=c;this.nsReverseResolver[c]=f}}};feedbro.XmlDocumentWrapper.reverseResolver={"http://www.w3.org/2005/Atom":"atom","http://purl.org/dc/elements/1.1/":"dc","http://purl.org/rss/1.0/modules/content/":"content","http://www.w3.org/1998/Math/MathML":"mathml","http://search.yahoo.com/mrss/":"media","http://www.w3.org/1999/02/22-rdf-syntax-ns#":"rdf","http://webns.net/mvcb/":"admin","http://purl.org/rss/1.0/":"rss10","http://purl.oclc.org/net/rss_2.0/enc#":"enc","http://prismstandard.org/namespaces/basic/2.0/":"prism","http://www.w3.org/1999/xhtml":"xhtml","http://purl.org/atom/ns#":"atom03","http://www.youtube.com/xml/schemas/2015":"yt","http://my.netscape.com/rdf/simple/0.9/":"rss09"};feedbro.XmlDocumentWrapper.prototype.translateNodeName=function(d){var b=d.indexOf(":");var c="";if(b!=0){c=d.substring(0,b)}var a=this.nsReverseResolver[this.standardNSResolver(c)];return a!=undefined?a+(a.length>0?":":"")+d.substring(b+1):d};feedbro.XmlDocumentWrapper.prototype.mapNodeName=function(d){var b=d.indexOf(":");var c="";if(b!=0){c=d.substring(0,b)}var a=feedbro.XmlDocumentWrapper.reverseResolver[this.nsResolver[c]];return a?a+":"+d.substring(b+1):d};feedbro.XmlDocumentWrapper.prototype.parse=function(a){if(this.domParser==undefined){this.domParser=new DOMParser()}this.setDocument(this.domParser.parseFromString(a,"text/xml"));var b=this.xmldoc.getElementsByTagName("parsererror");if(b&&b.length>0){throw b[0].innerText+""}return this.xmldoc};feedbro.XmlDocumentWrapper.prototype.setDocument=function(a){this.xmldoc=a;this.createNSResolvers()};feedbro.XmlDocumentWrapper.prototype.standardNSResolver=function(a){switch(a){case"atom":return"http://www.w3.org/2005/Atom";case"atom03":return"http://purl.org/atom/ns#";case"dc":return"http://purl.org/dc/elements/1.1/";case"content":return"http://purl.org/rss/1.0/modules/content/";case"mathml":return"http://www.w3.org/1998/Math/MathML";case"media":return"http://search.yahoo.com/mrss/";case"rdf":return"http://www.w3.org/1999/02/22-rdf-syntax-ns#";case"admin":return"http://webns.net/mvcb/";case"rss10":return"http://purl.org/rss/1.0/";case"rss09":return"http://my.netscape.com/rdf/simple/0.9/";case"enc":return"http://purl.oclc.org/net/rss_2.0/enc#";case"prism":return"http://prismstandard.org/namespaces/basic/2.0/";case"xhtml":return"http://www.w3.org/1999/xhtml";case"yt":return"http://www.youtube.com/xml/schemas/2015";default:return null}};feedbro.XmlDocumentWrapper.prototype.getRootNode=function(){return this.xmldoc.documentElement};feedbro.XmlDocumentWrapper.prototype.getNode=function(c,b){var a;try{a=this.xmldoc.evaluate(c,b?b:this.xmldoc,this.standardNSResolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null)}catch(d){}return a?a.singleNodeValue:undefined};feedbro.XmlDocumentWrapper.prototype.getNodeListIterator=function(b,a){try{return this.xmldoc.evaluate(b,a?a:this.xmldoc,this.standardNSResolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null)}catch(c){return undefined}};feedbro.XmlDocumentWrapper.prototype.getAttribute=function(b,a,c){var d=this.getNode(b,a);if(!d){return undefined}return d.getAttribute(c)};feedbro.XmlDocumentWrapper.prototype.getString=function(c,b){var a;try{a=this.xmldoc.evaluate(c,b?b:this.xmldoc,this.standardNSResolver,XPathResult.STRING_TYPE,null)}catch(d){}if(a){return a.stringValue}else{return undefined}};feedbro.XmlDocumentWrapper.prototype.getChildString=function(c,a){var b=this.getChild(c,a);return b?(b.textContent+""):undefined};feedbro.XmlDocumentWrapper.prototype.getChild=function(d,a){if(d.indexOf("/")==-1){return this.getChildSingle(d,a)}else{var c,b=d.split("/");for(c=0;c<b.length;c++){a=this.getChildSingle(b[c],a);if(a==undefined){return undefined}}return a}};feedbro.XmlDocumentWrapper.prototype.getChildSingle=function(d,a){if(a==undefined){a=this.xmldoc}var c=a.firstElementChild;var b=this.translateNodeName(d);while(c!=undefined){if(c.nodeName==b){return c}c=c.nextElementSibling}return undefined};feedbro.XmlDocumentWrapper.prototype.getAll=function(e,a){if(a==undefined){a=this.xmldoc}var d=a.firstElementChild,b=[];var c=this.translateNodeName(e);while(d!=undefined){if(d.nodeName==c){b.push(d)}d=d.nextElementSibling}return b};var feedbro=feedbro||{};feedbro.YammerPlugin=function(){this._strings=new feedbro.Strings()};feedbro.YammerPlugin.prototype.canParse=function(a){return a&&a.indexOf("https://www.yammer.com/")==0};feedbro.YammerPlugin.prototype.parse=function(f,d,a,g){var b=this;var e=new XMLHttpRequest();var c=this.getURL(f.url,20);e.onerror=function(){a.error={};a.error.message="Network error";a.error.code=398;a.status=398};e.onreadystatechange=function(i){var h=i.target;if(h.readyState==4){h.onreadystatechange=null;if(h.status!=0){h.onerror=null}var k="";if(h.status==200){try{k=b.toRSS(h.responseText,f.datelimit,f.url)}catch(j){}}d(f.url,h,k,a,g,true)}};e.withCredentials=true;e.open("GET",c,true);e.timeout=f.timeout?(f.timeout+0):30000;e.send()};feedbro.YammerPlugin.prototype.toRSS=function(e,c,b){var d=JSON.parse(e);var a=this.processJson(d);return feedbro.Strings.toRSS((d.meta?d.meta.feed_name:"Group")+" | Yammer",b,a)};feedbro.YammerPlugin.prototype.getURL=function(c,e){var b,a,d;c=(c||"");if(!a&&c.includes("?type=following")){a="messages/following"}if(!a&&c.includes("?type=my_all")){a="messages/my_feed"}if(!a&&c.includes("?type=algo")){a="messages/algo"}b=c.match(/feedId=(\d+)/);if(!a&&b&&c.includes("/inGroup")){d=b[1];a="messages/in_group/"+d}if(!a&&b&&c.includes("/AboutTopic")){d=b[1];a="messages/about_topic/"+d}if(!a&&c.includes("/home")){a="messages/my_feed"}if(a==null){return null}return"https://www.yammer.com/api/v1/"+a+".json?threaded=true&limit="+e};feedbro.YammerPlugin.prototype.processJson=function(m){var f,e,b,a,c=m.messages,l,d,g=[],k={},h;if(m.references){for(f=0;f<m.references.length;f++){b=m.references[f];k[b.id]=b}}if(c==undefined){return g}for(f=0;f<c.length;f++){a=c[f];d=k[a.sender_id];l={link:a.web_url,publishedDate:new Date(a.created_at),author:d?d.full_name:"",title:a.body?a.body.plain:"",content:this.getPostHeader(d)};if(a.body&&a.body.rich!=""){l.content+="<div class='yammer-update'>"+(a.body?a.body.rich:"")+"</div>"}if(a.attachments&&a.attachments.length>0){for(e=0;e<a.attachments.length;e++){h=a.attachments[e];if(h.message_type=="update"){l.content+="<div class='yammer-shared-update'>"+this.getPostHeader(k[h.sender_id])+"<div class='yammer-shared-content'>"+(h.body?h.body.rich:"")+"</div></div>";l.title=h.body?h.body.plain:""}else{if(h.content_class=="Image"){l.content+="<div class='yammer-attachment-image'><a target='_blank' rel='noreferrer noopener' href='"+h.download_url+"'><img src='"+h.image.url+"'></a></div>"}else{if(h.content_class=="Video"){l.content+="<div class='yammer-attachment-video'><a target='_blank' rel='noopener noreferrer' href='"+h.web_url+"'><img class='yammer-attachment-video-thumbnail' src='"+h.thumbnail_url+"'></a></div>"}else{if(h.object_type=="page"){l.content+="<div class='yammer-attachment-page'>"+h.inline_html+"</div>"}}}}}}this._strings.stripTags(l.title);if(l.title.length>128){l.title=l.title.substring(0,128)+"..."}g.push(l)}g.sort(function(j,i){return i.publishedDate.getTime()-j.publishedDate.getTime()});return g};feedbro.YammerPlugin.prototype.getPostHeader=function(c){var a="";var b="";if(c){a="<img class='yammer-mugshot-img' src='"+this.escapeHtml(c.mugshot_url)+"'>";b=c.full_name;if(c.job_title){b=b+"<span class='yammer-jobtitle'>, "+c.job_title+"</span>"}}return"<div class='yammer-mugshot'>"+a+"</div><div class='yammer-author'>"+this.escapeHtml(b)+"</div>"};feedbro.YammerPlugin.prototype.escapeHtml=function(a){return a?String(a).replace(/[&<>"'`]/g,function(b){return"&#"+b.charCodeAt(0)+";"}):a};var feedbro=feedbro||{};feedbro.YoPlugin=function(){this._strings=new feedbro.Strings()};feedbro.YoPlugin.prototype.canParse=function(a){return a&&a.indexOf("https://www.youtube.com/results?")==0};feedbro.YoPlugin.prototype.parse=function(e,c,a,f){var b=this;var d=new XMLHttpRequest();d.onerror=function(){a.error={};a.error.message="Network error";a.error.code=398;a.status=398};d.onreadystatechange=function(h){var g=h.target;if(g.readyState==4){g.onreadystatechange=null;if(g.status!=0){g.onerror=null}var j="";if(g.status==200){try{j=b.toRSS(g.responseText,e.url)}catch(i){}}c(e.url,g,j,a,f,true)}};d.open("GET",e.url,true);d.timeout=20000;d.send()};feedbro.YoPlugin.prototype.toRSS=function(g,d){var m;m={stag:['"PQ"','"'],etag:'"'};this._strings.findNext(g,m);var l="YouTube Search | "+(m.match?m.match:"");var h=[];var q='<?xml version="1.0" encoding="UTF-8"?>\n<feed xmlns:yt="http://www.youtube.com/xml/schemas/2015" xmlns:media="http://search.yahoo.com/mrss/" xmlns="http://www.w3.org/2005/Atom">\n';q+="	<title><![CDATA["+l+"]]></title>\n";q+="	<link>"+d.replace(/&/g,"&#038;")+"</link>\n";q+="	<description><![CDATA["+l+"]]></description>\n";m={stag:['"videoRenderer"','"videoId"','"'],etag:'"'};var c={stag:['"thumbnails"','"url"','"'],etag:'"'};var f={stag:['"title"','"text"','"'],etag:'"}'};var r={stag:['"ownerText"','"text"','"'],etag:'"'};var n=/\\u(\d{4})/g;var k=/\\"/g;while(true){this._strings.findNext(g,m);if(m.match==undefined){break}var e="";var o="";var a={};var j=m.match;a.link="https://youtube.com/watch?v="+j;c.spos=m.spos;this._strings.findNext(g,c);if(c.match){e=c.match.replace("\\u0026","&#038;")}f.spos=c.spos;this._strings.findNext(g,f);if(f.match){a.title=f.match.replace(n,function(t,i){return"&#x"+parseInt(i,10)+";"});a.title=a.title.replace(k,'"')}r.spos=f.spos;this._strings.findNext(g,r);if(r.match){a.author=r.match}var b="";b+="<entry>\n";b+="<title><![CDATA["+a.title+"]]></title>\n";b+="<yt:videoId>"+j+"</yt:videoId>\n";b+='<link type="text/html" rel="alternate" href="'+a.link+'"/>\n';b+="<author><name><![CDATA["+(a.author||"")+"]]></name></author>\n";b+="<media:group>\n";b+='<media:thumbnail url="'+e+'"/>\n';b+="<media:description><![CDATA["+o+"]]></media:description>\n";b+="</media:group>\n";b+="</entry>\n";var s={};s.element=b;h.push(s)}for(var p=0;p<h.length;p++){q+=h[p].element}q+="</feed>";return q};var feedbro=feedbro||{};feedbro.Youtube=function(){};feedbro.Youtube.process=function(){$("div.youtubevideo:not([data-processed])").each(function(a,b){b.setAttribute("data-processed","true");b.onclick=function(){var d=document.createElement("div");d.setAttribute("class","youtubevideocontainer");var c=document.createElement("iframe");c.setAttribute("class","youtubevideoiframe");var e=this.getAttribute("data-link");if(e&&e!=""){c.setAttribute("src",e)}else{c.setAttribute("src","https://www.youtube.com/embed/"+this.id+"?autoplay=1&autohide=1")}c.setAttribute("allowfullscreen","true");c.setAttribute("frameborder","0");d.appendChild(c);this.parentNode.replaceChild(d,this)}})};